/*
 Alessandro Piana 2015
 @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js  isVis - v0.5.5 Aug 2011 - Page Visibility API Polyfill
 Copyright (c) 2011 Addy Osmani
 Dual licensed under the MIT and GPL licenses.
 Sniffer is a clientside browser/engine/os/device detection tool
 v. 3.1.1 | https://github.com/wilddeer/Sniffer
 Copyright Oleg Korsunsky | http://wd.dizaina.net/

 MIT License
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,a,b){c!=Array.prototype&&c!=Object.prototype&&(c[a]=b.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,a,b,d){if(a){b=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var f=c[d];f in b||(b[f]={});b=b[f]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:a})}};$jscomp.arrayIteratorImpl=function(c){var a=0;return function(){return a<c.length?{done:!1,value:c[a++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(c,a){this.$jscomp$symbol$id_=c;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function c(b){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+a++,b)}var a=0;return c}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};
$jscomp.iteratorFromArray=function(c,a){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var b=0,d={next:function(){if(b<c.length){var f=b++;return{value:a(f,c[f]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.entries",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(a,b){return[a,b]})}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(a,b){return b})}},"es8","es3");$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
(function(c,a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))window.location=a})(navigator.userAgent||navigator.vendor||window.opera,"m.index.html");(function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(c,a){var b=this.length>>>0;a=Number(a)||0;a=0>a?Math.ceil(a):Math.floor(a);for(0>a&&(a+=b);a<b;a++)if(a in this&&this[a]===c)return a;return-1})})();
Function.prototype.bind||(Function.prototype.bind=function(c){var a=this,b=Array.prototype.slice.call(arguments,1);if("function"!==typeof a)throw new TypeError("Function.prototype.bind - context must be a valid function");return function(){return a.apply(c,b.concat(Array.prototype.slice.call(arguments)))}});
!window.addEventListener&&function(c,a,b,d,f,g,k){c[d]=a[d]=b[d]=function(a,b){var c=this;k.unshift([c,a,b,function(a){a.currentTarget=c;a.preventDefault=function(){a.returnValue=!1};a.stopPropagation=function(){a.cancelBubble=!0};a.target=a.srcElement||c;b.call(c,a)}]);this.attachEvent("on"+a,k[0][3])};c[f]=a[f]=b[f]=function(a,b){for(var c=0,f;f=k[c];++c)if(f[0]==this&&f[1]==a&&f[2]==b)return this.detachEvent("on"+a,k.splice(c,1)[0][3])};c[g]=a[g]=b[g]=function(a){return this.fireEvent("on"+a.type,
a)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]);
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(c){if("Element"in c){c=c.Element.prototype;var a=Object,b=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},d=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},f=function(a,b){this.name=a;this.code=DOMException[a];this.message=b},g=function(a,
b){if(""===b)throw new f("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(b))throw new f("INVALID_CHARACTER_ERR","The token must not contain space characters.");return d.call(a,b)},k=function(a){var c=b.call(a.getAttribute("class")||"");c=c?c.split(/\s+/):[];for(var f=0,d=c.length;d>f;f++)this.push(c[f]);this._updateClassName=function(){a.setAttribute("class",this.toString())}},h=k.prototype=[],m=function(){return new k(this)};if(f.prototype=Error.prototype,h.item=function(a){return this[a]||
null},h.contains=function(a){return~g(this,a+"")},h.add=function(){var a=arguments,b=0,c=a.length,f=!1;do{var d=a[b]+"";~g(this,d)||(this.push(d),f=!0)}while(++b<c);f&&this._updateClassName()},h.remove=function(){var a,b=arguments,c=0,f=b.length,d=!1;do{var h=b[c]+"";for(a=g(this,h);~a;)this.splice(a,1),d=!0,a=g(this,h)}while(++c<f);d&&this._updateClassName()},h.toggle=function(a,b){var c=this.contains(a),f=c?!0!==b&&"remove":!1!==b&&"add";return f&&this[f](a),!0===b||!1===b?b:!c},h.replace=function(a,
b){a=g(a+"");~a&&(this.splice(a,1,b),this._updateClassName())},h.toString=function(){return this.join(" ")},a.defineProperty){h={get:m,enumerable:!0,configurable:!0};try{a.defineProperty(c,"classList",h)}catch(l){void 0!==l.number&&-2146823252!==l.number||(h.enumerable=!1,a.defineProperty(c,"classList",h))}}else a.prototype.__defineGetter__&&c.__defineGetter__("classList",m)}}(self),function(){var c=document.createElement("_");if(c.classList.add("c1","c2"),!c.classList.contains("c2")){var a=function(a){var b=
DOMTokenList.prototype[a];DOMTokenList.prototype[a]=function(a){var c,f=arguments.length;for(c=0;f>c;c++)a=arguments[c],b.call(this,a)}};a("add");a("remove")}if(c.classList.toggle("c3",!1),c.classList.contains("c3")){var b=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,c){return 1 in arguments&&!this.contains(a)==!c?c:b.call(this,a)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(a,b){var c=this.toString().split(" ");a=c.indexOf(a+
"");~a&&(c=c.slice(a),this.remove.apply(this,c),this.add(b),this.add.apply(this,c.slice(1)))});c=null}());
(function(c){function a(a){for(var b="",c=0;c<(a||5);c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return b}function b(a){return{timestamp:(new Date).getTime(),isTrusted:!0,target:null,currentTarget:null,data:a,bubbles:!1,cancelable:!1,defaultPrevented:!1,lastEventId:"",origin:c.location.origin}}function d(b){if(!c.localStorage)throw new "localStorage not available";b="polyBC_"+b;var d=null===g;this.channelId=b;k=k||a();g=g||{};g[b]=g[b]||
[];g[b].push(this);this.name=b+"::::"+a()+(new Date).getTime();d&&(console.log(c),console.log(c.addEventListener),c.addEventListener("storage",f.bind(this),!1));return this}function f(a){var b=a.key,f=a.newValue,d=!f;a=null;if(-1<b.indexOf("eomBCmessage_")&&!d){try{a=JSON.parse(f)}catch(u){throw new "Message conversion has resulted in an error.";}if(a.tabId!==k&&a.channelId&&g&&g[a.channelId]){f=g[a.channelId];for(var h in f)if(!f[h].closed&&f[h].onmessage)f[h].onmessage(a.message);c.localStorage.removeItem(b)}}}
var g=null,k=null;d.prototype.onmessage=function(a){};d.prototype.postMessage=function(f){if(g){if(this.closed)throw new "This BroadcastChannel is closed.";f=b(f);var d=g[this.channelId]||[];for(h in d)if(!d[h].closed&&d[h].name!==this.name&&d[h].onmessage)d[h].onmessage(f);var h={channelId:this.channelId,bcId:this.name,tabId:k,message:f};try{var n=JSON.stringify(h),p="eomBCmessage_"+a()+"_"+this.channelId;c.localStorage.setItem(p,n)}catch(u){throw new "Message conversion has resulted in an error.";
}setTimeout(function(){c.localStorage.removeItem(p)},1E3)}};d.prototype.close=function(){this.closed=!0;var a=g[this.channelId].indexOf(this);-1<a&&g[this.channelId].splice(a,1);g[this.channelId].length||delete g[this.channelId];a:{a=g;for(b in a)if(a.hasOwnProperty(b)){var b=!1;break a}b=!0}b&&c.removeEventListener("storage",f.bind(this))};c.BroadcastChannel=c.BroadcastChannel||d})(window);
(function(){window.visibly={b:null,q:document,p:void 0,prefixes:["webkit","ms"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],_callbacks:[],onVisible:function(c){this.visibleCallbacks.push(c)},onHidden:function(c){this.hiddenCallbacks.push(c)},isSupported:function(){return this._supports(0)||this._supports(1)},_supports:function(c){return this.prefixes[c]+this.props[2]in this.q},runCallbacks:function(c){if(c)for(this._callbacks=1==
c?this.visibleCallbacks:this.hiddenCallbacks,c=0;c<this._callbacks.length;c++)this._callbacks[c]()},_visible:function(){window.visibly.runCallbacks(1)},_hidden:function(){window.visibly.runCallbacks(2)},_nativeSwitch:function(){!0===this.q[this.b+this.props[2]]?this._hidden():this._visible()},listen:function(){try{this.isSupported()?(this.b=this._supports(0)==this.p?this.prefixes[1]:this.prefixes[0],this.q.addEventListener(this.b+this.props[1],function(){window.visibly._nativeSwitch.apply(window.visibly,
arguments)},1)):document.addEventListener?(window.addEventListener(this.m[0],this._visible,1),window.addEventListener(this.m[1],this._hidden,1)):(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(c){}},init:function(){this.listen()}};this.visibly.init()})();
(function(c){var a=function(a){var b={browser:{fullName:"",name:"",version:"",majorVersion:null,minorVersion:null,patchVersion:null,engine:""},os:{fullName:"",name:"",version:"",versionName:"",versionAltNames:[],majorVersion:null,minorVersion:null,patchVersion:null},features:{bw:!1,mobile:!1,tv:!1,proxy:!1}},c={browser:[{test:["SailfishBrowser"],browser:{fullName:"Sailfish Browser",name:"sailfishbrowser",engine:"gecko",$version:{search:"SailfishBrowser/"}},features:{mobile:!0}},{test:["Edge/"],browser:{fullName:"Edge",
name:"edge",engine:"edgehtml",$version:{search:"Edge/"}}},{test:["MSIE"],browser:{fullName:"Internet Explorer",name:"ie",engine:"trident",$version:{search:"MSIE "}}},{test:["Trident"],browser:{fullName:"Internet Explorer",name:"ie",engine:"trident",$version:{search:"rv:"}}},{test:["OPR/"],browser:{fullName:"Opera",name:"opera",engine:"webkit",$version:{search:"OPR/"}}},{test:["Chrome"],browser:{fullName:"Chrome",name:"chrome",engine:"webkit",$version:{search:"Chrome/"}}},{test:["Firefox"],browser:{fullName:"Firefox",
name:"firefox",engine:"gecko",$version:{search:"Firefox/"}}},{test:["NokiaBrowser"],browser:{fullName:"Nokia Browser",name:"nokiabrowser",engine:"webkit",$version:{search:"NokiaBrowser/"}},features:{mobile:!0}},{test:["Opera Mini","Presto"],browser:{fullName:"Opera Mini",name:"operamini",engine:"presto",$version:{search:"Version/"}},features:{mobile:!0,proxy:!0}},{test:["Opera Mini","WebKit"],browser:{fullName:"Opera Mini",name:"operamini",engine:"webkit"},features:{mobile:!0,proxy:!0}},{test:["Opera"],
browser:{fullName:"Opera",name:"opera",engine:"presto",$version:{search:"Version/"}}},{test:["OviBrowser"],browser:{fullName:"Ovi Browser",name:"ovi",engine:"gecko",$version:{search:"OviBrowser/"}},features:{mobile:!0,proxy:!0}},{test:["CriOS/"],browser:{fullName:"Chrome",name:"chrome",engine:"webkit",$version:{search:"CriOS/"}}},{test:["Coast/"],browser:{fullName:"Opera Coast",name:"coast",engine:"webkit",$version:{search:"Coast/"}}},{test:["Safari","Version/",/(iPhone|iPod|iPad|Macintosh|Windows)/],
browser:{fullName:"Safari",name:"safari",engine:"webkit",$version:{search:"Version/"}}},{test:["WebKit"],browser:{engine:"webkit"}},{test:["Gecko/"],browser:{engine:"gecko"}}],os:[{test:["Sailfish"],os:{fullName:"Sailfish OS",name:"sailfish"},features:{mobile:!0}},{test:["Windows Phone"],os:{fullName:"Windows Phone",name:"winphone",$version:{search:"Windows Phone "}},features:{mobile:!0}},{test:["Windows"],os:{fullName:"Windows",name:"win",$version:{search:"Windows NT ",names:{"10.0":"10","6.3":"8.1",
"6.2":"8","6.1":"7","6.0":"Vista","5.2":"XP","5.1":"XP","5.01":"2000","5.0":"2000"},altNames:{"5.2":["Server 2003"]}}}},{test:["Macintosh","OS X 10"],os:{fullName:"Mac OS X",name:"osx",$version:{search:/OS X /,names:{"10.6":"Snow Leopard","10.7":"Lion","10.8":"Mountain Lion","10.9":"Mavericks","10.10":"Yosemite","10.11":"El Capitan"}}}},{test:["Ubuntu"],os:{fullName:"Ubuntu",name:"ubuntu"}},{test:["Fedora"],os:{fullName:"Fedora",name:"fedora",$version:{search:"Fedora/",names:{20:"Heisenbug",19:"Schr\ufffddinger's Cat",
18:"Spherical Cow",17:"Beefy Miracle",16:"Verne",15:"Lovelock",14:"Laughlin",13:"Goddard",12:"Constantine",11:"Leonidas",10:"Cambridge",9:"Sulphur",8:"Werewolf",7:"Moonshine"}}}},{test:["Kindle"],os:{fullName:"Kindle",name:"kindle",$version:{search:"Kindle/"}},features:{bw:!0,mobile:!0}},{test:[/(BlackBerry|BB\d+)/],os:{fullName:"BlackBerry",name:"blackberry",$version:{search:"Version/"}},features:{mobile:!0}},{test:["Symbian"],os:{fullName:"Symbian",name:"symbian"},features:{mobile:!0}},{test:["Series40"],
os:{fullName:"Symbian",name:"symbian"},features:{mobile:!0}},{test:["PlayStation Vita"],os:{fullName:"PlayStation Vita",name:"psvita"},features:{mobile:!0}},{test:[/playstation/i],os:{fullName:"PlayStation",name:"playstation",$version:{search:/playstation\s/i}},features:{tv:!0}},{test:["Nintendo DSi"],os:{fullName:"Nintendo DSi",name:"dsi"},features:{mobile:!0}},{test:["New Nintendo 3DS"],os:{fullName:"New Nintendo 3DS",name:"n3ds"},browser:{engine:"webkit"},features:{mobile:!0}},{test:["Nintendo 3DS"],
os:{fullName:"Nintendo 3DS",name:"3ds"},browser:{engine:"webkit"},features:{mobile:!0}},{test:["Viera"],os:{fullName:"Viera",name:"viera"},browser:{engine:"webkit"},features:{tv:!0}},{test:["SonyDTV"],features:{tv:!0}},{test:["Android"],os:{fullName:"Android",name:"android",$version:{search:"Android "}},features:{mobile:!0}},{test:[/iPhone|iPod|iPad/],os:{fullName:"iOS",name:"ios",$version:{search:"OS "}},features:{mobile:!0}}],features:[{test:[/mobile/i],features:{mobile:!0}},{test:[/smart-{0,1}tv/i],
features:{tv:!0}}]};if(!a)return b;for(var f in c)for(var d=c[f],g=0;g<d.length;g++){for(var p=!0,u=0;u<d[g].test.length;u++)if(d[g].test[u]instanceof RegExp){if(!d[g].test[u].test(a)){p=!1;break}}else if(-1==a.indexOf(d[g].test[u])){p=!1;break}if(p){p=void 0;d=d[g];for(p in c)if(c.hasOwnProperty(p)&&d[p]){if(d[p].$version){a:{g=d[p].$version.search;if(g instanceof RegExp&&(g=(a.match(g)||[])[0],!g)){var q=void 0;break a}u=a.indexOf(g);if(-1!=u&&(g=a.substring(u+g.length),g=/^(\d+(\.|_)){0,2}\d+/.exec(g))){q=
g[0].replace(/_/g,".");break a}q=void 0}if(q){g=q.split(".");u=d[p].$version.names;var r=d[p].$version.altNames;d[p].version=q;g[0]&&(d[p].majorVersion=parseInt(g[0]));g[1]&&(d[p].minorVersion=parseInt(g[1]));g[2]&&(d[p].patchVersion=parseInt(g[2]));if(u)for(var t=[],w=0;w<g.length;w++)t.push(g[w]),q=t.join("."),u[q]&&(d[p].versionName=u[q]),r&&r[q]&&(d[p].versionAltNames=r[q])}}for(var v in d[p])d[p].hasOwnProperty(v)&&"$"!==v[0]&&(b[p][v]=d[p][v])}break}}return b}(navigator.userAgent),b=document.getElementsByTagName("html")[0],
d=[b.className];a.browser.name&&d.push(a.browser.name);a.browser.engine&&d.push(a.browser.engine);a.os.name&&d.push(a.os.name);for(var f in a.features)a.features[f]&&d.push(f);b.className=d.join(" ");"undefined"!=typeof module&&module.exports?module.exports=a:c.Sniff=a})(this);
var Dialog=function(){var c=function(a){function b(){f&&c()}function c(){k.dispose()}var f=a.disposeOnHide,g=a.message,k=new Popup({closeOnClickOff:!1}),h=k.getElement(),m=E.DIV();g=E.DIV();h.classList.add("dialog");m.classList.add("inner");g.classList.add("message");g.innerHTML=a.message;document.body.appendChild(k.getElement());k.getElement().appendChild(m);m.appendChild(g);(function(a){each(a.buttons,function(a){var c=new Button({text:a.text,className:"dialog-button"});c.addEventListener("click",
a.callback?function(){b();a.callback()}:b);m.appendChild(c.getElement())})})(a);this.show=function(){h.style.display="block"};this.dispose=c};c.show=function(a){a.disposeOnHide=!0;a=new c(a);a.show();return a};return c}(),compatabilityCheck=function(c,a){function b(){c()}function d(){a()}(function(){var a=Sniff.browser,b=a.name;a=a.version;console.log(b);console.log(a);switch(b){case "chrome":if("10"<=a)return!0;break;case "edge":return!0;case "firefox":if("29"<=a)return!0;break;case "opera":if("12.1"<=
a)return!0;break;case "operamini":break;case "safari":if("5.1.4"<=a)return!0;break;case "ie":if("11"<=a)return!0;break;default:return!1}})()?c():Dialog.show({message:"Your browser may not be able to run this chat properly. We recommend you upgrade to a new version of Chrome,  Edge, Firefox, Opera or Safar.",buttons:[{text:"Try",callback:b},{text:"Get Recommended Browser",callback:d}]})};String.prototype.splice=function(c,a,b){return this.slice(0,c)+b+this.slice(c+Math.abs(a))};
function getWebsocketUrl(c){var a=window.location;var b="https:"===a.protocol?"wss:":"ws:";b+="//"+a.host;return b+("/"+c)}function each(c,a){for(var b=0;b<c.length;b++)a(c[b])}var When={NOW:"now",SECONDS:"seconds",MINUTES:"minutes",NEVER:"never"},VideoOfferRejectedReasons={PM_NOT_OPEN:1,DECLINED:2,ERRORs:3};
function StopWatch(){var c=this,a=0,b,d=!1;this.getMilliseconds=function(){var c=a;d&&(c+=Date().getTime()-b);return c};this.getSeconds=function(){return c.getMilliseconds/1E3};this.start=function(){d||(d=!0,b=(new Date).getTime())};this.stop=function(){d&&(d=!1,a+=(new Date).getTime()-b,b=0)};this.reset=function(){d=!1;b=a=0}}
var Leaving=new function(){var c=[];this.add=function(a){0<=c.indexOf(a)||c.push(a)};console.log("Leave");window.onbeforeunload=function(a){each(c,function(a){a()})}},E=new function(){function c(b,c){b=a(b);b.type=c;return b}function a(a){a=document.createElement(a);a.addEventListener||(a.addEventListener=a.attachEvent);return a}this.DIV=function(){return a("div")};this.IMG=function(){return a("img")};this.CANVAS=function(){return a("canvas")};this.TABLE=function(){return a("table")};this.TR=function(){return a("tr")};
this.TD=function(){return a("td")};this.TH=function(){return a("th")};this.H3=function(){return a("h3")};this.H2=function(){return a("h2")};this.H1=function(){return a("h1")};this.VIDEO=function(){return a("video")};this.CHECKBOX=function(){return c("input","checkbox")};this.TEXT=function(){return c("input","text")};this.PASSWORD=function(){return c("input","password")};this.TEXTAREA=function(){return a("textarea")};this.SPAN=function(){return a("span")};this.SELECT=function(){return a("select")};
this.OPTION=function(){return a("option")};this.TABLE=function(){return a("table")};this.COLGROUP=function(){return a("colgroup")};this.COL=function(){return a("col")};this.BUTTON=function(){return a("button")};this.A=function(){return a("a")};this.LABEL=function(){return a("label")};this.FILE=function(){return c("input","file")}},Dimension=function(){function c(a){return Error("The string 2"+a+'" is an invalid dimension')}var a=function(a,d){this.isDimension=!0;(function(b,g){if(!g){g=b.indexOf("%");
if(0<g){g=b.substr(0,g);if(0>=g.length)throw c(b);b=parseInt(g);g="%"}else{g=b.indexOf("px");if(0>=g)throw c(b);g=b.substr(0,g);if(0>=g.length)throw c(b);b=parseInt(g);g="px"}a=b;d=g}})(a,d);this.getValue=function(){return a};this.getUnit=function(){return d}};a.PX="px";a.PERCENT="%";a.px;a.pixels=function(b){return new a(b,"px")};a.percent=function(b){return new a(b,"%")};return a}(),moment;
(function(c,a){"object"===typeof exports&&"undefined"!==typeof module?module.exports=a():"function"===typeof define&&define.amd?define(a):c.moment=a()})(this,function(){function c(){return jc.apply(null,arguments)}function a(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function b(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function d(e){return void 0===e}function f(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}
function g(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function k(e,a){var J=[],b;for(b=0;b<e.length;++b)J.push(a(e[b],b));return J}function h(e,a){return Object.prototype.hasOwnProperty.call(e,a)}function m(e,a){for(var J in a)h(a,J)&&(e[J]=a[J]);h(a,"toString")&&(e.toString=a.toString);h(a,"valueOf")&&(e.valueOf=a.valueOf);return e}function l(e,a,b,c){return wb(e,a,b,c,!0).utc()}function n(e){null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,
charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1});return e._pf}function p(e){if(null==e._isValid){var a=n(e),b=kc.call(a.parsedDateParts,function(e){return null!=e});b=!isNaN(e._d.getTime())&&0>a.overflow&&!a.empty&&!a.invalidMonth&&!a.invalidWeekday&&!a.weekdayMismatch&&!a.nullInput&&!a.invalidFormat&&!a.userInvalidated&&(!a.meridiem||a.meridiem&&b);e._strict&&(b=b&&0===a.charsLeftOver&&0===a.unusedTokens.length&&
void 0===a.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(e))return b;e._isValid=b}return e._isValid}function u(e){var a=l(NaN);null!=e?m(n(a),e):n(a).userInvalidated=!0;return a}function q(e,a){var J;d(a._isAMomentObject)||(e._isAMomentObject=a._isAMomentObject);d(a._i)||(e._i=a._i);d(a._f)||(e._f=a._f);d(a._l)||(e._l=a._l);d(a._strict)||(e._strict=a._strict);d(a._tzm)||(e._tzm=a._tzm);d(a._isUTC)||(e._isUTC=a._isUTC);d(a._offset)||(e._offset=a._offset);d(a._pf)||(e._pf=n(a));d(a._locale)||(e._locale=
a._locale);if(0<ab.length)for(J=0;J<ab.length;J++){var b=ab[J];var c=a[b];d(c)||(e[b]=c)}return e}function r(e){q(this,e);this._d=new Date(null!=e._d?e._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===bb&&(bb=!0,c.updateOffset(this),bb=!1)}function t(e){return e instanceof r||null!=e&&null!=e._isAMomentObject}function w(e){return 0>e?Math.ceil(e)||0:Math.floor(e)}function v(e){e=+e;var a=0;0!==e&&isFinite(e)&&(a=w(e));return a}function x(e,a,b){var J=Math.min(e.length,a.length),c=Math.abs(e.length-
a.length),f=0,d;for(d=0;d<J;d++)(b&&e[d]!==a[d]||!b&&v(e[d])!==v(a[d]))&&f++;return f+c}function D(e){!1===c.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function G(e,a){var J=!0;return m(function(){null!=c.deprecationHandler&&c.deprecationHandler(null,e);if(J){for(var b=[],d,f=0;f<arguments.length;f++){d="";if("object"===typeof arguments[f]){d+="\n["+f+"] ";for(var g in arguments[0])d+=g+": "+arguments[0][g]+", ";d=d.slice(0,-2)}else d=
arguments[f];b.push(d)}D(e+"\nArguments: "+Array.prototype.slice.call(b).join("")+"\n"+Error().stack);J=!1}return a.apply(this,arguments)},a)}function H(e,a){null!=c.deprecationHandler&&c.deprecationHandler(e,a);xb[e]||(D(a),xb[e]=!0)}function I(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function B(e,a){var J=m({},e),c;for(c in a)h(a,c)&&(b(e[c])&&b(a[c])?(J[c]={},m(J[c],e[c]),m(J[c],a[c])):null!=a[c]?J[c]=a[c]:delete J[c]);for(c in e)h(e,c)&&!h(a,c)&&
b(e[c])&&(J[c]=m({},J[c]));return J}function C(e){null!=e&&this.set(e)}function K(e,a){var J=e.toLowerCase();Fa[J]=Fa[J+"s"]=Fa[a]=e}function A(e){return"string"===typeof e?Fa[e]||Fa[e.toLowerCase()]:void 0}function U(e){var a={},b,c;for(c in e)h(e,c)&&(b=A(c))&&(a[b]=e[c]);return a}function ja(e){var a=[],b;for(b in e)a.push({unit:b,priority:V[b]});a.sort(function(e,a){return e.priority-a.priority});return a}function L(e,a,b){var J=""+Math.abs(e);return(0<=e?b?"+":"":"-")+Math.pow(10,Math.max(0,
a-J.length)).toString().substr(1)+J}function F(e,a,b,c){var J=c;"string"===typeof c&&(J=function(){return this[c]()});e&&(Aa[e]=J);a&&(Aa[a[0]]=function(){return L(J.apply(this,arguments),a[1],a[2])});b&&(Aa[b]=function(){return this.localeData().ordinal(J.apply(this,arguments),e)})}function ma(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function ca(e){var a=e.match(yb),b;var c=0;for(b=a.length;c<b;c++)a[c]=Aa[a[c]]?Aa[a[c]]:ma(a[c]);return function(J){var c="",d;for(d=
0;d<b;d++)c+=I(a[d])?a[d].call(J,e):a[d];return c}}function W(e,a){if(!e.isValid())return e.localeData().invalidDate();a=Y(a,e.localeData());cb[a]=cb[a]||ca(a);return cb[a](e)}function Y(e,a){function J(e){return a.longDateFormat(e)||e}var b=5;for(Ma.lastIndex=0;0<=b&&Ma.test(e);)e=e.replace(Ma,J),Ma.lastIndex=0,--b;return e}function z(e,a,b){db[e]=I(a)?a:function(e,J){return e&&b?b:a}}function Na(e,a){return h(db,e)?db[e](a._strict,a._locale):new RegExp(X(e))}function X(e){return da(e.replace("\\",
"").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,a,b,c,d){return a||b||c||d}))}function da(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function N(e,a){var J,b=a;"string"===typeof e&&(e=[e]);f(a)&&(b=function(e,J){J[a]=v(e)});for(J=0;J<e.length;J++)eb[e[J]]=b}function ea(e,a){N(e,function(e,J,b,c){b._w=b._w||{};a(e,b._w,b,c)})}function Z(e){return 0===e%4&&0!==e%100||0===e%400}function na(e,a){return function(J){return null!=J?(aa(this,e,J),c.updateOffset(this,a),this):va(this,
e)}}function va(e,a){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+a]():NaN}function aa(e,a,b){if(e.isValid()&&!isNaN(b))if("FullYear"===a&&Z(e.year())&&1===e.month()&&29===e.date())e._d["set"+(e._isUTC?"UTC":"")+a](b,e.month(),Oa(b,e.month()));else e._d["set"+(e._isUTC?"UTC":"")+a](b)}function Oa(e,a){if(isNaN(e)||isNaN(a))return NaN;var b=(a%12+12)%12;return 1===b?Z(e+(a-b)/12)?29:28:31-b%7%2}function zb(e,a){if(!e.isValid())return e;if("string"===typeof a)if(/^\d+$/.test(a))a=v(a);else if(a=
e.localeData().monthsParse(a),!f(a))return e;var b=Math.min(e.date(),Oa(e.year(),a));e._d["set"+(e._isUTC?"UTC":"")+"Month"](a,b);return e}function Ab(e){return null!=e?(zb(this,e),c.updateOffset(this,!0),this):va(this,"Month")}function Bb(){function e(e,a){return a.length-e.length}var a=[],b=[],c=[],d;for(d=0;12>d;d++){var f=l([2E3,d]);a.push(this.monthsShort(f,""));b.push(this.months(f,""));c.push(this.months(f,""));c.push(this.monthsShort(f,""))}a.sort(e);b.sort(e);c.sort(e);for(d=0;12>d;d++)a[d]=
da(a[d]),b[d]=da(b[d]);for(d=0;24>d;d++)c[d]=da(c[d]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+c.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+b.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+a.join("|")+")","i")}function lc(e,a,b,c,d,f,g){100>e&&0<=e?(a=new Date(e+400,a,b,c,d,f,g),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,a,b,c,d,f,g);return a}function Ga(e){if(100>e&&0<=e){var a=Array.prototype.slice.call(arguments);a[0]=e+400;a=new Date(Date.UTC.apply(null,
a));isFinite(a.getUTCFullYear())&&a.setUTCFullYear(e)}else a=new Date(Date.UTC.apply(null,arguments));return a}function Pa(e,a,b){b=7+a-b;return-((7+Ga(e,0,b).getUTCDay()-a)%7)+b-1}function Cb(e,a,b,c,d){b=(7+b-c)%7;c=Pa(e,c,d);c=1+7*(a-1)+b+c;0>=c?(a=e-1,e=(Z(a)?366:365)+c):c>(Z(e)?366:365)?(a=e+1,e=c-(Z(e)?366:365)):(a=e,e=c);return{year:a,dayOfYear:e}}function Ha(e,a,b){var c=Pa(e.year(),a,b);c=Math.floor((e.dayOfYear()-c-1)/7)+1;1>c?(e=e.year()-1,a=c+wa(e,a,b)):c>wa(e.year(),a,b)?(a=c-wa(e.year(),
a,b),e=e.year()+1):(e=e.year(),a=c);return{week:a,year:e}}function wa(e,a,b){var c=Pa(e,a,b);a=Pa(e+1,a,b);return((Z(e)?366:365)-c+a)/7}function fb(e,a){return e.slice(a,7).concat(e.slice(0,a))}function mc(e,a,b){var c;e=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],c=0;7>c;++c){var d=l([2E3,1]).day(c);this._minWeekdaysParse[c]=this.weekdaysMin(d,"").toLocaleLowerCase();this._shortWeekdaysParse[c]=this.weekdaysShort(d,
"").toLocaleLowerCase();this._weekdaysParse[c]=this.weekdays(d,"").toLocaleLowerCase()}if(b)a="dddd"===a?R.call(this._weekdaysParse,e):"ddd"===a?R.call(this._shortWeekdaysParse,e):R.call(this._minWeekdaysParse,e);else if("dddd"===a){a=R.call(this._weekdaysParse,e);if(-1!==a)return a;a=R.call(this._shortWeekdaysParse,e);if(-1!==a)return a;a=R.call(this._minWeekdaysParse,e)}else if("ddd"===a){a=R.call(this._shortWeekdaysParse,e);if(-1!==a)return a;a=R.call(this._weekdaysParse,e);if(-1!==a)return a;
a=R.call(this._minWeekdaysParse,e)}else{a=R.call(this._minWeekdaysParse,e);if(-1!==a)return a;a=R.call(this._weekdaysParse,e);if(-1!==a)return a;a=R.call(this._shortWeekdaysParse,e)}return-1!==a?a:null}function gb(){function e(e,a){return a.length-e.length}var a=[],b=[],c=[],d=[],f;for(f=0;7>f;f++){var g=l([2E3,1]).day(f);var h=this.weekdaysMin(g,"");var k=this.weekdaysShort(g,"");g=this.weekdays(g,"");a.push(h);b.push(k);c.push(g);d.push(h);d.push(k);d.push(g)}a.sort(e);b.sort(e);c.sort(e);d.sort(e);
for(f=0;7>f;f++)b[f]=da(b[f]),c[f]=da(c[f]),d[f]=da(d[f]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+b.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function hb(){return this.hours()%12||12}function Db(e,a){F(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),a)})}
function Eb(e,a){return a._meridiemParse}function Fb(e){return e?e.toLowerCase().replace("_","-"):e}function Qa(e){var a=null;if(!S[e]&&"undefined"!==typeof module&&module&&module.exports)try{a=Ia._abbr;var b=window.require;b("./locale/"+e);Ba(a)}catch(dd){}return S[e]}function Ba(e,a){e&&((a=d(a)?sa(e):ib(e,a))?Ia=a:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?"));return Ia._abbr}function ib(e,a){if(null!==a){var b=Gb;a.abbr=e;if(null!=
S[e])H("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),b=S[e]._config;else if(null!=a.parentLocale)if(null!=S[a.parentLocale])b=S[a.parentLocale]._config;else if(b=Qa(a.parentLocale),null!=b)b=b._config;else return Ja[a.parentLocale]||(Ja[a.parentLocale]=[]),Ja[a.parentLocale].push({name:e,
config:a}),null;S[e]=new C(B(b,a));Ja[e]&&Ja[e].forEach(function(e){ib(e.name,e.config)});Ba(e);return S[e]}delete S[e];return null}function sa(e){var b;e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr);if(!e)return Ia;if(!a(e)){if(b=Qa(e))return b;e=[e]}a:{b=0;for(var c,d,f,g;b<e.length;){g=Fb(e[b]).split("-");c=g.length;for(d=(d=Fb(e[b+1]))?d.split("-"):null;0<c;){if(f=Qa(g.slice(0,c).join("-"))){e=f;break a}if(d&&d.length>=c&&x(g,d,!0)>=c-1)break;c--}b++}e=Ia}return e}function jb(e){var a;(a=
e._a)&&-2===n(e).overflow&&(a=0>a[oa]||11<a[oa]?oa:1>a[ka]||a[ka]>Oa(a[fa],a[oa])?ka:0>a[T]||24<a[T]||24===a[T]&&(0!==a[ha]||0!==a[pa]||0!==a[xa])?T:0>a[ha]||59<a[ha]?ha:0>a[pa]||59<a[pa]?pa:0>a[xa]||999<a[xa]?xa:-1,n(e)._overflowDayOfYear&&(a<fa||a>ka)&&(a=ka),n(e)._overflowWeeks&&-1===a&&(a=nc),n(e)._overflowWeekday&&-1===a&&(a=oc),n(e).overflow=a);return e}function Ca(e,a,b){return null!=e?e:null!=a?a:b}function kb(e){var a=[];if(!e._d){var b=new Date(c.now());b=e._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),
b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()];if(e._w&&null==e._a[ka]&&null==e._a[oa]){var d=e._w;if(null!=d.GG||null!=d.W||null!=d.E){var f=1;var g=4;var h=Ca(d.GG,e._a[fa],Ha(P(),1,4).year);var k=Ca(d.W,1);var m=Ca(d.E,1);if(1>m||7<m)var l=!0}else if(f=e._locale._week.dow,g=e._locale._week.doy,k=Ha(P(),f,g),h=Ca(d.gg,e._a[fa],k.year),k=Ca(d.w,k.week),null!=d.d){if(m=d.d,0>m||6<m)l=!0}else if(null!=d.e){if(m=d.e+f,0>d.e||6<d.e)l=!0}else m=f;1>k||k>wa(h,f,g)?n(e)._overflowWeeks=!0:null!=
l?n(e)._overflowWeekday=!0:(l=Cb(h,k,m,f,g),e._a[fa]=l.year,e._dayOfYear=l.dayOfYear)}if(null!=e._dayOfYear){l=Ca(e._a[fa],b[fa]);if(e._dayOfYear>(Z(l)?366:365)||0===e._dayOfYear)n(e)._overflowDayOfYear=!0;l=Ga(l,0,e._dayOfYear);e._a[oa]=l.getUTCMonth();e._a[ka]=l.getUTCDate()}for(l=0;3>l&&null==e._a[l];++l)e._a[l]=a[l]=b[l];for(;7>l;l++)e._a[l]=a[l]=null==e._a[l]?2===l?1:0:e._a[l];24===e._a[T]&&0===e._a[ha]&&0===e._a[pa]&&0===e._a[xa]&&(e._nextDay=!0,e._a[T]=0);e._d=(e._useUTC?Ga:lc).apply(null,
a);a=e._useUTC?e._d.getUTCDay():e._d.getDay();null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);e._nextDay&&(e._a[T]=24);e._w&&"undefined"!==typeof e._w.d&&e._w.d!==a&&(n(e).weekdayMismatch=!0)}}function Hb(e){var a;var b=e._i;var c=pc.exec(b)||qc.exec(b);if(c){n(e).iso=!0;b=0;for(a=Ra.length;b<a;b++)if(Ra[b][1].exec(c[1])){var d=Ra[b][0];var f=!1!==Ra[b][2];break}if(null==d)e._isValid=!1;else{if(c[3]){b=0;for(a=lb.length;b<a;b++)if(lb[b][1].exec(c[3])){var g=(c[2]||" ")+lb[b][0];break}if(null==
g){e._isValid=!1;return}}if(f||null==g){if(c[4])if(rc.exec(c[4]))var h="Z";else{e._isValid=!1;return}e._f=d+(g||"")+(h||"");mb(e)}else e._isValid=!1}}else e._isValid=!1}function Ib(a){var e=sc.exec(a._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(e){var b=e[3],c=e[2],d=e[5],f=e[6],g=e[7],h=parseInt(e[4],10);b=[49>=h?2E3+h:999>=h?1900+h:h,Jb.indexOf(b),parseInt(c,10),parseInt(d,10),parseInt(f,10)];g&&b.push(parseInt(g,10));a:{if(g=e[1])if(g=
Kb.indexOf(g),c=(new Date(b[0],b[1],b[2])).getDay(),g!==c){n(a).weekdayMismatch=!0;g=a._isValid=!1;break a}g=!0}g&&(a._a=b,(g=e[8])?e=tc[g]:e[9]?e=0:(e=parseInt(e[10],10),g=e%100,e=(e-g)/100*60+g),a._tzm=e,a._d=Ga.apply(null,a._a),a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),n(a).rfc2822=!0)}else a._isValid=!1}function uc(a){var e=vc.exec(a._i);null!==e?a._d=new Date(+e[1]):(Hb(a),!1===a._isValid&&(delete a._isValid,Ib(a),!1===a._isValid&&(delete a._isValid,c.createFromInputFallback(a))))}function mb(a){if(a._f===
c.ISO_8601)Hb(a);else if(a._f===c.RFC_2822)Ib(a);else{a._a=[];n(a).empty=!0;var e=""+a._i,b,d,f=e.length,g=0;var k=Y(a._f,a._locale).match(yb)||[];for(b=0;b<k.length;b++){var m=k[b];if(d=(e.match(Na(m,a))||[])[0]){var l=e.substr(0,e.indexOf(d));0<l.length&&n(a).unusedInput.push(l);e=e.slice(e.indexOf(d)+d.length);g+=d.length}if(Aa[m]){if(d?n(a).empty=!1:n(a).unusedTokens.push(m),l=a,null!=d&&h(eb,m))eb[m](d,l._a,l,m)}else a._strict&&!d&&n(a).unusedTokens.push(m)}n(a).charsLeftOver=f-g;0<e.length&&
n(a).unusedInput.push(e);12>=a._a[T]&&!0===n(a).bigHour&&0<a._a[T]&&(n(a).bigHour=void 0);n(a).parsedDateParts=a._a.slice(0);n(a).meridiem=a._meridiem;e=a._a;b=T;f=a._locale;k=a._a[T];g=a._meridiem;null!=g&&(null!=f.meridiemHour?k=f.meridiemHour(k,g):null!=f.isPM&&((f=f.isPM(g))&&12>k&&(k+=12),f||12!==k||(k=0)));e[b]=k;kb(a);jb(a)}}function wc(a){if(!a._d){var e=U(a._i);a._a=k([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(a){return a&&parseInt(a,10)});kb(a)}}function Lb(e){var b=
e._i,c=e._f;e._locale=e._locale||sa(e._l);if(null===b||void 0===c&&""===b)return u({nullInput:!0});"string"===typeof b&&(e._i=b=e._locale.preparse(b));if(t(b))return new r(jb(b));if(g(b))e._d=b;else if(a(c))if(0===e._f.length)n(e).invalidFormat=!0,e._d=new Date(NaN);else{for(b=0;b<e._f.length;b++){c=0;var d=q({},e);null!=e._useUTC&&(d._useUTC=e._useUTC);d._f=e._f[b];mb(d);if(p(d)&&(c+=n(d).charsLeftOver,c+=10*n(d).unusedTokens.length,n(d).score=c,null==f||c<f)){var f=c;var h=d}}m(e,h||d)}else c?mb(e):
xc(e);p(e)||(e._d=null);return e}function xc(e){var h=e._i;d(h)?e._d=new Date(c.now()):g(h)?e._d=new Date(h.valueOf()):"string"===typeof h?uc(e):a(h)?(e._a=k(h.slice(0),function(a){return parseInt(a,10)}),kb(e)):b(h)?wc(e):f(h)?e._d=new Date(h):c.createFromInputFallback(e)}function wb(e,c,d,f,g){var h={};if(!0===d||!1===d)f=d,d=void 0;var k;if(k=b(e))a:if(k=e,Object.getOwnPropertyNames)k=0===Object.getOwnPropertyNames(k).length;else{for(var J in k)if(k.hasOwnProperty(J)){k=!1;break a}k=!0}if(k||a(e)&&
0===e.length)e=void 0;h._isAMomentObject=!0;h._useUTC=h._isUTC=g;h._l=d;h._i=e;h._f=c;h._strict=f;e=new r(jb(Lb(h)));e._nextDay&&(e.add(1,"d"),e._nextDay=void 0);return e}function P(a,b,c,d){return wb(a,b,c,d,!1)}function Mb(e,b){var c;1===b.length&&a(b[0])&&(b=b[0]);if(!b.length)return P();var d=b[0];for(c=1;c<b.length;++c)if(!b[c].isValid()||b[c][e](d))d=b[c];return d}function Sa(a){var e=U(a);a=e.year||0;var b=e.quarter||0,c=e.month||0,d=e.week||e.isoWeek||0,f=e.day||0,g=e.hour||0,h=e.minute||
0,k=e.second||0,m=e.millisecond||0;a:{for(var l in e)if(-1===R.call(Ka,l)||null!=e[l]&&isNaN(e[l])){e=!1;break a}l=!1;for(var n=0;n<Ka.length;++n)if(e[Ka[n]]){if(l){e=!1;break a}parseFloat(e[Ka[n]])!==v(e[Ka[n]])&&(l=!0)}e=!0}this._isValid=e;this._milliseconds=+m+1E3*k+6E4*h+36E5*g;this._days=+f+7*d;this._months=+c+3*b+12*a;this._data={};this._locale=sa();this._bubble()}function nb(a){return a instanceof Sa}function ob(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function Nb(a,b){F(a,0,0,function(){var a=
this.utcOffset(),e="+";0>a&&(a=-a,e="-");return e+L(~~(a/60),2)+b+L(~~a%60,2)})}function pb(a,b){a=(b||"").match(a);if(null===a)return null;a=((a[a.length-1]||[])+"").match(yc)||["-",0,0];b=+(60*a[1])+v(a[2]);return 0===b?0:"+"===a[0]?b:-b}function qb(a,b){return b._isUTC?(b=b.clone(),a=(t(a)||g(a)?a.valueOf():P(a).valueOf())-b.valueOf(),b._d.setTime(b._d.valueOf()+a),c.updateOffset(b,!1),b):P(a).local()}function Ob(){return this.isValid()?this._isUTC&&0===this._offset:!1}function ia(a,b){var e=a;
nb(a)?e={ms:a._milliseconds,d:a._days,M:a._months}:f(a)?(e={},b?e[b]=a:e.milliseconds=a):(b=zc.exec(a))?(e="-"===b[1]?-1:1,e={y:0,d:v(b[ka])*e,h:v(b[T])*e,m:v(b[ha])*e,s:v(b[pa])*e,ms:v(ob(1E3*b[xa]))*e}):(b=Ac.exec(a))?(e="-"===b[1]?-1:1,e={y:ya(b[2],e),M:ya(b[3],e),w:ya(b[4],e),d:ya(b[5],e),h:ya(b[6],e),m:ya(b[7],e),s:ya(b[8],e)}):null==e?e={}:"object"===typeof e&&("from"in e||"to"in e)&&(b=P(e.from),e=P(e.to),b.isValid()&&e.isValid()?(e=qb(e,b),b.isBefore(e)?e=Pb(b,e):(e=Pb(e,b),e.milliseconds=
-e.milliseconds,e.months=-e.months),b=e):b={milliseconds:0,months:0},e={},e.ms=b.milliseconds,e.M=b.months);e=new Sa(e);nb(a)&&h(a,"_locale")&&(e._locale=a._locale);return e}function ya(a,b){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*b}function Pb(a,b){var e={};e.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(e.months,"M").isAfter(b)&&--e.months;e.milliseconds=+b-+a.clone().add(e.months,"M");return e}function Qb(a,b){return function(e,c){if(null!==c&&!isNaN(+c)){H(b,
"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");var d=e;e=c;c=d}e=ia("string"===typeof e?+e:e,c);Rb(this,e,a);return this}}function Rb(a,b,d,f){var e=b._milliseconds,g=ob(b._days);b=ob(b._months);a.isValid()&&(f=null==f?!0:f,b&&zb(a,va(a,"Month")+b*d),g&&aa(a,"Date",va(a,"Date")+g*d),e&&a._d.setTime(a._d.valueOf()+e*d),f&&c.updateOffset(a,g||b))}function rb(a,b){var e=12*(b.year()-
a.year())+(b.month()-a.month()),c=a.clone().add(e,"months");0>b-c?(a=a.clone().add(e-1,"months"),b=(b-c)/(c-a)):(a=a.clone().add(e+1,"months"),b=(b-c)/(a-c));return-(e+b)||0}function Sb(a){if(void 0===a)return this._locale._abbr;a=sa(a);null!=a&&(this._locale=a);return this}function Tb(){return this._locale}function Da(a,b){return(a%b+b)%b}function Ub(a,b,c){return 100>a&&0<=a?new Date(a+400,b,c)-Vb:(new Date(a,b,c)).valueOf()}function Wb(a,b,c){return 100>a&&0<=a?Date.UTC(a+400,b,c)-Vb:Date.UTC(a,
b,c)}function Ta(a,b){F(0,[a,a.length],0,b)}function Xb(a,b,c,d,f){if(null==a)return Ha(this,d,f).year;var e=wa(a,d,f);b>e&&(b=e);a=Cb(a,b,c,d,f);a=Ga(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function Bc(a,b){b[xa]=v(1E3*("0."+a))}function Yb(a){return a}function Ua(a,b,c,d){var e=sa();b=l().set(d,b);return e[c](b,a)}function Zb(a,b,c){f(a)&&(b=a,a=void 0);a=a||"";if(null!=b)return Ua(a,b,c,"month");var e=[];for(b=0;12>b;b++)e[b]=
Ua(a,b,c,"month");return e}function sb(a,b,c,d){"boolean"!==typeof a&&(c=b=a,a=!1);f(b)&&(c=b,b=void 0);b=b||"";var e=sa();a=a?e._week.dow:0;if(null!=c)return Ua(b,(c+a)%7,d,"day");e=[];for(c=0;7>c;c++)e[c]=Ua(b,(c+a)%7,d,"day");return e}function $b(a,b,c,d){b=ia(b,c);a._milliseconds+=d*b._milliseconds;a._days+=d*b._days;a._months+=d*b._months;return a._bubble()}function ac(a){return 0>a?Math.floor(a):Math.ceil(a)}function qa(a){return function(){return this.as(a)}}function za(a){return function(){return this.isValid()?
this._data[a]:NaN}}function Cc(a,b,c,d,f){return f.relativeTime(b||1,!!c,a,d)}function Ea(a){return(0<a)-(0>a)||+a}function Va(){if(!this.isValid())return this.localeData().invalidDate();var a=tb(this._milliseconds)/1E3,b=tb(this._days),c=tb(this._months);var d=w(a/60);var f=w(d/60);a%=60;d%=60;var g=w(c/12);c%=12;a=a?a.toFixed(3).replace(/\.?0+$/,""):"";var h=this.asSeconds();if(!h)return"P0D";var k=0>h?"-":"",m=Ea(this._months)!==Ea(h)?"-":"",l=Ea(this._days)!==Ea(h)?"-":"";h=Ea(this._milliseconds)!==
Ea(h)?"-":"";return k+"P"+(g?m+g+"Y":"")+(c?m+c+"M":"")+(b?l+b+"D":"")+(f||d||a?"T":"")+(f?h+f+"H":"")+(d?h+d+"M":"")+(a?h+a+"S":"")}var kc=Array.prototype.some?Array.prototype.some:function(a){for(var e=Object(this),b=e.length>>>0,c=0;c<b;c++)if(c in e&&a.call(this,e[c],c,e))return!0;return!1};var ab=c.momentProperties=[],bb=!1,xb={};c.suppressDeprecationWarnings=!1;c.deprecationHandler=null;var Dc=Object.keys?Object.keys:function(a){var e,b=[];for(e in a)h(a,e)&&b.push(e);return b};var Fa={},V=
{},yb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ma=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,cb={},Aa={},bc=/\d/,ba=/\d\d/,cc=/\d{3}/,ub=/\d{4}/,Wa=/[+-]?\d{6}/,Q=/\d\d?/,dc=/\d\d\d\d?/,ec=/\d\d\d\d\d\d?/,Xa=/\d{1,3}/,vb=/\d{1,4}/,Ya=/[+-]?\d{1,6}/,Ec=/\d+/,Za=/[+-]?\d+/,Fc=/Z|[+-]\d\d:?\d\d/gi,$a=/Z|[+-]\d\d(?::?\d\d)?/gi,La=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,
db={},eb={},fa=0,oa=1,ka=2,T=3,ha=4,pa=5,xa=6,nc=7,oc=8;F("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});F(0,["YY",2],0,function(){return this.year()%100});F(0,["YYYY",4],0,"year");F(0,["YYYYY",5],0,"year");F(0,["YYYYYY",6,!0],0,"year");K("year","y");V.year=1;z("Y",Za);z("YY",Q,ba);z("YYYY",vb,ub);z("YYYYY",Ya,Wa);z("YYYYYY",Ya,Wa);N(["YYYYY","YYYYYY"],fa);N("YYYY",function(a,b){b[fa]=2===a.length?c.parseTwoDigitYear(a):v(a)});N("YY",function(a,b){b[fa]=c.parseTwoDigitYear(a)});
N("Y",function(a,b){b[fa]=parseInt(a,10)});c.parseTwoDigitYear=function(a){return v(a)+(68<v(a)?1900:2E3)};var fc=na("FullYear",!0);var R=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var e;for(e=0;e<this.length;++e)if(this[e]===a)return e;return-1};F("M",["MM",2],"Mo",function(){return this.month()+1});F("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});F("MMMM",0,0,function(a){return this.localeData().months(this,a)});K("month","M");V.month=8;z("M",Q);z("MM",Q,ba);
z("MMM",function(a,b){return b.monthsShortRegex(a)});z("MMMM",function(a,b){return b.monthsRegex(a)});N(["M","MM"],function(a,b){b[oa]=v(a)-1});N(["MMM","MMMM"],function(a,b,c,d){d=c._locale.monthsParse(a,d,c._strict);null!=d?b[oa]=d:n(c).invalidMonth=a});var gc=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Jb="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");F("w",["ww",2],"wo","week");F("W",["WW",2],"Wo","isoWeek");K("week","w");K("isoWeek","W");V.week=5;V.isoWeek=5;z("w",Q);z("ww",Q,ba);z("W",Q);
z("WW",Q,ba);ea(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=v(a)});F("d",0,"do","day");F("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});F("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});F("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});F("e",0,0,"weekday");F("E",0,0,"isoWeekday");K("day","d");K("weekday","e");K("isoWeekday","E");V.day=11;V.weekday=11;V.isoWeekday=11;z("d",Q);z("e",Q);z("E",Q);z("dd",function(a,b){return b.weekdaysMinRegex(a)});
z("ddd",function(a,b){return b.weekdaysShortRegex(a)});z("dddd",function(a,b){return b.weekdaysRegex(a)});ea(["dd","ddd","dddd"],function(a,b,c,d){d=c._locale.weekdaysParse(a,d,c._strict);null!=d?b.d=d:n(c).invalidWeekday=a});ea(["d","e","E"],function(a,b,c,d){b[d]=v(a)});var Kb="Sun Mon Tue Wed Thu Fri Sat".split(" ");F("H",["HH",2],0,"hour");F("h",["hh",2],0,hb);F("k",["kk",2],0,function(){return this.hours()||24});F("hmm",0,0,function(){return""+hb.apply(this)+L(this.minutes(),2)});F("hmmss",0,
0,function(){return""+hb.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)});F("Hmm",0,0,function(){return""+this.hours()+L(this.minutes(),2)});F("Hmmss",0,0,function(){return""+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)});Db("a",!0);Db("A",!1);K("hour","h");V.hour=13;z("a",Eb);z("A",Eb);z("H",Q);z("h",Q);z("k",Q);z("HH",Q,ba);z("hh",Q,ba);z("kk",Q,ba);z("hmm",dc);z("hmmss",ec);z("Hmm",dc);z("Hmmss",ec);N(["H","HH"],T);N(["k","kk"],function(a,b,c){a=v(a);b[T]=24===a?0:a});N(["a","A"],
function(a,b,c){c._isPm=c._locale.isPM(a);c._meridiem=a});N(["h","hh"],function(a,b,c){b[T]=v(a);n(c).bigHour=!0});N("hmm",function(a,b,c){var e=a.length-2;b[T]=v(a.substr(0,e));b[ha]=v(a.substr(e));n(c).bigHour=!0});N("hmmss",function(a,b,c){var e=a.length-4,d=a.length-2;b[T]=v(a.substr(0,e));b[ha]=v(a.substr(e,2));b[pa]=v(a.substr(d));n(c).bigHour=!0});N("Hmm",function(a,b,c){c=a.length-2;b[T]=v(a.substr(0,c));b[ha]=v(a.substr(c))});N("Hmmss",function(a,b,c){c=a.length-4;var e=a.length-2;b[T]=v(a.substr(0,
c));b[ha]=v(a.substr(c,2));b[pa]=v(a.substr(e))});var Gc=na("Hours",!0),Gb={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",
ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:Jb,week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:Kb,meridiemParse:/[ap]\.?m?\.?/i},S={},Ja={},Ia,pc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
qc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,rc=/Z|[+-]\d\d(?::?\d\d)?/,Ra=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],lb=
[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],vc=/^\/?Date\((\-?\d+)/i,sc=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,tc={UT:0,GMT:0,EDT:-240,
EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};c.createFromInputFallback=G("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});c.ISO_8601=function(){};
c.RFC_2822=function(){};var Hc=G("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=P.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:u()}),Ic=G("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=P.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:u()}),Ka="year quarter month week day hour minute second millisecond".split(" ");
Nb("Z",":");Nb("ZZ","");z("Z",$a);z("ZZ",$a);N(["Z","ZZ"],function(a,b,c){c._useUTC=!0;c._tzm=pb($a,a)});var yc=/([\+\-]|\d\d)/gi;c.updateOffset=function(){};var zc=/^(\-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Ac=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;ia.fn=Sa.prototype;ia.invalid=function(){return ia(NaN)};var Jc=Qb(1,"add"),Kc=Qb(-1,"subtract");c.defaultFormat=
"YYYY-MM-DDTHH:mm:ssZ";c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var hc=G("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)}),Vb=126227808E5;F(0,["gg",2],0,function(){return this.weekYear()%100});F(0,["GG",2],0,function(){return this.isoWeekYear()%100});Ta("gggg","weekYear");Ta("ggggg","weekYear");Ta("GGGG","isoWeekYear");Ta("GGGGG","isoWeekYear");
K("weekYear","gg");K("isoWeekYear","GG");V.weekYear=1;V.isoWeekYear=1;z("G",Za);z("g",Za);z("GG",Q,ba);z("gg",Q,ba);z("GGGG",vb,ub);z("gggg",vb,ub);z("GGGGG",Ya,Wa);z("ggggg",Ya,Wa);ea(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=v(a)});ea(["gg","GG"],function(a,b,d,f){b[f]=c.parseTwoDigitYear(a)});F("Q",0,"Qo","quarter");K("quarter","Q");V.quarter=7;z("Q",bc);N("Q",function(a,b){b[oa]=3*(v(a)-1)});F("D",["DD",2],"Do","date");K("date","D");V.date=9;z("D",Q);z("DD",Q,ba);z("Do",
function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient});N(["D","DD"],ka);N("Do",function(a,b){b[ka]=v(a.match(Q)[0])});var ic=na("Date",!0);F("DDD",["DDDD",3],"DDDo","dayOfYear");K("dayOfYear","DDD");V.dayOfYear=4;z("DDD",Xa);z("DDDD",cc);N(["DDD","DDDD"],function(a,b,c){c._dayOfYear=v(a)});F("m",["mm",2],0,"minute");K("minute","m");V.minute=14;z("m",Q);z("mm",Q,ba);N(["m","mm"],ha);var Lc=na("Minutes",!1);F("s",["ss",2],0,"second");K("second","s");V.second=
15;z("s",Q);z("ss",Q,ba);N(["s","ss"],pa);var Mc=na("Seconds",!1);F("S",0,0,function(){return~~(this.millisecond()/100)});F(0,["SS",2],0,function(){return~~(this.millisecond()/10)});F(0,["SSS",3],0,"millisecond");F(0,["SSSS",4],0,function(){return 10*this.millisecond()});F(0,["SSSSS",5],0,function(){return 100*this.millisecond()});F(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});F(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});F(0,["SSSSSSSS",8],0,function(){return 1E5*
this.millisecond()});F(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});K("millisecond","ms");V.millisecond=16;z("S",Xa,bc);z("SS",Xa,ba);z("SSS",Xa,cc);var ta;for(ta="SSSS";9>=ta.length;ta+="S")z(ta,Ec);for(ta="S";9>=ta.length;ta+="S")N(ta,Bc);var Nc=na("Milliseconds",!1);F("z",0,0,"zoneAbbr");F("zz",0,0,"zoneName");var y=r.prototype;y.add=Jc;y.calendar=function(a,b){a=a||P();var e=qb(a,this).startOf("day");e=c.calendarFormat(this,e)||"sameElse";b=b&&(I(b[e])?b[e].call(this,a):b[e]);
return this.format(b||this.localeData().calendar(e,this,P(a)))};y.clone=function(){return new r(this)};y.diff=function(a,b,c){if(!this.isValid())return NaN;a=qb(a,this);if(!a.isValid())return NaN;var e=6E4*(a.utcOffset()-this.utcOffset());b=A(b);switch(b){case "year":b=rb(this,a)/12;break;case "month":b=rb(this,a);break;case "quarter":b=rb(this,a)/3;break;case "second":b=(this-a)/1E3;break;case "minute":b=(this-a)/6E4;break;case "hour":b=(this-a)/36E5;break;case "day":b=(this-a-e)/864E5;break;case "week":b=
(this-a-e)/6048E5;break;default:b=this-a}return c?b:w(b)};y.endOf=function(a){a=A(a);if(void 0===a||"millisecond"===a||!this.isValid())return this;var b=this._isUTC?Wb:Ub;switch(a){case "year":var e=b(this.year()+1,0,1)-1;break;case "quarter":e=b(this.year(),this.month()-this.month()%3+3,1)-1;break;case "month":e=b(this.year(),this.month()+1,1)-1;break;case "week":e=b(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case "isoWeek":e=b(this.year(),this.month(),this.date()-(this.isoWeekday()-
1)+7)-1;break;case "day":case "date":e=b(this.year(),this.month(),this.date()+1)-1;break;case "hour":e=this._d.valueOf();e+=36E5-Da(e+(this._isUTC?0:6E4*this.utcOffset()),36E5)-1;break;case "minute":e=this._d.valueOf();e+=6E4-Da(e,6E4)-1;break;case "second":e=this._d.valueOf(),e+=1E3-Da(e,1E3)-1}this._d.setTime(e);c.updateOffset(this,!0);return this};y.format=function(a){a||(a=this.isUtc()?c.defaultFormatUtc:c.defaultFormat);a=W(this,a);return this.localeData().postformat(a)};y.from=function(a,b){return this.isValid()&&
(t(a)&&a.isValid()||P(a).isValid())?ia({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};y.fromNow=function(a){return this.from(P(),a)};y.to=function(a,b){return this.isValid()&&(t(a)&&a.isValid()||P(a).isValid())?ia({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};y.toNow=function(a){return this.to(P(),a)};y.get=function(a){a=A(a);return I(this[a])?this[a]():this};y.invalidAt=function(){return n(this).overflow};y.isAfter=function(a,
b){a=t(a)?a:P(a);if(!this.isValid()||!a.isValid())return!1;b=A(b)||"millisecond";return"millisecond"===b?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(b).valueOf()};y.isBefore=function(a,b){a=t(a)?a:P(a);if(!this.isValid()||!a.isValid())return!1;b=A(b)||"millisecond";return"millisecond"===b?this.valueOf()<a.valueOf():this.clone().endOf(b).valueOf()<a.valueOf()};y.isBetween=function(a,b,c,d){a=t(a)?a:P(a);b=t(b)?b:P(b);if(!(this.isValid()&&a.isValid()&&b.isValid()))return!1;d=d||"()";
return("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))};y.isSame=function(a,b){a=t(a)?a:P(a);if(!this.isValid()||!a.isValid())return!1;b=A(b)||"millisecond";if("millisecond"===b)return this.valueOf()===a.valueOf();a=a.valueOf();return this.clone().startOf(b).valueOf()<=a&&a<=this.clone().endOf(b).valueOf()};y.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};y.isSameOrBefore=function(a,b){return this.isSame(a,b)||this.isBefore(a,
b)};y.isValid=function(){return p(this)};y.lang=hc;y.locale=Sb;y.localeData=Tb;y.max=Ic;y.min=Hc;y.parsingFlags=function(){return m({},n(this))};y.set=function(a,b){if("object"===typeof a){a=U(a);b=ja(a);for(var e=0;e<b.length;e++)this[b[e].unit](a[b[e].unit])}else if(a=A(a),I(this[a]))return this[a](b);return this};y.startOf=function(a){a=A(a);if(void 0===a||"millisecond"===a||!this.isValid())return this;var b=this._isUTC?Wb:Ub;switch(a){case "year":var e=b(this.year(),0,1);break;case "quarter":e=
b(this.year(),this.month()-this.month()%3,1);break;case "month":e=b(this.year(),this.month(),1);break;case "week":e=b(this.year(),this.month(),this.date()-this.weekday());break;case "isoWeek":e=b(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case "day":case "date":e=b(this.year(),this.month(),this.date());break;case "hour":e=this._d.valueOf();e-=Da(e+(this._isUTC?0:6E4*this.utcOffset()),36E5);break;case "minute":e=this._d.valueOf();e-=Da(e,6E4);break;case "second":e=this._d.valueOf(),
e-=Da(e,1E3)}this._d.setTime(e);c.updateOffset(this,!0);return this};y.subtract=Kc;y.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};y.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};y.toDate=function(){return new Date(this.valueOf())};y.toISOString=function(a){if(!this.isValid())return null;
var b=(a=!0!==a)?this.clone().utc():this;return 0>b.year()||9999<b.year()?W(b,a?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):I(Date.prototype.toISOString)?a?this.toDate().toISOString():(new Date(this.valueOf()+6E4*this.utcOffset())).toISOString().replace("Z",W(b,"Z")):W(b,a?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")};y.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":
"moment.parseZone",b="Z");a="["+a+'("]';var c=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+c+"-MM-DD[T]HH:mm:ss.SSS"+(b+'[")]'))};y.toJSON=function(){return this.isValid()?this.toISOString():null};y.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};y.unix=function(){return Math.floor(this.valueOf()/1E3)};y.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};y.creationData=function(){return{input:this._i,format:this._f,
locale:this._locale,isUTC:this._isUTC,strict:this._strict}};y.year=fc;y.isLeapYear=function(){return Z(this.year())};y.weekYear=function(a){return Xb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};y.isoWeekYear=function(a){return Xb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};y.quarter=y.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};y.month=Ab;y.daysInMonth=function(){return Oa(this.year(),
this.month())};y.week=y.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};y.isoWeek=y.isoWeeks=function(a){var b=Ha(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};y.weeksInYear=function(){var a=this.localeData()._week;return wa(this.year(),a.dow,a.doy)};y.isoWeeksInYear=function(){return wa(this.year(),1,4)};y.date=ic;y.day=y.days=function(a){if(!this.isValid())return null!=a?this:NaN;var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=
a){var e=this.localeData();"string"===typeof a&&(isNaN(a)?(a=e.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-b,"d")}return b};y.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};y.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=this.localeData();a="string"===typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%
7?a:a-7)}return this.day()||7};y.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?b:this.add(a-b,"d")};y.hour=y.hours=Gc;y.minute=y.minutes=Lc;y.second=y.seconds=Mc;y.millisecond=y.milliseconds=Nc;y.utcOffset=function(a,b,d){var e=this._offset||0,f;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=pb($a,a),null===a)return this}else 16>Math.abs(a)&&!d&&(a*=60);!this._isUTC&&b&&(f=15*-Math.round(this._d.getTimezoneOffset()/
15));this._offset=a;this._isUTC=!0;null!=f&&this.add(f,"m");e!==a&&(!b||this._changeInProgress?Rb(this,ia(a-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,c.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?e:15*-Math.round(this._d.getTimezoneOffset()/15)};y.utc=function(a){return this.utcOffset(0,a)};y.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};
y.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var a=pb(Fc,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};y.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?P(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};y.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};y.isLocal=function(){return this.isValid()?!this._isUTC:!1};
y.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};y.isUtc=Ob;y.isUTC=Ob;y.zoneAbbr=function(){return this._isUTC?"UTC":""};y.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};y.dates=G("dates accessor is deprecated. Use date instead.",ic);y.months=G("months accessor is deprecated. Use month instead",Ab);y.years=G("years accessor is deprecated. Use year instead",fc);y.zone=G("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",
function(a,b){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});y.isDSTShifted=G("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!d(this._isDSTShifted))return this._isDSTShifted;var a={};q(a,this);a=Lb(a);if(a._a){var b=a._isUTC?l(a._a):P(a._a);this._isDSTShifted=this.isValid()&&0<x(a._a,b.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var O=C.prototype;O.calendar=function(a,
b,c){a=this._calendar[a]||this._calendar.sameElse;return I(a)?a.call(b,c):a};O.longDateFormat=function(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];if(b||!c)return b;this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};O.invalidDate=function(){return this._invalidDate};O.ordinal=function(a){return this._ordinal.replace("%d",a)};O.preparse=Yb;O.postformat=Yb;O.relativeTime=function(a,b,c,d){var e=this._relativeTime[c];
return I(e)?e(a,b,c,d):e.replace(/%d/i,a)};O.pastFuture=function(a,b){a=this._relativeTime[0<a?"future":"past"];return I(a)?a(b):a.replace(/%s/i,b)};O.set=function(a){var b;for(b in a){var c=a[b];I(c)?this[b]=c:this["_"+b]=c}this._config=a;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};O.months=function(b,c){return b?a(this._months)?this._months[b.month()]:this._months[(this._months.isFormat||gc).test(c)?"format":
"standalone"][b.month()]:a(this._months)?this._months:this._months.standalone};O.monthsShort=function(b,c){return b?a(this._monthsShort)?this._monthsShort[b.month()]:this._monthsShort[gc.test(c)?"format":"standalone"][b.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};O.monthsParse=function(a,b,c){var e;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],e=0;12>e;++e){var d=
l([2E3,e]);this._shortMonthsParse[e]=this.monthsShort(d,"").toLocaleLowerCase();this._longMonthsParse[e]=this.months(d,"").toLocaleLowerCase()}if(c)b="MMM"===b?R.call(this._shortMonthsParse,a):R.call(this._longMonthsParse,a);else if("MMM"===b){b=R.call(this._shortMonthsParse,a);if(-1!==b)break a;b=R.call(this._longMonthsParse,a)}else{b=R.call(this._longMonthsParse,a);if(-1!==b)break a;b=R.call(this._shortMonthsParse,a)}b=-1!==b?b:null}return b}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=
[],this._shortMonthsParse=[]);for(e=0;12>e;e++)if(d=l([2E3,e]),c&&!this._longMonthsParse[e]&&(this._longMonthsParse[e]=new RegExp("^"+this.months(d,"").replace(".","")+"$","i"),this._shortMonthsParse[e]=new RegExp("^"+this.monthsShort(d,"").replace(".","")+"$","i")),c||this._monthsParse[e]||(d="^"+this.months(d,"")+"|^"+this.monthsShort(d,""),this._monthsParse[e]=new RegExp(d.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[e].test(a)||c&&"MMM"===b&&this._shortMonthsParse[e].test(a)||!c&&
this._monthsParse[e].test(a))return e};O.monthsRegex=function(a){if(this._monthsParseExact)return h(this,"_monthsRegex")||Bb.call(this),a?this._monthsStrictRegex:this._monthsRegex;h(this,"_monthsRegex")||(this._monthsRegex=La);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};O.monthsShortRegex=function(a){if(this._monthsParseExact)return h(this,"_monthsRegex")||Bb.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;h(this,"_monthsShortRegex")||(this._monthsShortRegex=
La);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};O.week=function(a){return Ha(a,this._week.dow,this._week.doy).week};O.firstDayOfYear=function(){return this._week.doy};O.firstDayOfWeek=function(){return this._week.dow};O.weekdays=function(b,c){c=a(this._weekdays)?this._weekdays:this._weekdays[b&&!0!==b&&this._weekdays.isFormat.test(c)?"format":"standalone"];return!0===b?fb(c,this._week.dow):b?c[b.day()]:c};O.weekdaysMin=function(a){return!0===a?fb(this._weekdaysMin,
this._week.dow):a?this._weekdaysMin[a.day()]:this._weekdaysMin};O.weekdaysShort=function(a){return!0===a?fb(this._weekdaysShort,this._week.dow):a?this._weekdaysShort[a.day()]:this._weekdaysShort};O.weekdaysParse=function(a,b,c){var e;if(this._weekdaysParseExact)return mc.call(this,a,b,c);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(e=0;7>e;e++){var d=l([2E3,1]).day(e);c&&!this._fullWeekdaysParse[e]&&(this._fullWeekdaysParse[e]=
new RegExp("^"+this.weekdays(d,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[e]=new RegExp("^"+this.weekdaysShort(d,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[e]=new RegExp("^"+this.weekdaysMin(d,"").replace(".","\\.?")+"$","i"));this._weekdaysParse[e]||(d="^"+this.weekdays(d,"")+"|^"+this.weekdaysShort(d,"")+"|^"+this.weekdaysMin(d,""),this._weekdaysParse[e]=new RegExp(d.replace(".",""),"i"));if(c&&"dddd"===b&&this._fullWeekdaysParse[e].test(a)||c&&"ddd"===b&&this._shortWeekdaysParse[e].test(a)||
c&&"dd"===b&&this._minWeekdaysParse[e].test(a)||!c&&this._weekdaysParse[e].test(a))return e}};O.weekdaysRegex=function(a){if(this._weekdaysParseExact)return h(this,"_weekdaysRegex")||gb.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex;h(this,"_weekdaysRegex")||(this._weekdaysRegex=La);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};O.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return h(this,"_weekdaysRegex")||gb.call(this),a?this._weekdaysShortStrictRegex:
this._weekdaysShortRegex;h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=La);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};O.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return h(this,"_weekdaysRegex")||gb.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=La);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};O.isPM=function(a){return"p"===
(a+"").toLowerCase().charAt(0)};O.meridiem=function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"};Ba("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10;b=1===v(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});c.lang=G("moment.lang is deprecated. Use moment.locale instead.",Ba);c.langData=G("moment.langData is deprecated. Use moment.localeData instead.",sa);var ra=Math.abs,Oc=qa("ms"),Pc=qa("s"),Qc=qa("m"),Rc=qa("h"),Sc=qa("d"),Tc=qa("w"),Uc=qa("M"),
Vc=qa("Q"),Wc=qa("y"),Xc=za("milliseconds"),Yc=za("seconds"),Zc=za("minutes"),$c=za("hours"),ad=za("days"),bd=za("months"),cd=za("years"),ua=Math.round,la={ss:44,s:45,m:45,h:22,d:26,M:11},tb=Math.abs,M=Sa.prototype;M.isValid=function(){return this._isValid};M.abs=function(){var a=this._data;this._milliseconds=ra(this._milliseconds);this._days=ra(this._days);this._months=ra(this._months);a.milliseconds=ra(a.milliseconds);a.seconds=ra(a.seconds);a.minutes=ra(a.minutes);a.hours=ra(a.hours);a.months=
ra(a.months);a.years=ra(a.years);return this};M.add=function(a,b){return $b(this,a,b,1)};M.subtract=function(a,b){return $b(this,a,b,-1)};M.as=function(a){if(!this.isValid())return NaN;var b=this._milliseconds;a=A(a);if("month"===a||"quarter"===a||"year"===a){var c=this._days+b/864E5;c=this._months+4800*c/146097;switch(a){case "month":return c;case "quarter":return c/3;case "year":return c/12}}else switch(c=this._days+Math.round(146097*this._months/4800),a){case "week":return c/7+b/6048E5;case "day":return c+
b/864E5;case "hour":return 24*c+b/36E5;case "minute":return 1440*c+b/6E4;case "second":return 86400*c+b/1E3;case "millisecond":return Math.floor(864E5*c)+b;default:throw Error("Unknown unit "+a);}};M.asMilliseconds=Oc;M.asSeconds=Pc;M.asMinutes=Qc;M.asHours=Rc;M.asDays=Sc;M.asWeeks=Tc;M.asMonths=Uc;M.asQuarters=Vc;M.asYears=Wc;M.valueOf=function(){return this.isValid()?this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*v(this._months/12):NaN};M._bubble=function(){var a=this._milliseconds,
b=this._days,c=this._months,d=this._data;0<=a&&0<=b&&0<=c||0>=a&&0>=b&&0>=c||(a+=864E5*ac(146097*c/4800+b),c=b=0);d.milliseconds=a%1E3;a=w(a/1E3);d.seconds=a%60;a=w(a/60);d.minutes=a%60;a=w(a/60);d.hours=a%24;b+=w(a/24);a=w(4800*b/146097);c+=a;b-=ac(146097*a/4800);a=w(c/12);d.days=b;d.months=c%12;d.years=a;return this};M.clone=function(){return ia(this)};M.get=function(a){a=A(a);return this.isValid()?this[a+"s"]():NaN};M.milliseconds=Xc;M.seconds=Yc;M.minutes=Zc;M.hours=$c;M.days=ad;M.weeks=function(){return w(this.days()/
7)};M.months=bd;M.years=cd;M.humanize=function(a){if(!this.isValid())return this.localeData().invalidDate();var b=this.localeData();var c=!a;var d=ia(this).abs(),e=ua(d.as("s")),f=ua(d.as("m")),g=ua(d.as("h")),h=ua(d.as("d")),k=ua(d.as("M"));d=ua(d.as("y"));e=e<=la.ss&&["s",e]||e<la.s&&["ss",e]||1>=f&&["m"]||f<la.m&&["mm",f]||1>=g&&["h"]||g<la.h&&["hh",g]||1>=h&&["d"]||h<la.d&&["dd",h]||1>=k&&["M"]||k<la.M&&["MM",k]||1>=d&&["y"]||["yy",d];e[2]=c;e[3]=0<+this;e[4]=b;c=Cc.apply(null,e);a&&(c=b.pastFuture(+this,
c));return b.postformat(c)};M.toISOString=Va;M.toString=Va;M.toJSON=Va;M.locale=Sb;M.localeData=Tb;M.toIsoString=G("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Va);M.lang=hc;F("X",0,0,"unix");F("x",0,0,"valueOf");z("x",Za);z("X",/[+-]?\d+(\.\d{1,3})?/);N("X",function(a,b,c){c._d=new Date(1E3*parseFloat(a,10))});N("x",function(a,b,c){c._d=new Date(v(a))});c.version="2.24.0";var jc=P;c.fn=y;c.min=function(){var a=[].slice.call(arguments,0);return Mb("isBefore",
a)};c.max=function(){var a=[].slice.call(arguments,0);return Mb("isAfter",a)};c.now=function(){return Date.now?Date.now():+new Date};c.utc=l;c.unix=function(a){return P(1E3*a)};c.months=function(a,b){return Zb(a,b,"months")};c.isDate=g;c.locale=Ba;c.invalid=u;c.duration=ia;c.isMoment=t;c.weekdays=function(a,b,c){return sb(a,b,c,"weekdays")};c.parseZone=function(){return P.apply(null,arguments).parseZone()};c.localeData=sa;c.isDuration=nb;c.monthsShort=function(a,b){return Zb(a,b,"monthsShort")};c.weekdaysMin=
function(a,b,c){return sb(a,b,c,"weekdaysMin")};c.defineLocale=ib;c.updateLocale=function(a,b){if(null!=b){var c=Gb;var d=Qa(a);null!=d&&(c=d._config);b=B(c,b);b=new C(b);b.parentLocale=S[a];S[a]=b;Ba(a)}else null!=S[a]&&(null!=S[a].parentLocale?S[a]=S[a].parentLocale:null!=S[a]&&delete S[a]);return S[a]};c.locales=function(){return Dc(S)};c.weekdaysShort=function(a,b,c){return sb(a,b,c,"weekdaysShort")};c.normalizeUnits=A;c.relativeTimeRounding=function(a){return void 0===a?ua:"function"===typeof a?
(ua=a,!0):!1};c.relativeTimeThreshold=function(a,b){if(void 0===la[a])return!1;if(void 0===b)return la[a];la[a]=b;"s"===a&&(la.ss=b-1);return!0};c.calendarFormat=function(a,b){a=a.diff(b,"days",!0);return-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse"};c.prototype=y;c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",
TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return c});
function EventEnabledBuilder(c){c.addEventListener=function(a,b){void 0==this._listeners&&(this._listeners={});var c=this._listeners;void 0==c[a]&&(c[a]=[]);-1==c[a].indexOf(b)&&c[a].push(b)};c.hasEventListener=function(a,b){if(void 0==this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1};c.removeEventListener=function(a,b){void 0!=this._listeners&&(a=this._listeners[a],void 0!==a&&(b=a.indexOf(b),-1!==b&&a.splice(b,1)))};c.dispatchEvent=function(a){if(void 0!=
this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;var c=[],f,g=b.length;for(f=0;f<g;f++)c[f]=b[f];for(f=0;f<g;f++)c[f].call(this,a)}}}}
var EfficientMovingCycle=function(){function c(){}function a(){m&&(l.removeEventListener("touchend",m),m=void 0)}function b(){h&&(l.removeEventListener("touchmove",h),h=void 0)}function d(){k&&(l.removeEventListener("mouseup",k),k=void 0)}function f(){g&&(l.removeEventListener("mousemove",g),g=void 0)}var g,k,h,m,l=document.documentElement;return function(n){var p=this,u=n.element,q=n.stopPropagation;this.onEnd=this.onMove=this.onStart=c;if(window.isMobile){var r=function(c){c||(c=window.event);p.onEnd(c)||
(a(),b())},t=function(a){a||(a=window.event);p.onMove(a);a.preventDefault&&a.preventDefault()};u.addEventListener("touchstart",function(c){c||(c=window.event);0!=p.onStart(c)&&(b(),a(),l.addEventListener("touchmove",t),h=t,l.addEventListener("touchend",r),m=r)})}else{var w=function(a){q&&(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault())},v=function(a){a||(a=window.event);p.onEnd(a);d();f();w(a)},x=function(a){a||(a=window.event);p.onMove(a);w(a)};u.addEventListener("mousedown",
function(a){a||(a=window.event);0!=p.onStart(a)&&(f(),d(),l.addEventListener("mousemove",x),g=x,l.addEventListener("mouseup",v),k=v,w(a))})}}}(),DragManager=function(){return function(c){var a,b,d=this,f=c.handle;c=c.stopPropagation;c=new EfficientMovingCycle({element:f.getElement(),stopPropagation:c});var g;c.onStart=function(c){d.onStart&&d.onStart(c);c=f.getAbsolutePosition(c);a=f.getX()-c.left;b=f.getY()-c.top;g=f.getConstraints()};c.onMove=function(c){c={x:c.pageX+a,y:c.pageY+b};c.x>g.maxX?c.x=
g.maxX:c.x<g.minX&&(c.x=g.minX);c.y>g.maxY?c.y=g.maxY:c.y<g.minY&&(c.y=g.minY);f.setPosition(c)};c.onEnd=function(){f.endDrag&&f.endDrag()}}}();function Once(c){function a(){setTimeout(function(){b=!1;c()},0);b=!0}var b=!1;this.trigger=function(){b||a()}}
var VisibilityWatcher=window.VisibilityWatcher=new function(){window.EventEnabledBuilder(this);var c=new Once(function(){console.log(b);a.dispatchEvent({type:"visibilitychange",visible:b})}),a=this,b=!0;this.getIsVisible=function(){return b};visibly.onVisible(function(){b=!0;c.trigger()});visibly.onHidden(function(){b=!1;c.trigger()})};
function Iterator(c){var a=0,b=c.length;this.next=function(){var b=c[a];a++;return b};this.hasNext=function(){return a<b};this.remove=function(){c.splice(a-1,1);a--;b--}}
function ReverseIterator(c){var a=c.length,b=a-1;this.next=function(){var a=c[b];b--;return a};this.previous=function(){b++;return c[b+1]};this.hasNext=function(){return 0<=b};this.hasPrevious=function(){return b+2<a};this.remove=function(){c.splice(b+1,1);a--};this.insert=function(d){c.splice(b+1,0,d);a++};this.insertAfter=function(d){c.splice(b+2,0,d);a++};this.append=function(b){c.push(b);a++}}
var Timer=function(){return function(c){function a(){0<=k&&(h++,h>=k&&d.stop());try{g()}catch(n){console.log(n)}}function b(){l=!1;m&&(clearInterval(m),m=null)}var d=this,f=c.delay,g=c.callback,k=c.nTicks,h=0,m,l=!1;void 0==k&&(k=-1);void 0==f&&(f=1E3);this.stop=b;this.reset=function(){h=0;b()};this.start=function(){l||(l=!0,m=setInterval(a,f))};this.setDelay=function(b){d.reset();f=b;l=!0;m=setInterval(a,f)};this.isRunning=function(){return l}}}();
(function(){function c(b){function c(){var a=0<u.length?u.substr(1,u.length-1):"";t||d();if(!t)return a+"\u205f";for(;a.length<q;){var b=q-a.length;if(t.getLength()<=w){d();if(!t)return a+"\u205f";t.getLength()}b=t.getTextRange(w,b);w+=b.length;a+=b}return a}function d(){for(var a,b=0,c=r.length;b<c;){if(0>v||v>=r.length)v=0;var d=r[v];if(!d.updateTimeout((new Date).getTime())&&x){a=d;break}b++}w=0;return t=a}function f(a){a=a.movingTextItem;var b=r.indexOf(a);0>b||(b<=v&&(v--,t==a&&(t=null)),r.splice(b,
1),n.dispatchEvent({type:"removed",movingTextItem:a}))}function m(){for(var a=0;a<q;a++)u+="\u205f"}function l(a){n.dispatchEvent({type:"displaystring",str:a})}window.EventEnabledBuilder(this);var n=this,p=b["default"],u=p?p:"",q=b.approximateLength;b=new a({movingText:n,extraTicksBeforeStop:q});b.onTick=function(){var a=c();u=a;l(a)};b.onStopped=function(){console.log("onTimerStopped");console.log(p);p&&(u=p,m(),l(u))};var r=[],t,w=0;m();b=window.VisibilityWatcher;setTimeout(function(){l(u)},0);
var v=0,x=!0;this.append=function(a){0<=r.indexOf(a)||(r.push(a),a.addEventListener("dispose",f),n.dispatchEvent({type:"added",movingTextItem:a}))};this.count=function(){return r.length};b.addEventListener("visibilitychange",function(a){console.log(a);console.log(a.visible);x=a.visible})}function a(a){var b=this,c=a.movingText,d=a.extraTicksBeforeStop,f=!0,l=new window.Timer({delay:1E3/9,callback:function(){var a=b.onTick;n&&0>=p--?(l.stop(),(a=b.onStopped)&&a()):a&&a()}});c.addEventListener("removed",
function(){f||0<c.count()||(f=!0,p=d,n=!0)});c.addEventListener("added",function(){f&&(l.start(),n=f=!1)});var n=!1,p=d}String.prototype.a||(String.prototype.a=function(a,b){return this.replace(new RegExp(a,"g"),b)});var b=window.MovingTextItem=function(a){window.EventEnabledBuilder(this);var b=this,c=a.text,f=a.lifecycle;f||(f=new d["default"]);(function(){for(var a;" "==(a=c.substr(c.length-1,1))||"\u2063"==a;)c=c.substr(0,c.length-1);c+="\u205f\u205f\u205f";c=c.a(" ","\u205f")})();var m=!1;this.getText=
function(a){return a<=c.length?c:c.substr(0,c.length)};this.getTextRange=function(a,b){return b+a<=c.length?c.substr(a,b):c.substr(a,c.length-a)};this.getLength=function(){return c.length};this.updateTimeout=function(a){f.setVisible();(a=f.updateTimeout(a))&&b.dispose();return a};this.dispose=function(){m||(m=!0,b.dispatchEvent({type:"dispose",movingTextItem:b}))};this.getDisposed=function(){return m}},d=window.MovingTextLifecycle=function(){function a(a){var b=a.fromVisible,c=a.duration,d,f;!b&&
c&&(f=(new Date).getTime()+c);this.getVisible=function(){return d?!0:!1};this.setVisible=function(){d||(d=(new Date).getTime(),console.log(d),b&&c&&(f=d+c))};this.getTimeoutAt=function(){return f};this.updateTimeout=function(a){if(f)return a>=f}}a["default"]=function(){return new a({fromVisible:!0,duration:1E4})};return a}();window.Title=function(a){window.EventEnabledBuilder(this);var d=new c({approximateLength:70,"default":a["default"]});this.add=function(a){"string"==typeof a?(a=new b({text:a}),
d.append(a)):d.append(a)};d.addEventListener("displaystring",function(a){document.title="\u2063"+a.str})}})();
var FancyTextTranslator=new function(){function c(a,b){for(var c="",d=0;d<b.length;d++){var f=b[d],m=a[f];c+=void 0==m?f:m}return c}var a={" ":" ","!":"!",'"':'"',"#":"#",$:"$","%":"%","&":"&","'":"'","(":"(",")":")","*":"*","+":"+",",":",","-":"-",".":".","/":"/",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",":":":",";":";","<":"<","=":"=",">":">","?":"?","@":"@",A:"\u1d00",B:"\u0299",C:"\u1d04",D:"\u1d05",E:"\u1d07",F:"\u0493",G:"\u0262",H:"\u029c",I:"\u026a",J:"\u1d0a",K:"\u1d0b",
L:"\u029f",M:"\u1d0d",N:"\u0274",O:"\u1d0f",P:"\u1d18",Q:"\u01eb",R:"\u0280",S:"s",T:"\u1d1b",U:"\u1d1c",V:"\u1d20",W:"\u1d21",X:"x",Y:"\u028f",Z:"\u1d22","[":"[","\\":"\\","]":"]","^":"^",_:"_","`":"`",a:"\u1d00",b:"\u0299",c:"\u1d04",d:"\u1d05",e:"\u1d07",f:"\u0493",g:"\u0262",h:"\u029c",i:"\u026a",j:"\u1d0a",k:"\u1d0b",l:"\u029f",m:"\u1d0d",n:"\u0274",o:"\u1d0f",p:"\u1d18",q:"\u01eb",r:"\u0280",s:"s",t:"\u1d1b",u:"\u1d1c",v:"\u1d20",w:"\u1d21",x:"x",y:"\u028f",z:"\u1d22","{":"{","|":"|","}":"}",
"~":"~","\u007f":"\u007f"},b={" ":" ","!":"!",'"':'"',"#":"#",$:"$","%":"%","&":"&","'":"'","(":"(",")":")","*":"*","+":"+",",":",","-":"-",".":".","/":"/",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",":":":",";":";","<":"<","=":"=",">":">","?":"?","@":"@",A:"\u15e9",B:"\u15f7",C:"\u1455",D:"\u15de",E:"\u156e",F:"\u15b4",G:"\u13b6",H:"\u157c",I:"\u13c6",J:"\u148d",K:"\u13e6",L:"\u14aa",M:"\u15f0",N:"\u144e",O:"\u2d54",P:"\u13e2",Q:"\u2d55",R:"\u13d2",S:"\u1515",T:"\u13a2",U:"\u144c",
V:"\u13d9",W:"\u15ef",X:"\u166d",Y:"\u13a9",Z:"\u1614","[":"[","\\":"\\","]":"]","^":"^",_:"_","`":"`",a:"\u15e9",b:"\u15f7",c:"\u1455",d:"\u15de",e:"\u156e",f:"\u15b4",g:"\u13b6",h:"\u157c",i:"\u13c6",j:"\u148d",k:"\u13e6",l:"\u14aa",m:"\u15f0",n:"\u144e",o:"\u2d54",p:"\u13e2",q:"\u2d55",r:"\u13d2",s:"\u1515",t:"\u13a2",u:"\u144c",v:"\u13d9",w:"\u15ef",x:"\u166d",y:"\u13a9",z:"\u1614","{":"{","|":"|","}":"}","~":"~","\u007f":"\u007f"};this.scifi=function(a){return c(b,a)};this.smallBold=function(b){return c(a,
b)}},Notifier=new function(){var c=new Title({"default":"x-chat"});this.show=function(a){"string"==typeof a?c.add(a):"object"==typeof a&&a.inTitle&&c.add(a)}},TemporalCallback=function(){return function(c){function a(){g.stop();k.stop();h=0;b()}var b=c.callback,d=c.maxNTriggers,f=c.maxTotalDelay;c=c.delay;d||f||(f=3*c);var g=new Timer({callback:a,delay:c,nTicks:1}),k=new Timer({callback:a,delay:f,nTicks:1}),h=0;this.trigger=function(){h++;g.isRunning()?d&&h>d?a():g.reset():(g.start(),k.start())}}}();
function Task(c,a){this.run=function(b){setTimeout(function(){try{c()}catch(d){console.error(d)}if(a)try{a()}catch(d){console.error(d)}if(b)try{b()}catch(d){console.error(d)}},0)}}function getAbsolute(c){c=c.getBoundingClientRect();var a=document.documentElement;return{top:c.top+window.pageYOffset-a.clientTop,left:c.left+window.pageXOffset-a.clientLeft,right:c.right+window.pageYOffset-a.clientTop,bottom:c.bottom+window.pageXOffset-a.clientLeft}}
var ImagePreloader=new function(){function c(a){var c=new b({url:a});return f[a]=c}function a(a){function b(a){a=d.indexOf(a.preloader);0>a||d.splice(a,1);1>d.length&&c&&c()}var c=a.callback,d=[];this.addPreloader=function(a){a.addEventListener("done",b);d.push(a)}}function b(a){function b(){c.dispatchEvent({type:"done",preloader:c})}EventEnabledBuilder(this);var c=this;a=a.url;var d=E.IMG(),f=!1;console.log('preloading "'+a+'"');d.onload=function(a){f=!0;b()};d.onerror=function(a){console.log(a);
b()};d.src=a;this.getSuccessful=function(){return f}}var d={},f={};this.preloadRange=function(b,k){var g;each(b,function(b){if(!d[b]){var h=f[b];g||(g=new a({callback:k}));g.addPreloader(h?h:c(b))}});g||k&&k()}},ClickedOff=new function(){function c(a){a=b.indexOf(a);0>a||b.splice(a,1)}function a(a,b,c){var d=[];this.addAdditionalElement=function(a){0>d.indexOf(a)&&d.push(a)};this.removeAdditionalElement=function(a){a=d.indexOf(a);0>a||d.splice(a,1)};this.getElement=function(){return a};this.hide=
function(){c();b()};this.dispose=c}var b=[];this.register=function(d,f){var g=new a(d,f,c);setTimeout(function(){a:{var a=0;for(var c;c=b[a];a++)if(c.getElement()==d){a=!0;break a}a=!1}a||b.push(g)},0);return g};this.remove=function(a){for(var c=new Iterator(b);c.hasNext();){var d=c.next();if(d.getElement()==a){d.dispose();break}}};document.addEventListener("mousedown",function(a){var c=a.pageX;a=a.pageY;for(var d=b.slice(),k=0,h;h=d[k];k++){var m=h.getElement(),l=getAbsolute(m),n=l.left,p=n+m.offsetWidth;
l=l.top;m=l+m.offsetHeight;(c<n||c>p||a<l||a>m)&&h.hide()}})},Popup=new function(){return function(c){function a(a){b(a.popup)}function b(a){g.removeAdditionalElement(a.getElement());a=k.indexOf(a);0>a||k.splice(a,1)}function d(){h.style.display="none";each(k.slice(),b);f.dispatchEvent({type:"hide",popup:f})}c=c||{};EventEnabledBuilder(this);var f=this,g,k=[],h=E.DIV(),m=!1,l=void 0==c.closeOnClickOff?!0:c.closeOnClickOff;h.classList.add("popup");this.show=function(){l&&(g=ClickedOff.register(h,d));
h.style.display="block";m=!0};this.hide=function(){m=!1;l&&g&&g.dispose();d()};this.setPosition=function(a){a.left&&(h.style.left=String(a.left)+"px");a.top&&(h.style.top=String(a.top)+"px");a.right&&(h.style.right=String(a.right)+"px");a.bottom&&(h.style.bottom=String(a.bottom)+"px")};this.dispose=function(){l&&ClickedOff.dispose();h.parentNode.removeChild(h)};this.addChildPopup=function(b){if(!m)throw Error("Cant add child while popup is not showing. Children should be added when made visible only");
g&&(b.addEventListener("hide",a),g.addAdditionalElement(b.getElement()),k.push(b))};this.getElement=function(){return h}}},Heading=function(){function c(a){var b=E.DIV(),c=E.DIV(),f=E.DIV();b.classList.add("heading");f.classList.add("heading-title");c.classList.add("heading-entries");f.title=f.innerHTML=a.title;b.appendChild(f);b.appendChild(c);this.getElement=function(){return b};this.getEntries=function(){return c}}return function(a){a=new c(a);this.getElement=a.getElement;this.getEntries=a.getEntries}}(),
StandardMenu=new function(){function c(a){var b=a.title;EventEnabledBuilder(this);b=a.title;var c=a.classNames,f=a.popup.getElement(),g=E.DIV(),k=E.DIV();k.classList.add("entries");g.classList.add("standard-menu-inner");c&&each(c,function(a){f.classList.add(a)});c=a.buttonClose;var h=E.DIV();h.innerHTML="&nbsp;"+b;h.classList.add("heading");h.appendChild(c.getElement());f.appendChild(g);g.appendChild(h);g.appendChild(k);f.classList.add("standard-menu");each(a.entries,function(a){k.appendChild(a.getElement())});
document.body.appendChild(f);this.getElement=function(){return f};this.getEntries=function(){return k};this.setVisible=function(a){k.style.display=a?"block":"none"}}return function(a){function b(){g.hide()}var d=a.title,f=a.classNames,g=new Popup({});a=new Button({className:"button-close"});d=new c({popup:g,buttonClose:a,entries:[],title:d,classNames:f});this.getElement=d.getElement;this.getEntries=d.getEntries;this.setVisible=d.setVisible;this.show=function(){console.log("show");g.show()};this.hide=
b;a&&a.addEventListener("click",b)}},StandardSearch=function(){function c(a){var b=a.spinner,c=E.DIV(),f=a.callbackSearch;c.classList.add("standard-search-entries");var g=a.standardMenu;a=a.searchBar;g.getElement().appendChild(b.getElement());g.getEntries().appendChild(a.getElement());g.getEntries().appendChild(c);this.getEntries=function(){return c};a.addEventListener("search",f)}return function(a){EventEnabledBuilder(this);var b=a.callbackSearch,d=a.classNames,f=a.getEntryId,g=a.title;a=new Spinner({});
d=new StandardMenu({title:g,classNames:d});g=new SearchBar({});b=new c({standardMenu:d,searchBar:g,callbackSearch:b,spinner:a});new SortedFilteredEntries({element:b.getEntries(),getEntryId:f});this.show=d.show;this.hide=d.hide;this.getEntries=b.getEntries;this.showSpinner=a.show;this.hideSpinner=a.hide}}(),Enumerable=function(){var c=function(a,b,c){this.moveNext=a;this.current=b;this.reset=c};c.fromArray=function(a){return new function(a){var b=-1,f=a.length;return new c(function(){b++;return b<
f},function(){return a[b]},function(){b=-1})}(a)};return c}();Enumerable.prototype.toList=function(){this.reset();for(var c=[];this.moveNext();)c.push(this.current());return c};Enumerable.prototype.select=function(c){var a=this;return new Enumerable(this.moveNext,function(){return c(a.current())},this.reset)};Enumerable.prototype.take=function(c){return function(a,b){var c=0;return new Enumerable(function(){return b.moveNext()&&(c++,c<=a)?!0:!1},b.current,b.reset)}(c,this)};
Enumerable.prototype.leave=function(c){var a=this,b=0;return new Enumerable(function(){return a.moveNext()&&(b++,b>c)?!0:!1},a.current,a.reset)};Enumerable.prototype.where=function(c){var a=this;return new Enumerable(function(){do if(!a.moveNext())return!1;while(!c(a.current()));return!0},this.current,this.reset)};Enumerable.prototype.firstOrDefault=function(){this.reset();this.moveNext();return this.current()};Enumerable.prototype.reverse=function(){this.reset();return Enumerable.fromArray(this.toList().reverse())};
Enumerable.prototype.sum=function(c){this.reset();for(var a=0;this.moveNext();)a+=c(this.current());return a};Enumerable.prototype.count=function(){this.reset();for(var c=0;this.moveNext();)c++;return c};Enumerable.prototype.each=function(c){for(this.reset();this.moveNext();)c(this.current())};Array.prototype.select=function(c){return Enumerable.fromArray(this).select(c)};Array.prototype.where=function(c){return Enumerable.fromArray(this).where(c)};Array.prototype.each=function(c){return Enumerable.fromArray(this).each(c)};
Array.prototype.take=function(c){return Enumerable.fromArray(this).take(c)};Array.prototype.leave=function(c){return Enumerable.fromArray(this).leave(c)};Array.prototype.sum=function(c){return Enumerable.fromArray(this).sum(c)};
var Ajax=function(){function c(b,c){var d=b.parameters,f=b.callbackSuccessful,g=b.callbackFailed,l=b.callbackTimeout,n=b.contentType?b.contentType:"application/json",p=b.timeout,u=new XMLHttpRequest;u.open(c?"POST":"GET",b.url,!0);p&&(u.timeout=p);u.setRequestHeader("Content-Type",n);if(d){n=!0;for(var q in d)n&&(n=!1)}return new a(u,c?b.data:void 0,f,g,l)}function a(a,b,c,h,m){d++;var f=this,g;a.onload=function(){4===a.readyState&&(200===a.status?(g=!0,f.onDone&&f.onDone(f),c&&c(a.responseText)):
(g=!1,console.log("Request failed.  Returned status of "+a.status),f.onDone&&f.onDone(f),h&&h()))};m&&(a.ontimeout=m);a.onprogress=function(a){f.onProgress&&f.onProgress(a.total?a.loaded/a.total:1)};a.send(b);a.onerror=function(a){console.error(a);h&&h(a)};this.getXhr=function(){return a};this.abort=a.abort;this.getSuccessful=function(){return g}}var b=function(a){var c=a.url;this.post=function(a){a.url=a.url?a.url:c;return b.post(a)};this.get=function(a){a.url=a.url?a.url:c;return b.get(a)}};b.post=
function(a){return c(a,!0)};b.get=function(a){return c(a,!1)};var d=0;return b}(),Longpoll=function(){return function(c){function a(){q.get({url:D+("?t="+u++ +"_"+(new Date).getTime()),callbackSuccessful:k,callbackFailed:g,callbackTimeout:f})}function b(b){console.log(b);b=JSON.parse(b);b.disposed?(v=!0,l.dispose()):t||(t=!0,p=b.id,D=n+"/"+p,m(p),each(x,function(a){l.send(a)}),x=null,a())}function d(a){console.error(a);l.onError&&l.onError(a)}function f(){a()}function g(b){console.error(b);l.onError&&
l.onError(b);r||a()}function k(b){a();b&&(b=JSON.parse(b),b.disposed&&l.dispose(),h(b))}function h(a){a.msgs&&each(a.msgs,function(a){console.log(a);l.onMessage&&l.onMessage(a)})}function m(a){console.log("dispatchGotId");l.onGotId&&l.onGotId(a)}var l=this,n=c.url,p=c.id,u=0,q=new Ajax({url:n}),r=!1,t=!1,w=!1,v=!1,x=[],D;this.send=function(a){r||(t||!w?(w=!0,q.post({data:JSON.stringify({id:p,msg:a}),callbackSuccessful:b,callbackFailed:d})):x.push(a))};this.getDisposedByServer=function(){return v};
this.dispose=function(){r||(r=!0,l.onDispose&&l.onDispose())}}}();
function Spinner(c){function a(a){g.addEventListener(a,function(a){a||(a=window.event);a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1})}var b=c.preventInterraction,d=this;c=E.DIV();c.classList.add("spinner");for(var f=0;3>f;f++)c.appendChild(E.DIV());if(b){b=E.DIV();b.classList.add("prevent-interraction");document.documentElement.appendChild(b);b.appendChild(c);var g=b}else g=c;g.style.display="none";this.getElement=function(){return g};this.show=function(){d.setVisible(!0)};
this.hide=function(){d.setVisible(!1)};this.setVisible=function(a){g.style.display=a?"inline-block":"none";a&&b&&setTimeout(function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur()},0)};b&&(a("click"),a("mousedown"),a("mouseup"))}var Settings=function(){return function(c){this.get=function(a){try{var b=window.localStorage.getItem(c+"_"+a);return null==b||void 0==b?void 0:JSON.parse(b)}catch(d){}};this.set=function(a,b){try{window.localStorage.setItem(c+"_"+a,JSON.stringify(b))}catch(d){console.log(d)}}}}();
function TabPanel(c,a,b){function d(a,b,c){this.div=E.DIV();var d=E.DIV();this.div.style.width=String(l)+"%";this.div.style.left=String(c*l)+"%";this.div.classList.add("tab");d.classList.add("name");this.div.appendChild(d);d.innerHTML=a;this.div.addEventListener("mousedown",function(){g(b)});this.close=function(){};this.setActive=function(){this.div.style.height="18px"};this.setInactive=function(){this.div.style.height="17px"}}function f(){var b=this;this.div=E.DIV();this.div.style.height=a?"auto":
"calc(100% - 3px)";this.div.style.position=a?"relative":"absolute";this.div.classList.add("panel");this.show=function(){b.div.style.display="inline"};this.hide=function(){b.div.style.display="none"};this.close=function(){}}function g(a){for(var b=0;b<k.panels.length;b++){var c=k.panels[b];c.hide();if(a!=c)k.tabs[b].setInactive();else if(k.tabs[b].setActive(),k.onChangeTab)k.onChangeTab(b)}a.show()}var k=this;this.panels=[];this.tabs=[];b=c.length;this.div=E.DIV();var h=E.DIV(),m=E.DIV();m.classList.add("tabs");
this.div.style.height=a?"auto":"100%";this.div.classList.add("tab-panel");var l=100/b;h.style.height=a?"auto":"calc(100% - 20px)";h.style.width="100%";a||(h.style.top="20px");h.style.float="left";h.style.position=a?"relative":"absolute";this.div.appendChild(m);this.div.appendChild(h);for(var n=0;n<b;n++){var p=new f,u=new d(c[n],p,n);k.panels.push(p);k.tabs.push(u);h.appendChild(p.div);m.appendChild(u.div)}g(k.panels[0]);this.close=function(){for(var a=0;a<k.panels.length;a++)k.panels[a].close(),
k.tabs[a].close()}}
var WindowResizeManager=new function(){EventEnabledBuilder(this);var c=this;window.addEventListener("resize",function(){console.log("doing resize");c.dispatchEvent({type:"resized"})})},ResizeManager=new function(){function c(a){function b(){h.trigger()}function c(a){if(m){if(a=m,m=g.getBoundingClientRect(),a.height!=m.height||a.width!=m.width)f.dispatchEvent({type:"resized"}),k&&k()}else m=g.getBoundingClientRect()}EventEnabledBuilder(this);var f=this,g=a.element,k=a.onResized,h=(a=a.staggered)?new TemporalCallback({callback:c,
delay:500,maxTotalDelay:800}):void 0,m;this.manual=function(){c()};window.ResizeObserver?(new window.ResizeObserver(a?b:c)).observe(g):WindowResizeManager.addEventListener("resized",a?b:c)}EventEnabledBuilder(this);this.add=function(a){return new c(a)}},Tickbox=function(){return function(c){function a(){b?f.classList.contains("ticked")||f.classList.add("ticked"):f.classList.contains("ticked")&&f.classList.remove("ticked")}var b=!1,d=E.DIV();d.classList.add("tickbox");var f=E.DIV();f.classList.add("box");
if(c.text){var g=E.DIV();g.classList.add("text");d.appendChild(g);g.innerHTML=c.text}d.appendChild(f);this.getElement=function(){return d};this.setTicked=function(c){b=c;a()};this.getTicked=function(){return b};f.addEventListener("click",function(){b=!b;a()})}}();function Genders(){}
function GenderPicker(){var c=document.createElement("select");c.classList.add("gender");for(var a=0;a<Genders.values.length;a++){var b=Genders.values[a],d=document.createElement("option");d.innerHTML=b.txt;d.value=b.value;c.appendChild(d)}this.getValue=function(){return c.options[c.selectedIndex].value};this.getElement=function(){return c}}
Genders.values=[{value:0,txt:"a man"},{value:1,txt:"a woman"},{value:2,txt:"a couple(man + woman)"},{value:3,txt:"a couple of men"},{value:4,txt:"a couple of women"},{value:5,txt:"a transexual man"},{value:6,txt:"a transexual women"}];
function Birthday(){function c(a,b){var c=document.createElement("option");c.value=a;c.innerHTML=b;return c}var a=E.DIV(),b=E.SELECT(),d=E.SELECT(),f=E.SELECT();a.classList.add("birthday");a.appendChild(b);a.appendChild(d);a.appendChild(f);b.classList.add("not-right");d.classList.add("not-right");var g=1900+(new Date).getYear(),k="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");b.appendChild(c(void 0,"Day"));d.appendChild(c(void 0,"Month"));f.appendChild(c(void 0,"Year"));for(var h=1;32>
h;h++){var m=c(h,String(h));b.appendChild(m)}for(h=1;12>h;h++)m=c(h,k[h]),d.appendChild(m);g-=17;for(h=g-100;h<g;h++)m=c(h,String(h)),f.appendChild(m);this.getElement=function(){return a};this.getValue=function(){var a=b.options[b.selectedIndex].value,c=d.options[d.selectedIndex].value,g=f.options[f.selectedIndex].value;return{day:"undefined"==a?void 0:parseInt(a),month:"undefined"==c?void 0:parseInt(c),year:"undefined"==g?void 0:parseInt(g)}}}
var Authenticate=function(){return function(c){function a(){if(1>B.value.length)h("You must enter an email address!");else if(1>C.value.length)h("You must enter a username!");else if(1>H.value.length)h("You must enter a password!");else if(1>I.value.length)h("You must re-enter your password!");else if(H.value!=I.value)h("The passwords entered do not match!");else{p.show();var a=ma.getValue();a.year?void 0==a.month?h("You must enter a birth month!"):a.day?(a={email:B.value,username:C.value,password:H.value,
gender:ca.getValue(),birthday:a,staySignedIn:K.getTicked()},m(a)):h("You must enter a birth day!"):h("You must enter a birth year!")}}function b(){p.show();l({password:G.value,username:v.value,staySignedIn:x.getTicked()})}function d(){p.show();n({username:A.value,staySignedIn:D.getTicked()})}function f(c){c=c||window.event;if(13==c.keyCode)switch(Y){case W.Guest:d();break;case W.SignIn:b();break;default:a()}}function g(a,b){a.classList.add("entry");a.placeholder=b;t.appendChild(a)}function k(a,b){a.classList.add("entry");
a.placeholder=b;F.appendChild(a)}function h(a){a?(p.hide(),ja.style.display="inline",L.innerHTML=a):ja.style.display="none"}var m=c.callbackRegister,l=c.callbackSignIn,n=c.callbackGuest,p=new Spinner({preventInterraction:!0});document.documentElement.appendChild(p.getElement());var u=new Settings("#username",function(){this.set("username")}),q=E.DIV(),r=E.DIV(),t=E.DIV(),w=E.DIV(),v=E.TEXT(),x=new Tickbox({text:"Stay signed in"}),D=new Tickbox({text:"Stay signed in"}),G=E.PASSWORD(),H=E.PASSWORD(),
I=E.PASSWORD(),B=E.TEXT(),C=E.TEXT(),K=new Tickbox({text:"Stay signed in"}),A=E.TEXT();c=new Button({classNames:["button-register"],text:"Enter"});var U=new Button({classNames:["button-register"],text:"Done"}),ja=E.DIV(),L=E.TEXTAREA();q.classList.add("authenticate");r.classList.add("div-inner");t.classList.add("div-inputs-sign-in");var F=E.DIV();A.className="form-control";C.className="form-control";B.className="form-control";I.className="form-control";H.className="form-control";G.className="form-control";
v.className="form-control";var ma=new Birthday,ca=new GenderPicker;r=new Button({classNames:["button-register"],text:"Done"});k(B,"Email");k(C,"Username");k(H,"Password");k(I,"Re-enter Password");A.onkeydown=f;G.onkeydown=f;B.onkeydown=f;C.onkeydown=f;H.onkeydown=f;I.onkeydown=f;F.appendChild(ca.getElement());F.appendChild(ma.getElement());F.appendChild(K.getElement());F.appendChild(r.getElement());F.classList.add("inputs-register");w.appendChild(A);r.addEventListener("click",a);(function(a,b){a.classList.add("entry");
a.placeholder=b;w.appendChild(a)})(A,"Username");g(v,"Username");g(G,"Password");G.type="password";ja.classList.add("error");L.classList.add("error-text");L.readOnly=!0;c.innerHTML="Enter";this.setError=h;U.addEventListener("click",d);c.addEventListener("click",b);v.onkeydown=f;v.addEventListener("click",function(){v.focus()});var W={Guest:0,SignIn:1,Register:2},Y=W.Guest;r=new TabPanel(["Guest","Sign In","Register"],!0);r.onChangeTab=function(a){h("");switch(a){case 1:Y=W.SignIn;break;case 2:Y=W.Register;
break;default:Y=W.Guest}};q.appendChild(r.div);r.panels[0].div.appendChild(w);r.panels[1].div.appendChild(t);r.panels[2].div.appendChild(F);r.panels[2].div.className="panel";r.div.style.height="auto";r.div.style.position="relative";w.appendChild(D.getElement());w.appendChild(U.getElement());t.appendChild(x.getElement());t.appendChild(c.getElement());q.appendChild(ja);ja.appendChild(L);document.body.appendChild(q);if(c=u.get("username"))v.value=c;this.show=function(){q.style.display="block"};this.hide=
function(){p.setVisible(!1);q.style.display="none";u.set("username",v.value);H.value="";I.value="";G.value=""}}}(),MappedSets=function(){function c(a){var b=this,c=[a];this.add=function(a){if(b.contains(a))return!1;c.push(a);return!0};this.remove=function(a){a=c.indexOf(a);if(0>a)return!1;c.splice(a,1)};this.contains=function(a){return 0<=c.indexOf(a)};this.getList=function(){return c};this.count=function(){return c.length}}return function(){var a={};this.add=function(b,d){if(!d)return!1;var f=a[b];
return f?f.add(d):(a[b]=new c(d),!0)};this.remove=function(b,c){var d=a[b];if(!d)return!1;if(!c)return delete a[b],!0;if(!d.remove(c))return!1;1>d.count()&&delete a[b];return!0};this.contains=function(b,c){return(b=a[b])?c?b.contains(c):!0:!1};this.getList=function(b){console.log(a);if(b=a[b])return b.getList()}}}(),TabPortal=new function(){function c(a,b){this.receivedMessage=b}var a=new MappedSets,b=new BroadcastChannel("x-chat");b.onmessage=function(b){var c=b.data;c.id&&(b=a.getList(c.id))&&b.each(function(a){return a.receivedMessage(c.message)})};
return function(d){var f=d.id;EventEnabledBuilder(this);var g=this;this.sendMessage=function(a){console.log("send");console.log(a);b.postMessage({id:f,message:a})};this.dispose=function(){a.remove(f,g);g.dispatchEvent({type:"closed"})};a.add(f,new c(g,function(a){g.dispatchEvent({type:"message",message:a})}))}},OnlineIndicators=function(){var c={},a=function(a){EventEnabledBuilder(this);var b=this,c=!1;this.setOnline=function(a){a?c||b.dispatchEvent({type:"cameonline"}):c&&b.dispatchEvent({type:"wentoffline"});
c=a};this.setHasPm=function(a){a?b.dispatchEvent({type:"haspm"}):b.dispatchEvent({type:"doesnthavepm"})};this.getOnline=function(){return c}},b={get:function(b){var d=c[b];if(d)return d;d=new a;return c[b]=d},setOnline:function(a,c){b.get(a).setOnline(c)},setHasPm:function(a,c){b.get(a).setHasPm(c)}};return b}();
function OnlineIndicatorUI(c,a){function b(a){f.classList.add("online");f.classList.remove("offline")}function d(a){f.classList.remove("online");f.classList.add("offline")}var f=E.DIV();f.classList.add("online-indicator");this.getElement=function(){return f};c.addEventListener("cameonline",b);c.addEventListener("wentoffline",d);c.addEventListener("haspm",function(a){f.classList.add("pm")});c.addEventListener("doesnthavepm",function(a){f.classList.remove("pm")});(c.getOnline()?b:d)();this.dispose=
function(){c.addEventListener("cameonline",b);c.addEventListener("wentoffline",d)}}
var Ignored=function(){var c=function(a){this.getUsername=function(){return a.username};this.getId=function(){return a.id};this.toJSON=function(){return a};this.getImage=function(){return a.image}};c.fromUser=function(a){return new c({id:a.getId(),username:a.getUsername(),image:a.getImage()})};c.fromJSON=function(a){return new c(a)};return c}(),IgnoreManager=new function(){return function(c){function a(){l.set("ignores",n.getEntries().select(function(a){return a.toJSON()}).toList())}function b(a,
b){k.dispatchEvent({type:"ignored",userId:a,ignored:b})}function d(a,b){k.dispatchEvent({type:"unignored",userId:a,ignored:b})}function f(c){n.add(c)&&(a(),b(c.getId(),c),g.sendMessage({type:"ignore",ignored:c.toJSON()}))}EventEnabledBuilder(this);var g=new TabPortal({id:"IgnoreManager"}),k=this,h=c.getUserById,m=c.getUserMe,l=new Settings("ignore"),n=new Set({getEntryId:function(a){return a.getId()}});this.ignoreUser=function(a){a=Ignored.fromUser(a);f(a)};this.ignoreUserById=function(a){!k.userIdIsIgnored(a)&&
(a=h(a))&&(a=Ignored.fromUser(a),f(a))};this.ignoreUserByIdAndUsername=function(a){a=Ignored.fromJSON(a);f(a)};this.unignoreUser=function(a){k.unignoreUserById(a.getId())};this.unignoreUserById=function(a){if(a=n.removeById(a))d(a.getId(),a),g.sendMessage({type:"unignore",ignored:a.toJSON()})};this.userIsIgnored=function(a){return k.userIdIsIgnored(a.getId())};this.userIdIsIgnored=function(a){return n.containsId(a)};this.getIgnores=function(){return n.getEntries()};this.clearSave=function(){l.set("ignores",
[])};this.load=function(){var a=l.get("ignores");a&&each(a,function(a){n.add(Ignored.fromJSON(a))})};g.addEventListener("message",function(c){var f=Ignored.fromJSON(c.message.ignored);switch(c.message.type){case "ignore":f.getId()!=m().getId()&&n.add(f)&&(a(),b(f.getId(),f));break;case "unignore":n.remove(f)&&(a(),d(f.getId(),f))}})}},OverflowManager=new function(){return function(c){var a=c.getMessages,b=c.remove,d=c.maxNMessages;this.trigger=(new TemporalCallback({callback:function(){var c=a().where(function(a){return!a.getIgnored()}).toList(),
g=c.length-d;1>g||each(c.take(g).toList(),function(a){b(a)})},maxNDelays:50,maxTotalDelay:6E3})).trigger}},ChannelType={JSONP:"jsonp",LONGPOLL:"longpoll",WEBSOCKET:"websocket"},MysocketChannelAnalysis=new function(){return function(c){EventEnabledBuilder(this);var a=this,b=!1,d=[],f,g,k=new StopWatch;this.getSuccessfullyOpened=function(){return b};this.getOpenForMilliseconds=k.getMilliseconds;this.getOpenForSeconds=k.getSeconds;this.getOpenedAt=function(){return f};this.getClosedAt=function(){return g};
this.getChannelType=function(){return c};this.opened=function(){b=!0;f=(new Date).getTime();k.start()};this.receivedMessage=function(){};this.closed=function(){k.stop();g=(new Date).getTime();a.dispatchEvent({type:"closed",mysocketChannelAnalysis:a})};this.error=function(a){for(d.push(a);30<d.length;)d.splice(0,1)}}},MysocketAnalysis=function(){return function(c){function a(){return b().where(function(a){return 5E3>a.getOpenForMilliseconds()}).count()}function b(){return d().where(function(a){return a.getChannelType()==
ChannelType.WEBSOCKET})}function d(){var a=(new Date).getTime(),b=g.length-1,c=[];a-=6E4;for(console.log("channelAnalysiss.length is: "+g.length);0<=b;){var d=g[b];if(a<d.getClosedAt())c.push(d);else break;b--}return c}function f(a){console.log("channelAnalysisClosed");a=a.mysocketChannelAnalysis;a.removeEventListener("closed",f);for(g.push(a);20<g.length;)g.splice(0,1);a.getChannelType()}var g=[],k;this.getRecommendedTypes=function(){var b=a(),c,d=(window.WebSocket?!0:!1)&&!(c=0<b);console.log("nRecentWebsocketsFailedQuickly"+
b);console.log("shouldUseWebsocket"+d);console.log("websocket failed quickly"+c);d&&c&&(console.log("websocket failed quickly"),b=6E4<(new Date).getTime()-c.getOpenedAt(),console.log("shouldAttemptWebsocketAgain"+b),d=b);return d?[ChannelType.WEBSOCKET,ChannelType.LONGPOLL]:[ChannelType.LONGPOLL]};this.getRecommendedDelayBeforeCreatingChannel=function(){console.log(1>g.length);if(1>g.length)return{type:When.NOW};for(var a=0,b=(new Date).getTime()-6E4,c=g.length-1;0<=c;c--)if(g[c].getOpenedAt()>b)a++;
else break;return 3<a?{type:When.SECONDS,seconds:5}:2E3<(new Date).getTime()-g[g.length-1].getClosedAt()?{type:When.NOW}:{type:When.SECONDS,seconds:1}};this.add=function(a){k=a;a.addEventListener("closed",f)};this.clear=function(){k.closed();g=[];k=void 0}}}(),MysocketChannelManager=function(){return function(c){function a(){console.log("callbackCreateChannel");b();d.dispatchEvent({type:"newchannel",channel:m});l=!1}function b(){console.log("get id is: "+h());return m=MysocketChannelFactory.create({id:h(),
urlWebsocket:k,url:g,mysocketAnalysis:f})}EventEnabledBuilder(this);var d=this,f=c.mysocketAnalysis,g=c.url,k=c.urlWebsocket,h=c.getId,m,l=!1;this.wouldLikeNewChannel=function(){if(!l){var c=f.getRecommendedDelayBeforeCreatingChannel();console.log("Reccomended delay before creating a channel was: "+c.type);console.log(c);switch(c.type){case When.NOW:return b();case When.SECONDS:c=c.seconds,console.log(c),c*=1E3,l=!0,console.log("function createNewChannelAfterDelayMilliseconds(milliseconds){"),(new Timer({delay:c,
callback:a,nTicks:1})).start()}}}}}(),MysocketChannelFactory=new function(){function c(a,c){var b=this,d=new MysocketChannelAnalysis(ChannelType.WEBSOCKET),k=!1;this.send=function(a){h.send(JSON.stringify(a))};this.getAnalysis=function(){return d};this.getChannelType=function(){return ChannelType.WEBSOCKET};this.isOpen=function(){return h&&h.readyState==h.OPEN};var h=new WebSocket(c+(a?"?mysocketId="+a:""));h.onmessage=function(c){c=JSON.parse(c.data);c.mysocketId&&(a=c.mysocketId);c.disposed?(k=
!0,h.close()):(d.receivedMessage(),b.onMessage&&b.onMessage(c))};h.onopen=function(){d.opened();b.onOpen&&b.onOpen()};h.onclose=function(){d.closed();b.onClose&&b.onClose()};h.onerror=function(a){d.error(a);console.log(a);b.onError&&b.onError(a)};this.close=function(){h.close()};this.getDisposedByServer=function(){return k};window.channel=this}function a(a,c){function b(){k||(k=!0,m.dispose(),h.closed(),d.onClose&&d.onClose())}var d=this,k=!1,h=new MysocketChannelAnalysis(ChannelType.LONGPOLL),m=
new Longpoll({url:c,id:a});m.onMessage=function(a){h.receivedMessage();d.onMessage&&d.onMessage(a)};m.onError=function(a){h.error(a);console.log(a);b();d.onError&&d.onError(a)};m.onSent=function(){};m.onDispose=function(){b()};window.channel=this;this.close=b;this.send=m.send;this.getAnalysis=function(){return h};this.getChannelType=function(){return ChannelType.LONGPOLL};this.getDisposedByServer=m.getDisposedByServer;setTimeout(function(){h.opened();d.onOpen&&d.onOpen()},0);this.isOpen=function(){return!k}}
this.create=function(b){var d=b.mysocketAnalysis.getRecommendedTypes();console.log("The recommended channel types was: "+d);switch(d[0]){case Mysocket.WEBSOCKET:return new c(b.id,b.urlWebsocket);default:return new a(b.id,b.url)}}},Mysocket=function(){var c=function(a){function b(){if(l)return l;(l=r.wouldLikeNewChannel())&&c(l)}function c(a){a.onClose=g;a.onOpen=k;a.onMessage=f;q.add(a.getAnalysis())}function f(a){"mysocket_id"==a.type?n=a.id:(console.log(a),m.dispatchEvent({type:"message",msg:a}))}
function g(){var a=l.getDisposedByServer();l=null;a?m.dispatchEvent({type:"disposedbyserver"}):u||setTimeout(b,0)}function k(){if(0<p.length)for(var a=new Iterator(p);a.hasNext();){var b=a.next();try{l&&l.isOpen()&&l.send(b),a.remove()}catch(v){break}}else l&&l.isOpen()&&l.send({type:"hi"});m.dispatchEvent({type:"open"})}var h=a.url;a=a.urlWebsocket;EventEnabledBuilder(this);var m=this,l,n,p=[],u=!1;this.reset=function(){u=!0;n=null;p=[];l&&l.dispose();l=null;q.clear()};this.send=function(a){u=!1;
var c=b();c&&c.isOpen()?c.send(a):p.push(a)};this.getUrl=function(){return h};var q=new MysocketAnalysis({mysocket:this}),r=new MysocketChannelManager({mysocketAnalysis:q,urlWebsocket:a,url:h,getId:function(){return n}});r.addEventListener("newchannel",function(a){l=a.channel;c(l)});b()};c.JSONP="jsonp";c.LONGPOLL="longpoll";c.WEBSOCKET="websocket";return c}(),SplitPane=function(){function c(a){function b(a){if(a)switch(a.getUnit()){case Dimension.PX:return a.getValue();case Dimension.PERCENT:return a.getValue()*
f()/100}}EventEnabledBuilder(this);var c=this,d=a.panels,f=a.getPaneHeight,g=a.minHeight,k=!0;g?g.isDimension||(g=new Dimension(g)):g=Dimension.pixels(20);var q=a.maxHeight;q&&!q.isDimension&&(q=new Dimension(q));var r=a.height;r&&!r.isDimension&&(r=new Dimension(r));var t;this.setAssociatedSlider=function(a){t=a};this.getAssociatedSlider=function(){return t};this.getTop=function(){return d[0].getTop()};this.setVisible=function(a){k=a;each(d,function(b){b.setVisible(a)});c.dispatchEvent({type:"setvisible",
visible:a})};this.getVisible=function(){return k};this.setTop=function(a){each(d,function(b){b.setTop(a)})};this.setBottom=function(a){var b=c.getTop();c.setHeight(a-b)};this.getDesiredHeight=function(){return b(r)};this.getHeight=function(){return d[0].getHeight()};this.setHeight=function(a){each(d,function(b){b.setHeight(a)})};this.getMinHeight=function(){return b(g)}}function a(a){function b(a){if(a)switch(a.getUnit()){case Dimension.PX:return a.getValue();case Dimension.PERCENT:return a.getValue()*
d()/100}}EventEnabledBuilder(this);var c=this,d=a.getPaneWidth,f=a.minWidth,g=!0;f?f.isDimension||(f=new Dimension(f)):f=Dimension.pixels(20);var k=a.maxWidth;k&&!k.isDimension&&(k=new Dimension(k));var q=a.width;q&&!q.isDimension&&(q=new Dimension(q));var r=[],t;this.getFirstPanel=function(){return r[0]};this.setAssociatedSlider=function(a){t=a};this.getAssociatedSlider=function(){return t};this.setVisible=function(a){g=a;each(r,function(b){b.setVisible(a)});c.dispatchEvent({type:"setvisible",visible:a})};
this.getVisible=function(){return g};this.getPanel=function(a){return r[a]};this.setPanelColumnRight=function(a){};this.addNextPanel=function(a){r.push(a)};this.setLeft=function(a){each(r,function(b){b.setLeft(a)})};this.getLeft=function(){return r[0].getLeft()};this.setLeft=function(a){each(r,function(b){b.setLeft(a)})};this.setRight=function(a){var b=c.getLeft();c.setWidth(a-b)};this.getWidth=function(){return r[0].getWidth()};this.getDesiredWidth=function(){return b(q)};this.setWidth=function(a){each(r,
function(b){b.setWidth(a)})};this.getMinWidth=function(){return b(f)}}function b(a){var b=E.DIV();b.classList.add("panel");a.isLeft&&b.classList.add("panel-left");a.isRight&&b.classList.add("panel-right");a.isTop&&b.classList.add("panel-top");a.isBottom&&b.classList.add("panel-bottom");this.setVisible=function(a){b.style.display=a?"block":"none"};this.getElement=function(){return b};this.setTop=function(a){b.style.top=String(a)+"px"};this.setLeft=function(a){b.style.left=String(a)+"px"};this.setWidth=
function(a){b.style.width=String(a)+"px"};this.getWidth=function(){return b.clientWidth};this.getLeft=function(){return b.offsetLeft};this.getTop=function(){return b.offsetTop};this.setHeight=function(a){b.style.height=String(a)+"px"};this.getHeight=function(){return b.clientHeight}}function d(a){function b(){return w.offsetLeft}var c=this,d=a.leftPanelColumn,f=a.getNextSiblingVisible,g,k,q,r,t,w=E.DIV();w.classList.add("slider");w.classList.add("x");d.setAssociatedSlider(this);this.updateVisibility=
function(){if(d.getVisible()){var a=f(d);a&&a.getVisible()?c.setVisible(!0):c.setVisible(!1)}else c.setVisible(!1)};this.setVisible=function(a){w.style.display=a?"block":"none"};this.setLeft=function(a){w.style.left=String(a)+"px";d.setRight(a);var b=f(d);b&&b.setLeft(a+c.getWidth())};this.getWidth=function(){return w.getBoundingClientRect().width};this.getConstraints=function(){t=f(d);g=d.getWidth();k=t.getWidth();q=t.getLeft();r=b();w.getBoundingClientRect();var a=b(),c=a-(d.getWidth()-d.getMinWidth());
a+=t.getWidth()-t.getMinWidth();return{minX:c,maxX:a}};this.getElement=function(){return w};this.getX=b;this.getY=function(){return w.offsetTop};this.setPosition=function(a){a=a.x;var b=a-r;w.style.left=String(a)+"px";d.setWidth(g+b);t.setWidth(k-b);t.setLeft(q+b)};this.endDrag=function(){};this.getAbsolutePosition=function(){return getAbsolute(w)};new DragManager({handle:this})}function f(a){var b=this,c=a.getNextSiblingVisible,d=a.topPanelRow,f,g,k,q,r,t=E.DIV();t.classList.add("slider");t.classList.add("y");
d.setAssociatedSlider(this);this.updateVisibility=function(){if(d.getVisible()){var a=c(d);a&&a.getVisible()?b.setVisible(!0):b.setVisible(!1)}else b.setVisible(!1)};this.setVisible=function(a){t.style.display=a?"block":"none"};this.setTop=function(a){t.style.top=String(a)+"px";d.setBottom(a);var f=c(d);f&&f.setTop(a+b.getHeight())};this.getHeight=function(){return t.getBoundingClientRect().height};this.getConstraints=function(){k=c(d);q=d.getHeight();f=k.getHeight();g=k.getTop();r=t.offsetTop;t.getBoundingClientRect();
var a=t.offsetTop,b=a-(d.getHeight()-d.getMinHeight());a+=k.getHeight()-k.getMinHeight();return{minY:b,maxY:a}};this.getElement=function(){return t};this.getX=function(){return t.offsetLeft};this.getY=function(){return t.offsetTop};this.setPosition=function(a){var b=a.y-r;t.style.top=String(a.y)+"px";d.setHeight(q+b);k.setHeight(f-b);k.setTop(g+b)};this.endDrag=function(){};this.getAbsolutePosition=function(){return getAbsolute(t)};new DragManager({handle:this})}function g(){var a=[];this.add=function(b){a.push(b)};
this.count=function(){return a.length};this.get=function(b){return a[b]};this.updateVisibility=function(){each(a,function(a){a.updateVisibility()})}}return function(k){var h;function m(){D=!0;I.updateVisibility();B.updateVisibility();u(C.getBoundingClientRect().width,1>I.count()?0:I.get(0).getWidth(),function(a){return a.getDesiredWidth()});p(q(),1>B.count()?0:B.get(0).getHeight());h=C.getBoundingClientRect().width;q()}function l(a){return C.getBoundingClientRect().width/h*a.getWidth()}function n(){var a=
[];this.add=function(b){a.push(b)};this.get=function(b){return a[b]};this.getVisible=function(){var b=[];each(a,function(a){a.getVisible()&&b.push(a)});return b};this.count=function(){return a.length};this.getNextSiblingVisible=function(b){for(var c=0;c<a.length;c++)if(a[c]==b){for(b=c+1;b<a.length;b++)if(c=a[b],c.getVisible())return c;break}}}function p(a,b){var c=a,d=G.getVisible(),f=d.length,g=0;d[0].setTop(0);for(var h=0;h<f;h++){var k=d[h],m=d.slice(h+1),l=m.length;m=m.sum(function(a){return a.getMinHeight()})+
l*b;var n=k.getDesiredHeight(),p=h>=f-1;if(!n||p)n=(c-l*b)/(l+1);c-n<m&&(n=c-m);p?k.setBottom(a):k.getAssociatedSlider().setTop(g+n);g=g+n+b;c=a-g}}function u(a,b,c){var d=a,f=H.getVisible(),g=f.length,h=0;f[0].setLeft(0);for(var k=0;k<g;k++){var m=f[k],l=f.slice(k+1),n=l.length;l=l.sum(function(a){return a.getMinWidth()})+n*b;var p=c(m),u=k>=g-1;if(!p||u)p=(d-n*b)/(n+1);d-p<l&&(p=d-l);u?m.setRight(a):m.getAssociatedSlider().setLeft(h+p);h=h+p+b;d=a-h}}function q(){return C.getBoundingClientRect().height}
function r(){m()}var t=k.nPanelsWidth,w=k.nPanelsHeight,v=k.rowProfiles,x=k.columnProfiles,D=!1;EventEnabledBuilder(this);var G=new function(){return new n},H=new function(){return new n},I=new g,B=new g,C=E.DIV();C.classList.add("split-pane");this.getElement=function(){return C};this.getPanelColumns=function(){return H};this.getPanelRows=function(){return G};this.getPanelRow=G.get;this.getPanelColumn=H.get;this.getPanelXY=function(a,b){return H.get(a).getPanel(b)};(function(){for(var b,c=0;c<t;c++){var d=
x?x[c]:void 0;d=new a({panelColumnLeft:H.get(c-1),minWidth:d?d.minWidth:void 0,width:d?d.width:void 0});d.addEventListener("setvisible",r);b&&b.setPanelColumnRight(d);b=d;H.add(d)}})();(function(){for(var a,d=0;d<w;d++){for(var f=[],g=v?v[d]:void 0,h=0;h<t;h++){var k=new b({isLeft:1>h?!0:!1,isRight:h>=t-1?!0:!1,isTop:1>d?!0:!1,isBottom:d>=w-1?!0:!1});C.appendChild(k.getElement());H.get(h).addNextPanel(k);f.push(k)}f=new c({rowAbove:a,panels:f,minHeight:g?g.minHeight:void 0,height:g?g.height:void 0,
getPaneHeight:q});f.addEventListener("setvisible",r);a=f;G.add(f)}})();(function(){for(var a=0;a<t-1;a++){var b=new d({leftPanelColumn:H.get(a),getNextSiblingVisible:H.getNextSiblingVisible});I.add(b);C.appendChild(b.getElement())}for(a=0;a<w-1;a++)b=new f({topPanelRow:G.get(a),getNextSiblingVisible:G.getNextSiblingVisible}),B.add(b),C.appendChild(b.getElement())})();this.resize=function(){if(!D)return m();I.updateVisibility();B.updateVisibility();u(C.getBoundingClientRect().width,1>I.count()?0:I.get(0).getWidth(),
l);p(q(),1>B.count()?0:B.get(0).getHeight());h=C.getBoundingClientRect().width;q()};this.initialize=m}}(),ClientClientVideoAudio=new function(){return function(c){function a(a){var b=a.getTracks();each(b,function(b){x.addTrack(b,a)});p(a)}function b(){g(function(a){a.successful?v.dispatchEvent({type:"sendaccept",accept:a.answer}):l(a.error)})}function d(){f(function(a){a.successful?v.dispatchEvent({type:"sendoffer",offer:a.offer}):n(a.error)})}function f(a){x.createOffer(function(b){console.log("set offer a");
x.setLocalDescription(b,function(){a({successful:!0,offer:b})},function(b){h(a,b)})},function(b){h(a,b)})}function g(a){x.createAnswer(function(b){console.log("set answer a");x.setLocalDescription(b,function(){a({successful:!0,answer:b})},function(b){h(a,b)})},function(b){h(a,b)})}function k(){x&&x.close();x=new RTCPeerConnection(null);x.ontrack=u;x.onremovestream=q;x.oniceconnectionstatechange=r;x.onicecandidate=t;return x}function h(a,b){m(b);a({successful:!1,error:b})}function m(a){console.error(a.message?
a.message:a);console.error(Error().stack)}function l(a){v.dispatchEvent({type:"acceptfailed",error:a})}function n(a){v.dispatchEvent({type:"offerfailed",error:a})}function p(a){console.log("dispatching local stream");v.dispatchEvent({type:"localstream",stream:a})}function u(a){console.log(a.streams[0]);a=a.streams[0];console.log("dispatchAddRemoteStream");v.dispatchEvent({type:"addremotestream",stream:a})}function q(a){v.dispatchEvent({type:"removeremotestream",stream:a.stream})}function r(a){console.log("ICE state: ",
x.iceConnectionState);a=x.iceConnectionState;switch(a){case "failed":case "disconnected":case "closed":v.dispatchEvent({type:"ended",iceConnectionState:a})}}function t(a){console.log("onicecandidate");console.log(a);a=a.candidate;null!=a?v.dispatchEvent({type:"sendice",candidate:a}):v.dispatchEvent({type:"allicecandidatessent"})}function w(a){navigator.getUserMedia({audio:!1,video:!0},function(b){console.log("GOT USRE MEDIA");a({successful:!0,stream:b})},function(b){h(a,b)})}EventEnabledBuilder(this);
var v=this,x;this.createOffer=function(b){w(function(c){c.successful?(k(),a(c.stream),d()):(b&&b(c),n(c.error))})};this.incomingOffer=function(a){k();console.log("setting remote description b");console.log("set offer b");x.setRemoteDescription(a,function(){},function(a){m(a)})};this.acceptedOffer=function(c){console.log("ClientClientVideoAudio.acceptedOffer");w(function(c){c.successful?(a(c.stream),b()):l(c.error)})};this.incomingIceCandidate=function(a){console.log("incoming ice candidate");x&&x.addIceCandidate(a,
function(){v.dispatchEvent({type:"addedicecandidate",candidate:a})},m)};this.incomingAccept=function(a){console.log(a);console.log("setting remote description a");console.log("set answer b");x.setRemoteDescription(a,function(){console.log("set")},function(){console.error(m)})}}},VideoFeedUI=function(){return function(c){function a(){c.acceptedOffer(k.offer)}function b(){f(VideoOfferRejectedReasons.DECLINED)}function d(a){g.dispatchEvent({type:"showmessagetouser",message:a})}function f(a){console.log(a);
g.dispatchEvent({type:"offerrejected",reason:a})}EventEnabledBuilder(this);var g=this,k,h,m=E.DIV(),l=E.DIV(),n=E.VIDEO();m.classList.add("video-feed");l.classList.add("me");var p=E.VIDEO();p.classList.add("video-them");n.classList.add("video-me");m.appendChild(p);m.appendChild(l);l.appendChild(n);c.addEventListener("gotoffer",function(c){k=c.wrappedOffer;console.log(c.offer);h&&h.dispose();h=Dialog.show({message:k.userFrom.getUsername()+" want's to video chat!",buttons:[{text:"Accept",callback:a},
{text:"decline",callback:b}]})});c.addEventListener("setlocalstream",function(a){console.log("setting stream");var b=a.stream;console.log(a);console.log(a.stream);n.srcObject=b;n.play();g.dispatchEvent({type:"show"})});c.addEventListener("setremotestream",function(a){a=a.stream;console.log(a);console.log(Error().stack);console.log("setting videoThem and calling play");p.srcObject=a;p.play()});c.addEventListener("stopped",function(a){g.dispatchEvent({type:"hide"})});c.addEventListener("offerfailed",
function(a){a=a.error?a.error.message:void 0;d(a?"Offer failed with reason: "+a:"Offer failed")});c.addEventListener("acceptfailed",function(a){a=a.error?a.error.message:void 0;d(a?"Accept failed with reason: "+a:"Accept failed");console.log(a);f(VideoOfferRejectedReasons.ERROR)});this.getElement=function(){return m}}}(),VideoFeed=function(){return function(c){function a(a){f.dispatchEvent({type:"setremotestream",stream:a})}function b(a){f.dispatchEvent({type:"generalfailure",error:a.error})}function d(){n&&
n.getTracks().forEach(function(a){a.stop()});n=null}EventEnabledBuilder(this);var f=this,g=c.getOfferTemplate,k=c.getAcceptTemplate,h=c.getIceCandidateTemplate,m=c.send,l=new ClientClientVideoAudio({}),n;this.start=function(){d();l.createOffer(function(a){})};this.acceptedOffer=l.acceptedOffer;this.incomingOffer=function(a){l.incomingOffer(a.offer);f.dispatchEvent({type:"gotoffer",wrappedOffer:a,offer:a.offer})};this.incomingAccept=l.incomingAccept;this.incomingIceCandidate=l.incomingIceCandidate;
this.stop=function(){d();f.dispatchEvent({type:"stopped"})};l.addEventListener("acceptfailed",function(a){console.log(Error().stack);console.log(a);b(a);f.dispatchEvent({type:"acceptfailed",error:a.error})});l.addEventListener("offerfailed",function(a){b(a);f.dispatchEvent({type:"offerfailed",error:a.error})});l.addEventListener("sendice",function(a){a=a.candidate;var b=h();b.candidate=a;console.log(b);m(b)});l.addEventListener("allicesent",function(){});l.addEventListener("localstream",function(a){f.dispatchEvent({type:"setlocalstream",
stream:a.stream})});l.addEventListener("addremotestream",function(b){console.log("onAddRemoteStream");d();n=b.stream;a(n)});l.addEventListener("remoteremotestream",function(b){d();a()});l.addEventListener("sendoffer",function(a){a=a.offer;var b=g();b.offer=a;console.log(b);m(b)});l.addEventListener("sendaccept",function(a){a=a.accept;var b=k();b.accept=a;console.log(b);m(b)});l.addEventListener("ended",function(a){f.dispatchEvent({type:"stopped"})})}}(),VideoFeedPm=function(){return function(c){var a=
c.userTo,b=c.getSessionId;c=new VideoFeed({getOfferTemplate:function(){return{type:"pm_video_offer",userToId:a.getId(),sessionId:b()}},getAcceptTemplate:function(){return{type:"pm_video_accept",userToId:a.getId(),sessionId:b()}},getIceCandidateTemplate:function(){return{type:"pm_video_ice_candidate",userToId:a.getId(),sessionId:b()}},send:c.send});this.acceptedOffer=c.acceptedOffer;this.incomingAccept=c.incomingAccept;this.iceCandidate=c.iceCandidate;return c}}(),Button=function(){return function(c){function a(){m?
(l.classList.remove(k),m=!1):(l.classList.add(k),m=!0)}EventEnabledBuilder(this);var b=this,d=c.preventPropagation,f=c.className,g=c.classNames,k=c.classNameToggled,h=c.toggle,m=c.toggled?!0:!1;c=c.text;var l=E.BUTTON();c&&(l.innerHTML=c);f&&l.classList.add(f);g&&each(g,function(a){l.classList.add(a)});h&&a();l.addEventListener("click",function(c){d&&(c=c||window.event,c.stopPropagation());b.dispatchEvent({type:"click"});h&&k&&(a(),b.dispatchEvent({type:"toggled",toggled:m}))});this.getElement=function(){return l}}}(),
VideoButton=function(){return function(c){EventEnabledBuilder(this);var a=this,b=new Button(c),d=!1;this.setOn=function(a){d!=a&&(a?b.getElement().classList.add("on"):b.getElement().classList.remove("on"),d=a)};this.getElement=b.getElement;b.addEventListener("click",function(){a.dispatchEvent({type:"click"})})}}(),ClickMenu=new function(){function c(a){var b=a.element;b.classList.add("click-menu");this.removeOptionEntry=function(a){b.removeChild(a.getElement())};this.addOptionEntry=function(a){b.appendChild(a.getElement())}}
var a=function(){function a(a){var b=E.DIV();b.classList.add("option-entry");b.innerHTML=a.text;this.getElement=function(){return b}}return function(b){EventEnabledBuilder(this);var c=this,d=new a({text:b.text,tooltip:b.tooltip});this.getElement=d.getElement;d.getElement().addEventListener("click",function(){b.callback();c.dispatchEvent({type:"hide"})})}}();return function(b){function d(b){each(b,function(b){b=new a(b);m.addOptionEntry(b);b.addEventListener("hide",g);k.push(b)})}function f(){each(k,
function(a){m.removeOptionEntry(a)});k=[]}function g(a){h.hide()}EventEnabledBuilder(this);b.options&&d(b.options);console.log(Error().stack);var k=[],h=new Popup;b=h.getElement();document.body.appendChild(b);var m=new c({element:b});this.show=function(a){a.options&&(f(),d(a.options));h.show()};this.setPosition=h.setPosition}},SeenNotificationsManager=new function(){return function(c){var a=c.getSessionId,b=c.mysocket,d=new TemporalCallback({delay:4E3,callback:function(){console.log("sending seen notifications");
var c=[],d;for(d in f)c.push(f[d]);b.send({type:"seen_notifications",seens:c,sessionId:a()});f={}},maxNTriggers:5,maxTotalDelay:15E3}),f={};this.seen=function(a){a=a.getId();f[a]||(f[a]={userToId:a,seenAt:(new Date).toISOString()});d.trigger()}}},Notification=function(){var c=function(a){console.log(a);EventEnabledBuilder(this);var b=this;this.getNotificationType=function(){return a.notificationType};this.getIsPm=function(){return"pm"==b.getNotificationType()};this.getUsername=function(){return a.username};
this.getImage=function(){return a.image};this.getId=function(){return a.id};this.seen=function(){b.dispatchEvent({type:"seen",notification:b})}};c.PM="pm";c.pmNotificationFromJSON=function(a){return new c({notificationType:"pm",username:a.username,id:a.userId})};return c}(),NotificationsButton=function(){function c(a){a=a.button.getElement();var b=E.DIV(),c=E.DIV();b.appendChild(c);b.classList.add("count");c.classList.add("text");a.appendChild(b);this.setCount=function(a){c.innerHTML=9<a?"!":String(a)}}
return function(a){function b(){g.setCount(f.getCount())}var d=new Button({classNames:["button-notifications"]}),f=a.notifications,g=new c({button:d});f.addEventListener("added",b);f.addEventListener("removed",b);b();return d}}(),Notifications=function(){return function(){function c(a){b.dispatchEvent({type:"removed",notification:a})}EventEnabledBuilder(this);var a=new Set({getEntryId:function(a){return a.getId()}}),b=this;this.add=function(c){a.add(c)&&b.dispatchEvent({type:"added",notification:c})};
this.remove=function(b){a.remove(b)&&c(b)};this.removeById=function(b){if(b=a.getById(b))a.remove(b),c(b)};this.clear=function(){var c=a.getEntries().slice();each(c,b.remove)};this.getById=a.getById;this.getCount=a.count}}(),NotificationEntry=function(){function c(a){EventEnabledBuilder(this);var b=this,c=a.userImage,f=a.buttonClose,g=a.userId;a=a.text;var k=E.DIV();k.classList.add("notification-entry");var h=E.DIV();h.classList.add("inner");k.appendChild(h);var m=new OnlineIndicatorUI(OnlineIndicators.get(g));
g=E.DIV();g.classList.add("username");h.appendChild(c.getElement());h.appendChild(g);h.appendChild(f.getElement());h.appendChild(m.getElement());g.innerHTML=a;this.getElement=function(){return k};this.parentWidth=function(a){k.style.width=200>a?"100%":400>=a?"50%":600>=a?"33.3%":"25%"};this.dispose=function(){c.dispose();m.dispose()};h.addEventListener("click",function(){b.dispatchEvent({type:"click"})})}return function(a){function b(){d.dispatchEvent({type:"dispose",notification:a,notificationEntry:d})}
EventEnabledBuilder(this);var d=this,f=a.getIsPm(),g=new Button({className:"button-close",preventPropagation:!0}),k=new UserImage({userId:a.getId(),username:a.getUsername()});k=new c({userImage:k,buttonClose:g,text:"PM from "+a.getUsername(),isPm:f,userId:f?a.getId():void 0});this.getElement=k.getElement;this.getId=a.getId;this.parentWidth=k.parentWidth;f&&(k.addEventListener("click",function(){d.dispatchEvent({type:"showpm",user:User.fromPmNotification(a),isNotification:!0});a.seen();b()}),g.addEventListener("click",
b),this.dispose=k.dispose)}}(),NotificationsMenu=function(){function c(a){function b(){var a=h.clientWidth;each(k(),function(b){console.log(b);b.parentWidth(a)})}var c=a.popup,f=a.buttonClose,g=c.getElement(),k=a.getEntries;g.classList.add("notifications-menu");var h=E.DIV();a=E.DIV();var m=new Heading({title:"&nbsp;PM Notifications"}),l=E.DIV(),n=E.DIV();n.classList.add("notifications-menu-inner");h.classList.add("entries");a.classList.add("entries-wrapper");l.classList.add("heading-wrapper");m.getEntries().appendChild(f.getElement());
l.appendChild(m.getElement());n.appendChild(l);n.appendChild(a);a.appendChild(h);g.appendChild(n);this.show=function(){c.show();b()};this.hide=c.hide;this.addEntry=function(a){h.appendChild(a.getElement())};this.removeEntry=function(a){h.removeChild(a.getElement())};this.getElement=function(){return g};this.getEntries=function(){return h};ResizeManager.add({element:g,onResized:b,staggered:!0}).manual(!0)}return function(a){function b(a){g.dispatchEvent(a);l&&l.hide()}function d(a){m.seen(a.notification)}
function f(a){a.notificationEntry.dispose();k.remove(a.notification)}EventEnabledBuilder(this);var g=this,k=a.notifications,h=a.pms,m=a.seenNotificationsManager,l=new Popup({});a=new Button({className:"button-close"});var n=new c({popup:l,buttonClose:a,getEntries:function(){return p.getEntries()}}),p=new SortedFilteredEntries({compare:function(a,b){},getEntryId:function(a){return a.getId()},element:n.getEntries()});this.show=n.show;this.hide=n.hide;this.getElement=n.getElement;a.addEventListener("click",
l.hide);k.addEventListener("added",function(a){a=a.notification;a.addEventListener("seen",d);a=new NotificationEntry(a);a.addEventListener("showpm",b);a.addEventListener("dispose",f);p.addEntry(a)});k.addEventListener("removed",function(a){console.log(a);p.removeEntryById(a.notification.getId())});h.addEventListener("showingpm",function(a){a=a.user.getId();if(a=k.getById(a))k.remove(a),m.seen(a)})}}(),MissingUsersManager=new function(){return function(){this.get=function(c){};this.getRange=function(c){}}},
Set=function(){return function(c){var a=this,b=c.getEntryId,d=[],f={};this.add=function(c){if(a.contains(c))return!1;d.push(c);f[b(c)]=c;return!0};this.remove=function(c){if(a.contains(c))return d.splice(d.indexOf(c),1),delete f[b(c)],c};this.removeById=function(b){var c=a.getById(b);if(c)return d.splice(d.indexOf(c),1),delete f[b],c};this.count=function(){return d.length};this.contains=function(a){return f[b(a)]?!0:!1};this.getByIndex=function(a){return d[a]};this.getById=function(a){return f[a]};
this.containsId=function(a){return f[a]?!0:!1};this.getIds=function(){return Object.keys(f)};this.getEntries=function(){return d};this.each=function(a){each(d,a)}}}();function ReferenceCounter(c){var a=[];this.add=function(b){0<=a.indexOf(b)||a.push(b)};this.remove=function(b){b=a.indexOf(b);0>b||(a.splice(b,1),1>a.length&&c())}}
var User=function(){function c(a){EventEnabledBuilder(this);new ReferenceCounter;var b=this;this.getId=function(){return a.id};this.setId=function(b){a.id=b};this.getUsername=function(){return String(a.username)};this.getEmail=function(){return a.email};this.isGuest=function(){return a.isGuest};this.getGender=function(){return a.gender};this.getBirthday=function(){return a.birthday};this.getImage=function(){return a.image};this.setImage=function(b){a.image=b};this.toJSON=function(){return a};this.left=
function(){b.dispatchEvent({type:"left",user:b})}}var a=new Set({getEntryId:function(a){return a.getId()}});return{fromJSON:function(b){var d=a.getById(b.id);if(d)return d;d=new c(b);a.add(d);return d},fromMessage:function(b){var d=a.getById(b.getUserId());if(d)return d;d=new c({id:b.getUserId(),username:b.getUsername(),image:b.getImage()});a.add(d);return d},fromPmNotification:function(b){var d=a.getById(b.getId());if(d)return d;d=new c({id:b.getId(),username:b.getUsername(),image:b.getImage()});
a.add(d);return d},TYPE:"user"}}(),Users=function(){return function(c){function a(a){if(!f.remove(a))return!1;console.log("dispatchingt remove");d.dispatchEvent({type:"remove",user:a})}function b(b){a(b.user)}EventEnabledBuilder(this);var d=this,f=new Set({getEntryId:function(a){return a.getId()}});this.add=function(a){f.add(a)&&(a.addEventListener("left",b),d.dispatchEvent({type:"add",user:a}))};this.contains=f.contains;this.containsId=f.containsId;this.getById=f.getById;this.remove=function(c){c.removeEventListener("left",
b);a(c)};this.clear=function(){var a=f.getEntries().slice();each(a,d.remove)};this.getIds=f.getIds;this.getEntries=f.getEntries}}(),SortedFilteredEntries=new function(){return function(c){function a(c,d,f){var g=d-c;if(5>g){a:{for(;c<=d;c++)if(!b(f,k[c])){d=c;break a}d+=1}return d}g=Math.floor(g/2)+c;return b(f,k[g])?a(g+1,d,f):a(c,g,f)}var b=c.compare,d=c.element,f=c.getEntryId,g=this,k=[],h={};this.containsEntryId=function(a){return h[a]?!0:!1};this.getByEntryId=function(a){return h[a]};this.getEntries=
function(){return k};this.addEntry=function(b){var c=f(b);if(!h[c])if(h[f(b)]=b,1>k.length)k.push(b),d.appendChild(b.getElement());else{c=k.length-1;var g=a(0,c,b);g<=c?(d.insertBefore(b.getElement(),k[g].getElement()),k.splice(g,0,b)):(k.push(b),d.appendChild(b.getElement()))}};this.removeEntry=function(a){var b=k.indexOf(a);0>b||(k.splice(b,1),d.removeChild(a.getElement()),delete h[f(a)])};this.removeEntryById=function(a){(a=g.getByEntryId(a))&&g.removeEntry(a)};this.clear=function(){for(;0<k.length;){var a=
k.splice(0,1)[0];d.removeChild(a.getElement())}h={}}}},OverlappingEntries=new function(){return function(c){function a(a){h.show(a.entry)}function b(a){h.hide(a.entry)}function d(a){m.remove(a);m.add(a);a.bringElementToFront()}function f(a){if(a=g(a))return a.setVisible(!0),a}function g(){return m.getEntries().slice().reverse().where(function(a){return a.getIsSetShow()}).firstOrDefault()}function k(a){var b=!1;a.getVisible()&&(b=!0);this.getId=function(){return a.getId()};this.getIsSetShow=function(){return b};
this.setIsSetShow=function(a){b=a};this.setVisible=function(b){a.setVisible(b)};this.bringElementToFront=function(){var b=a.getElement(),c=b.parentNode;c.removeChild(b);c.appendChild(b)};this.removeElement=function(){var b=a.getElement();b.parentNode.removeChild(b)};this.getString=function(){return(a.getName?a.getName():"")+b};this.getEntry=function(){return a}}var h=this,m=new Set({getEntryId:function(a){return a.getId()}}),l=c.element;this.show=function(a){var b=m.getById(a.getId());b&&(b.setIsSetShow(!0),
m.each(function(a){return a.setVisible(a==b)}),d(b))};this.hide=function(a){a=m.getById(a.getId());a.setVisible(!1);a.setIsSetShow(!1);(a=f(a))&&d(a)};this.add=function(c){if(!m.containsId(c.getId())){c.addEventListener("show",a);c.addEventListener("show",b);var d=new k(c);m.add(d);l.appendChild(c.getElement())}};this.remove=function(a){if(a=m.getById(a.getId()))m.remove(a),a.removeElement(),f(a)};this.getTopEntry=function(){return m.getByIndex(m.count()-1)}}},ConnectedImage=function(){function c(a,
c){if(a=b[a])return a[c]}function a(a,c,d){var f=b[a];f?(a=f[c])?0>a.indexOf(d)&&a.push(d):f[c]=[d]:b[a]={id:[d]}}var b={},d=function(d){console.log(d);var f=d.id,k=d.type,h={connectedImage:this,set:function(a){n.src=a}},m=d.def;d=d.url;var l=E.DIV();l.classList.add("connected-image");var n=E.IMG();l.appendChild(n);var p=0;n.onerror=function(a){2>p++&&(n.src=m)};n.src=d?d:m;this.getElement=function(){return l};this.dispose=function(){var a=c(k,f);if(a){var d=a.indexOf(h);0>d||(a.splice(d,1),0<a.length||
(delete b[k][f],2>Object.keys(b[k]).length&&delete b[k]))}};a(k,f,h)};d.update=function(a,b,d){(a=c(a,b))&&each(a,function(a){a.set(d)})};return d}(),RoomImage=new function(){return function(c){return new ConnectedImage({def:"/images/room-default.gif",type:"room-image",id:c})}};
function PmsOpenHistory(c){function a(){var a=[];each(g.getEntries(),function(b){a.push(b.toJSON())});f.set("listUsers",a)}var b="PmsOpenHistory_"+d,d=c.userMeId,f=new Settings(b),g=new Set({getEntryId:function(a){return a.getId()}});new TabPortal({id:b});this.add=function(b){g.add(b);a()};this.remove=function(b){g.remove(b);a()};this.getUsers=g.getEntries;(function(){var a=f.get("listUsers");a?each(a,function(a){a=User.fromJSON(a);g.add(a)}):a=[]})()}
var Pms=function(){return function(c){function a(a){var b=g(a.getId());l.showRoom({id:b,name:"PM with "+a.getUsername(),isPm:!0,userTo:a});m.dispatchEvent({type:"showingpm",user:a})}function b(a){q.remove(a);a=g(a.getId());(a=l.getById(a))&&a.close()}function d(c){var d=c.message;console.log(c);switch(d.type){case "add":a(User.fromJSON(d.userTo));break;case "remove":b(User.fromJSON(d.userTo))}}function f(a){r&&r.sendMessage({type:"remove",userTo:a.toJSON()})}function g(a){return"pm_"+String(a)}function k(a){m.dispatchEvent({type:"addnotification",
notification:a})}function h(a){m.dispatchEvent({type:"addclosed",userTo:a})}EventEnabledBuilder(this);var m=this,l=c.rooms,n=c.getUserMe,p=c.getUserById,u=c.getOpenRoom,q,r;this.showPmWithUser=function(b){a(b);r&&r.sendMessage({type:"add",userTo:b.toJSON()});OnlineIndicators.setHasPm(b.getId(),!1)};this.closePmWithUser=function(a){b(a);f(a)};this.incomingMessage=function(a){var b=g(a.userId);b=l.getById(b);console.log(a);var c=a.message.userId!=n().getId(),d=!b||b!=u();c&&d&&(OnlineIndicators.setHasPm(a.userId,
!0),Notifier.show("Pm from "+a.message.username));b?b.incomingMessage(a.message):k(Notification.pmNotificationFromJSON(a.message))};this.incomingMessages=function(a){var b=l.getById(g(a.userId));b?b.incomingMessages(a.messages):k(Notification.pmNotificationFromJSON(a.message))};this.videoOfferFail=function(a){var b=l.getById(g(a.userToId));b&&b.videoOfferFail(a)};this.videoOffer=function(a){console.log(a);var b=l.getById(g(a.userFromId));b?(a.userFrom=p(a.userFromId),b.videoOffer(a)):m.dispatchEvent({type:"videoofferrejected",
userToId:a.userFromId,reason:VideoOfferRejectedReasons.PM_NOT_OPEN})};this.videoAcceptFail=function(a){var b=l.getById(g(a.userToId));b&&b.videoAcceptFail(a)};this.videoAccept=function(a){var b=l.getById(g(a.userFromId));b&&b.videoAccept(a.accept)};this.videoIceCandidate=function(a){console.log("video ice candidate");console.log(a);var b=l.getById(g(a.userFromId));console.log("roomId is: ");console.log(g(a.userFromId));console.log(b);b&&(console.log("video ice candidate b"),b.videoIceCandidate(a.candidate))};
this.load=function(a){q=new PmsOpenHistory({userMeId:a});r=new TabPortal({id:"PmsMenu_"+a});r.addEventListener("message",d);a=q.getUsers();each(a,h)};this.videoOfferRejected=function(a){var b=l.getById(g(a.userFromId));b&&b.videoOfferRejected(a)};l.addEventListener("showpm",function(a){console.log("called");m.showPmWithUser(a.user)});l.addEventListener("sendpm",function(a){return m.dispatchEvent(a)});l.addEventListener("getpms",function(a){return m.dispatchEvent(a)});l.addEventListener("createdroom",
function(a){a=a.room;a.isPm()&&(a=a.getUserTo())&&(m.dispatchEvent({type:"add",userTo:a}),q.add(a))});l.addEventListener("destroyedroom",function(a){a=a.room;a.isPm()&&(a=a.getUserTo())&&(m.dispatchEvent({type:"remove",userTo:a}),q.remove(a),f(a))})}}(),PmEntry=new function(){function c(a){EventEnabledBuilder(this);var b=this,c=a.userImage,f=a.buttonClose,g=new OnlineIndicatorUI(OnlineIndicators.get(a.userId)),k=E.DIV();k.classList.add("pm-entry");var h=E.DIV();h.classList.add("inner");k.appendChild(h);
var m=E.DIV();m.classList.add("username");h.appendChild(c.getElement());h.appendChild(m);h.appendChild(f.getElement());h.appendChild(g.getElement());m.innerHTML=a.name;k.title="Open PM with "+a.name;this.getElement=function(){return k};this.dispose=function(){c.dispose();g.dispose()};this.parentWidth=function(a){k.style.width=200>a?"100%":400>=a?"50%":600>=a?"33.3%":"25%"};h.addEventListener("click",function(){b.dispatchEvent({type:"click"})})}return function(a){console.log(a);console.log(Error().stack);
EventEnabledBuilder(this);var b=this,d=a.userTo;a=new Button({className:"button-close",preventPropagation:!0});var f=new UserImage({userId:d.getId(),username:d.getUsername(),image:d.getImage()});f=new c({userImage:f,name:d.getUsername(),buttonClose:a,userId:d.getId()});this.getId=function(){return d.getId()};this.getUsername=function(){return d.getUsername()};this.getElement=f.getElement;this.setVisible=f.setVisible;this.parentWidth=f.parentWidth;this.dispose=f.dispose;f.addEventListener("click",
function(){b.dispatchEvent({type:"showpm",user:d})});a.addEventListener("click",function(){b.dispatchEvent({type:"closepm",user:d,pmEntry:b})})}},PmsMenu=new function(){function c(a){function b(){var a=m.clientWidth;each(h(),function(b){b.parentWidth(a)});k()}var c=a.popup,f=window.isMobile?c.getElement():E.DIV(),g=a.buttonClose,k=a.onResized,h=a.getEntries,m=E.DIV();a=E.DIV();var l=E.DIV();if(window.isMobile){document.body.appendChild(c.getElement());var n=new Heading({title:"&nbsp;Pms "}),p=E.DIV();
p.classList.add("heading-wrapper");n.getEntries().appendChild(g.getElement());p.appendChild(n.getElement());l.appendChild(p)}l.classList.add("pms-menu-inner");f.classList.add("pms-menu");a.classList.add("entries-wrapper");m.classList.add("entries");a.appendChild(m);l.appendChild(a);f.appendChild(l);this.getElement=function(){return f};this.setVisible=function(a){m.style.display=a?"block":"none"};this.getEntries=function(){return m};this.show=function(){c.show();b()};this.checkResized=function(){u.manual(!0)};
var u=ResizeManager.add({element:f,onResized:b,staggered:!0});u.manual(!0);this.resize=b}ImagePreloader.preloadRange(["/images/close.jpg","/images/close-hover.jpg"]);return function(a){function b(a){a=new PmEntry({userTo:a.userTo});a.parentWidth(l.getElement().clientWidth);a.addEventListener("showpm",f);a.addEventListener("closepm",g);p.addEntry(a);l.checkResized()}function d(a){a&&(p.removeEntry(a),l.checkResized(),a.dispose())}function f(a){n.showPmWithUser(a.user);h&&h.hide()}function g(a){p.removeEntry(a.pmEntry);
l.checkResized();n.closePmWithUser(a.user)}EventEnabledBuilder(this);var k=this,h=window.isMobile?new Popup({}):void 0,m=window.isMobile?new Button({className:"button-close"}):void 0,l=new c({popup:h,buttonClose:m,getEntries:function(){return p.getEntries()},onResized:function(){k.dispatchEvent({type:"resized"})}}),n=a.pms,p=new SortedFilteredEntries({getEntryId:function(a){return a.getId()},element:l.getEntries(),compare:function(a,b){return a.getUsername()>b.getUsername()}});this.getElement=l.getElement;
this.setVisible=l.setVisible;this.show=l.show;this.clear=function(){each(p.getEntries().slice(),d)};this.resize=l.resize;n.addEventListener("add",function(a){b(a)});n.addEventListener("remove",function(a){if(a=p.getByEntryId(a.userTo.getId()))a.dispose(),d(a)});n.addEventListener("addclosed",function(a){b(a)});m&&m.addEventListener("click",h.hide)}},RoomEntry=new function(){function c(a){function b(a){k.innerHTML="("+(a?a:0)+")"}var c=E.DIV();c.title=a.name;c.classList.add("room-entry");var f=E.DIV();
f.classList.add("inner");f.appendChild(a.roomImage.getElement());c.appendChild(f);var g=E.DIV();g.classList.add("name");g.innerHTML=a.name;f.appendChild(g);var k=E.DIV();k.classList.add("n-users");g.appendChild(k);b(a.nUsers);this.update=function(a){b(a.nUsers)};this.getElement=function(){return c};this.parentWidth=function(a){c.style.width=200>a?"100%":400>=a?"50%":600>=a?"33.3%":"25%"}}return function(a){EventEnabledBuilder(this);var b=this,d=new RoomImage,f=new c({name:a.name,roomImage:d,nUsers:a.nUsers});
this.getId=function(){return a.id};this.getName=function(){return a.name};this.getElement=f.getElement;this.parentWidth=f.parentWidth;f.getElement().addEventListener("click",function(){b.dispatchEvent({type:"selected",roomInfo:a})});this.dispose=d.dispose;this.update=f.update}},Room=new function(){function c(a){function b(a){p.setOn(!0);B.setVisible(!0)}function c(){p.setOn(!1);B.setVisible(!1)}function f(a){a=Message.error({message:a.message});u(a)}EventEnabledBuilder(this);var g=this,k=!1,h=a.buttonSend,
m=a.buttonExit,l=a.buttonEmoticons,n=a.buttonClose,p=a.buttonVideoPmStart,u=a.addMessage,q=a.videoFeed,r=a.videoPmOfferRejected;a=a.spinner;var t=E.DIV();t.classList.add("room");var w=E.DIV();w.classList.add("top");var v=E.DIV();v.classList.add("bottom");var x=E.DIV();x.classList.add("feed");var D=E.DIV();D.classList.add("menu");var G=E.TEXT();G.classList.add("text");if(q){q=new VideoFeedUI(q);var H=new SplitPane({nPanelsWidth:1,nPanelsHeight:2,rowProfiles:[{height:"200px"}]});var I=H.getPanelXY(0,
0).getElement();var B=H.getPanelRow(0);I.classList.add("video-feed-panel");I.appendChild(q.getElement());w.appendChild(H.getElement());H.getPanelXY(0,1).getElement().appendChild(x);c();(new Task(H.resize)).run();q.addEventListener("show",b);q.addEventListener("hide",c);q.addEventListener("showmessagetouser",f);q.addEventListener("offerrejected",r)}else w.appendChild(x);t.appendChild(w);t.appendChild(v);t.appendChild(a.getElement());v.appendChild(G);v.appendChild(D);D.appendChild(l.getElement());D.appendChild(h.getElement());
D.appendChild(m.getElement());D.appendChild(n.getElement());p&&D.appendChild(p.getElement());G.addEventListener("keypress",function(a){a||(a=window.events);g.dispatchEvent({type:"keypress",keyCode:a.keyCode||a.which})});this.getElement=function(){return t};this.getFeed=function(){return x};this.setVisible=function(a){k=a;t.style.display=a?"block":"none"};this.getVisible=function(){return k};this.getTextValue=function(){return G.value};this.addMessage=function(a){x.appendChild(a.getElement())};this.removeMessage=
function(a){x.removeChild(a.getElement())};this.insertIntoTextAtCurrentIndex=function(a){var b=G.selectionStart;if(a){if(void 0==b)G.value+=a;else{var c=b+a.length;G.value=G.value.splice(b,0,a);G.selectionStart=G.selectionEnd=c}G.focus()}};this.clearText=function(){G.value=""};this.scrollFeedToBottom=function(){x.scrollTop=x.scrollHeight};this.feedIsAtBottom=function(){return x.scrollTop>=x.scrollHeight-x.offsetHeight-10};this.resize=function(){console.log("Room.UI.resize");H&&H.resize()}}return function(a){function b(a){a.emoticonsParser=
r;a.clickMenuUser=H;a.ignoreManager=G;a.getUserMe=l;A.addReceived(Message.fromJSON(a))}function d(){D.start()}function f(){A.dispose();h.dispatchEvent({type:"dispose",room:h})}function g(){var a=K.getTextValue();if(""!=a){var b=l();a=Message.fromTypedString({str:a,userId:b.getId(),username:b.getUsername(),uniqueId:A.nextUniqueId(),emoticonsParser:r,pending:!0,clickMenuUser:H,getUserMe:l,image:b.getImage()});console.log(a);h.dispatchEvent(h.isPm()?{type:"sendpm",userToId:h.getUserTo().getId(),message:a}:
{type:"sendmessage",message:a,roomId:w});A.addSending(a);K.clearText();K.scrollFeedToBottom()}}function k(a){K.insertIntoTextAtCurrentIndex(a.getStringRepresentation())}console.log(a);EventEnabledBuilder(this);var h=this,m=a.send,l=a.getUserMe,n=a.getUserById,p=a.getNDevice,u=a.getSessionId,q=a.showUsersSearch,r=a.emoticonsParser,t=a.name,w=a.id,v=a.isPm,x=a.userTo;if(v){var D=new VideoFeedPm({userTo:x,getSessionId:u,send:m});this.videoOffer=D.incomingOffer;this.videoAccept=D.incomingAccept;this.videoIceCandidate=
D.incomingIceCandidate}var G=a.ignoreManager,H=a.clickMenuUser,I=new Users({getUserById:n}),B=new UsersMenu({name:a.isPm?"PM with "+a.userTo.getUsername():t+" Users",users:I,id:w,ignoreManager:G,clickMenu:H,getUserMe:l,showUsersSearch:q});m=new Button({className:"button-send",text:"Send"});n=new Button({className:"button-emoticons"});u=new Button({className:"button-exit"});q=new Button({className:"button-close"});t=v?new VideoButton({className:"button-video-pm-start"}):void 0;var C=new Spinner({});
C.show();var K=new c({buttonSend:m,buttonEmoticons:n,buttonExit:u,buttonClose:q,buttonVideoPmStart:t,spinner:C,videoFeed:D,addMessage:function(a){var b=K.feedIsAtBottom();A.add(a);b&&K.scrollFeedToBottom()},videoPmOfferRejected:function(a){console.log(a);h.dispatchEvent({type:"videopmofferrejected",userToId:x.getId(),reason:a.reason})}}),A=new Messages({getUserId:function(){var a=l();if(a)return a.getId()},element:K.getFeed(),maxNMessages:100,ignoreManager:G,getNDevice:p});I.addEventListener("missingusers",
h.dispatchEvent);this.getId=function(){return a.id};this.getName=function(){return a.name};this.getUsersMenu=function(){return B};this.getUserTo=function(){return a.userTo};this.isPm=function(){return v};this.incomingMessage=function(a){var c=K.feedIsAtBottom();b(a);c&&K.scrollFeedToBottom()};this.incomingMessages=function(a){var c=K.feedIsAtBottom();each(a,function(a){b(a)});c&&K.scrollFeedToBottom();C.hide()};A.addEventListener("showpm",function(a){h.dispatchEvent(a)});this.join=function(a){I.contains(a)||
I.add(a)};this.leave=function(a){I.contains(a)&&I.remove(a)};this.close=f;this.getUsers=function(){return I};this.getElement=K.getElement;this.setVisible=function(a){var b=K.getVisible();!b&&a?B.show():b&&!a&&B.hide();K.setVisible(a);a&&(new Task(function(){K.resize();K.scrollFeedToBottom()})).run()};this.getVisible=K.getVisible;this.videoOfferFail=function(a){D.stop();Dialog.show({message:"Starting video chat with "+x.getUsername()+" failed as they are offline!",buttons:[{text:"OK"}]})};this.videoOfferRejected=
function(a){D.stop();Dialog.show({message:a.reason,buttons:[{text:"OK"}]})};this.resize=K.resize;m.addEventListener("click",g);n.addEventListener("click",function(){h.dispatchEvent({type:"showemoticons",picked:k})});q.addEventListener("click",f);u.addEventListener("click",function(){h.dispatchEvent({type:"hide",room:h})});t&&t.addEventListener("click",d);K.addEventListener("keypress",function(a){if("13"==a.keyCode)return g(),!1});(new Task(function(){h.dispatchEvent(h.isPm()?{type:"getpms",userToId:h.getUserTo().getId()}:
{type:"getmessages",roomId:w});h.dispatchEvent({type:"getuserids",roomId:w});h.isPm()&&(I.add(a.userTo),I.add(l()))})).run()}};window.RoomCreation=function(c){window.EventEnabledBuilder(this);var a=this,b=c.sendMessage,d=c.getSessionId;this.create=function(a){b({type:"create_room",name:a.name,sessionId:d()})};this.incomingCreateRoom=function(b){console.log(b);b.successful?a.dispatchEvent({type:"created",roomInfo:b.room}):a.dispatchEvent({type:"failed",message:b.message})}};
function RoomCreationMenuUI(c){EventEnabledBuilder(this);var a=new window.StandardMenu({title:"Create Room",classNames:["room-creation-menu"]}),b=new window.Spinner({preventInterraction:!0}),d=a.getElement(),f=window.E,g=f.TEXT(),k=f.DIV();f=new window.Button({className:"button-create",text:"Create"});g.placeholder="Name";g.classList.add("name");k.classList.add("error");var h=a.getEntries();h.appendChild(g);h.appendChild(f.getElement());h.appendChild(k);d.appendChild(b.getElement());this.show=a.show;
this.hide=a.hide;f.addEventListener("click",function(a){c.create({name:g.value})});c.addEventListener("created",function(b){a.hide()});c.addEventListener("failed",function(a){a=a.message;k.style.display=a?"block":"none";k.innerHTML=a})}
var MessageComponents=new function(){this.Text=function(c){this.getString=function(){return c};this.getElement=function(){return document.createTextNode(c)};this.TYPE="text"};this.Text.TYPE="text";this.Emoticon=function(c){this.getElement=function(){if(c.isCharacter())return document.createTextNode(c.getStringRepresentation());var a=E.IMG();a.classList.add("emoticon");a.src=c.getImageSource();return a};this.TYPE="emoticon"};this.Emoticon.TYPE="emoticon"};
function MessageUI(c){function a(a){a=moment.utc(a).local();var b=moment();moment.duration(b.diff(a));var c=moment().startOf("day");b=a.format("HH:mm:ss");if(0<=a.diff(c,"seconds"))return b;c=c.diff(a,"seconds");if(604800>c)return a=a.format("dddd")+" at "+b,518400>c?a:"last "+a;b=a.isSame(new Date,"year");c=a.format("Do")+" "+a.format("MMMM");return b?c:c+" "+a.year()}EventEnabledBuilder(this);var b=this,d=c.components,f=c.username,g=c.userImage,k=c.sentAt,h=c.messageType,m=E.DIV();m.classList.add("message");
var l=E.DIV();l.classList.add("inner");var n=E.DIV();n.classList.add("username-and-timestamp");var p=E.DIV();p.classList.add("username");if(c.pending){var u=E.DIV();u.classList.add("pending");m.appendChild(u)}n.appendChild(p);c=E.DIV();c.classList.add("timestamp");n.appendChild(c);switch(h){case Message.ERROR:m.classList.add("error");c.innerHTML=" ("+a(new Date)+")";break;default:l.appendChild(g.getElement()),p.innerHTML+=f&&0<f.length?f:"&nbsp;",k&&(c.innerHTML=" ("+a(k)+")")}l.appendChild(n);each(d,
function(a){l.appendChild(a.getElement())});m.appendChild(l);this.getElement=function(){return m};this.getUsername=function(){return n};this.setVisible=function(a){m.style.display=a?"inline-block":"none"};this.hidePending=function(){u&&m.removeChild(u)};p.addEventListener("click",function(a){b.dispatchEvent({type:"showusermenu",left:a.clientX,top:a.clientY})})}
var Message=function(){function c(a,c){c||(c="");var b=a.emoticonsParser,d=[],k=new MessageComponents.Text(c);b?b.pipe(k,function(a){d.push(a)}):d=[k];return new Message({userId:a.userId,username:a.username,uniqueId:a.uniqueId,components:d,content:c,serverAssignedNMessage:a.serverAssignedNMessage,pending:a.pending,clickMenuUser:a.clickMenuUser,ignoreManager:a.ignoreManager,getUserMe:a.getUserMe,image:a.image,sentAt:a.sentAt,messageType:a.messageType})}var a=function(a){function b(){D||(D=new MessageUI({userImage:r,
components:p,username:n,pending:a.pending,sentAt:m.getSentAtUTC(),messageType:v}),D.addEventListener("showusermenu",c));return D}function c(a){l!=w().getId()&&(q.setPosition(a),q.show({options:[{text:"Pm "+n,callback:g},{text:(x?"Unignore ":"Ignore ")+n,callback:x?h:k}]}))}function g(){m.dispatchEvent({type:"showpm",user:User.fromMessage(m)})}function k(){t.ignoreUserByIdAndUsername({id:l,username:n})}function h(){t.unignoreUserById(l)}EventEnabledBuilder(this);var m=this,l=a.userId,n=a.username,
p=a.components,u=a.content,q=a.clickMenuUser,r=new UserImage({userId:l,image:a.image}),t=a.ignoreManager,w=a.getUserMe,v=a.messageType?a.messageType:"user",x=!1,D;this.getElement=function(){return b().getElement()};this.getUniqueId=function(){return a.uniqueId};this.getImage=function(){return a.image};this.getUserId=function(){return a.userId};this.getUsername=function(){return a.username};this.getSentAtUTC=function(){return a.sentAt?moment(a.sentAt):void 0};this.getServerAssignedNMessage=function(){return a.serverAssignedNMessage};
this.getMessageType=function(){return v};this.confirm=function(c){a.serverAssignedNMessage=c.getServerAssignedNMessage();b().hidePending()};this.toJSON=function(){return{content:u,userId:l,uniqueId:a.uniqueId}};this.dispose=function(){r.dispose()};this.setIgnored=function(a){x=a;b().setVisible(!x)};this.getIgnored=function(){return x}};a.ERROR="error";a.USER="user";a.fromJSON=function(a){return c(a,a.content)};a.fromTypedString=function(a){a.sentAt=moment().format();return c(a,a.str)};a.error=function(a){a.messageType=
"error";return c(a,a.message)};return a}(),Messages=new function(){var c=0;return function(a){function b(a){a.addEventListener("showpm",f);p.push(a);u[a.getUniqueId()]=a;n.appendChild(a.getElement())}function d(a){var b=p.indexOf(a);0>b||(p.splice(b,1),delete u[a.getUniqueId()],n.removeChild(a.getElement()),a.removeEventListener("showpm",f))}function f(a){h.dispatchEvent(a)}function g(a){p.where(function(b){return b.getUserId()==a.userId}).each(function(a){return a.setIgnored(!0)})}function k(a){p.where(function(b){return b.getUserId()==
a.userId}).each(function(a){return a.setIgnored(!1)})}EventEnabledBuilder(this);var h=this,m=a.getNDevice,l=a.ignoreManager,n=a.element,p=[],u={},q=new OverflowManager({getMessages:function(){return p},remove:d,maxNMessages:a.maxNMessages});this.addSending=function(a){b(a);q.trigger()};this.addReceived=function(a){var b=u[a.getUniqueId()];if(b)b.confirm(a);else a:if(u[a.getUniqueId()]=a,a.addEventListener("showpm",f),1>p.length)p.push(a),n.appendChild(a.getElement());else{var c=a.getServerAssignedNMessage();
for(b=new ReverseIterator(p);b.hasNext();)if(b.next().getServerAssignedNMessage()<c){if(b.hasPrevious()&&(c=b.previous().getElement().nextSibling)){n.insertBefore(a.getElement(),c);b.insertAfter(a);break a}n.appendChild(a.getElement());b.append(a);break a}n.insertBefore(a.getElement(),p[0].getElement());b.insert(a)}l.userIdIsIgnored(a.getUserId())&&a.setIgnored(!0);q.trigger()};this.add=function(a){u[a.getUniqueId()]=a;b(a)};this.remove=function(a){d(a)};this.nextUniqueId=function(){return m()+"_"+
c++};this.dispose=function(){each(p,function(a){a.dispose()});l.removeEventListener("ignored",g);l.removeEventListener("unignored",k)};l.addEventListener("ignored",g);l.addEventListener("unignored",k)}},EmoticonsLibrary={defaultFolder:"/emoji/",folders:{folderName:"/path"},emoticons:[{strings:[":)","/smile",":smile:"],file:"smile.png"},{strings:[":p",":P","/tongue",":tongue:"],file:"stuck_out_tongue.png"},{strings:[":D",":d","/grin",":grin:"],file:"grinning.png"},{strings:["/kiss",":kiss:",":*",":-*"],
file:"kissing_heart.png"},{strings:[":cry:",":'",":,("],file:"cry.png"},{strings:["/shocked",":shocked:","anguished,",":O",":O"],file:"anguished.png"},{strings:["/blush",":blush:"],file:"blush.png"},{strings:"/speachless /shocked :speachless: :shocked: :O :o".split(" "),file:"open_mouth.png"},{strings:["/laugh",":laugh:"],file:"laughing.png"},{strings:["/angry",":angry:"],file:"angry.png"},{strings:["/anguished",":anguished:"],file:"anguished.png"},{strings:["/disappointed",":disappointed:"],file:"disappointed.png"},
{strings:["/frowning",":frowning:"],file:"frowning.png"},{strings:["/heart eyes",":heart eyes:"],file:"heart_eyes.png"},{strings:["/innocent eyes",":innocent:"],file:"innocent.png"},{strings:["/laughing",":laughing:"],file:"laughing.png"},{strings:["/mask",":mask:"],file:"mask.png"},{strings:["/neutral",":neutral:"],file:"neutral_face.png"},{strings:["/imp",":imp:"],file:"smiling_imp.png"},{strings:["/rage",":rage:"],file:"rage.png"},{strings:["/scream",":scream:"],file:"scream.png"},{strings:["/sleeping",
":sleeping:"],file:"sleeping.png"},{strings:["/smirk",":smirk:"],file:"smirk.png"},{strings:["/sunglasses",":sunglasses:"],file:"sunglasses.png"},{strings:["/unamused",":unamused:"],file:"unamused.png"},{strings:["/wink",":wink:"],file:"wink.png"},{strings:["/yum",":yum:"],file:"yum.png"},{strings:[":/","/confused",":confused:"],file:"confused.png"},{strings:["/alien",":alien:"],file:"alien.png"},{strings:["/poop",":poop:","/hankey",":hankey:"],file:"hankey.png"},{strings:["/heart",":heart:"],file:"heart.png"},
{strings:["/broken heart",":broken heart:"],file:"broken_heart.png"},{strings:["/dog",":dog:"],file:"dog.png"},{strings:["/bear",":bear:"],file:"bear.png"},{strings:["/cat",":cat:"],file:"cat.png"},{strings:["/chick",":chick:"],file:"baby_chick.png"},{strings:["/chicken",":chicken:"],file:"chicken.png"},{strings:["/cow",":cow:"],file:"cow.png"},{strings:["/fish",":fish:"],file:"fish.png"},{strings:["/dolphin",":dolphin:"],file:"dolphin.png"},{strings:["/frog",":frog:"],file:"frog.png"},{strings:["/ghost",
":ghost:"],file:"ghost.png"},{strings:["/hamster",":hamster:"],file:"hamster.png"},{strings:["/horse",":horse:"],file:"horse.png"},{strings:["/koala",":koala:"],file:"koala.png"},{strings:["/mouse",":mouse:"],file:"mouse.png"},{strings:["/penguin",":penguin:"],file:"penguin.png"},{strings:["/pig",":pig:"],file:"pig.png"},{strings:["/rabbit",":rabbit:"],file:"rabbit.png"},{strings:["/bear",":bear:"],file:"bear.png"},{strings:["/snake",":snake:"],file:"snake.png"},{strings:["/whale",":whale:"],file:"whale.png"},
{strings:["/wolf",":wolf:"],file:"wolf.png"},{strings:["/cookie",":cookie:"],file:"cookie.png"},{strings:["/coffee",":coffee:"],file:"coffee.png"},{strings:["/banana",":banana:"],file:"banana.png"},{strings:["/bread",":bread:"],file:"bread.png"},{strings:["/cake",":cake:"],file:"cake.png"},{strings:["/chocolate",":chocolate:"],file:"chocolate_bar.png"},{strings:["/fries",":fries:"],file:"fries.png"},{strings:["/apple",":apple:"],file:"apple.png"},{strings:["/hamburger",":hamburger:"],file:"hamburger.png"},
{strings:["/icecream",":icecream:"],file:"icecream.png"},{strings:["/lollipop",":lollipop:"],file:"lollipop.png"},{strings:["/strawberry",":strawberry:"],file:"strawberry.png"},{strings:["/watermelon",":watermelon:"],file:"watermelon.png"},{strings:["/wine",":wine:"],file:"wine_glass.png"},{strings:["/smoking",":smoking:"],file:"smoking.png"},{strings:["/uk",":uk:"],file:"uk.png"},{strings:["/us",":us:"],file:"us.png"},{strings:["/car",":car:"],file:"car.png"},{strings:["/train",":train:"],file:"steam_locomotive.png"},
{strings:["/bus",":bus:"],file:"bus.png"},{strings:["/lorry",":lorry:"],file:"articulated_lorry.png"},{strings:["/taxi",":taxi:"],file:"taxi.png"},{strings:["/bank",":bank:"],file:"bank.png"},{strings:["/church",":church:"],file:"church.png"},{strings:["/hotel",":hotel:"],file:"hotel.png"},{strings:["/hospital",":hospital:"],file:"hospital.png"},{strings:["/convenience",":convenience:"],file:"convenience_store.png"},{strings:["/money",":money:"],file:"dollar.png"},{strings:["/pound",":pound:"],file:"pound.png"},
{strings:["/moneybag",":moneybag:"],file:"moneybag.png"}]};function EmoticonInfo(c){var a=this;this.isCharacter=function(){return a.getCharacter()?!0:!1};this.getCharacter=function(){return c.character};this.getImageSource=function(){return c.imageSource};this.getStringRepresentation=function(){return a.isCharacter()?a.getCharacter():c.strings[0]}}
var EmoticonsParser=function(){return function(c){function a(a,c){if(!(1>a.length)){var d=b;each(a,function(a){var b=d[a];b?d=b:(b={},d=d[a]=b)});d.emoticonInfo=c}}var b={};(function(b){each(b.emoticons,function(b){var c=new EmoticonInfo(b);b.strings&&each(b.strings,function(b){a(b,c)})})})(c.emoticonsLibrary);this.pipe=function(a,c){if(a.TYPE!=MessageComponents.Text.TYPE)c(a);else{a=a.getString();for(var d={value:0},f=a.length,h=0;d.value<f;){var m=b[a[d.value]];if(m){var l=d.value;a:{var n=void 0;
for(var p=d,u=f,q=a;;){p.value++;m.emoticonInfo&&(n=m.emoticonInfo);if(p>=u)break a;m=m[q[p.value]];if(!m)break a}}n&&(l>h&&c(new MessageComponents.Text(a.substring(h,l))),c(new MessageComponents.Emoticon(n)),h=d.value)}else d.value++}d.value>h&&c(new MessageComponents.Text(a.substring(h,d.value)))}}}}(),EmoticonEntry=function(){function c(a){var b=E.IMG();b.src=a.getImageSource();b.addEventListener("error",function(){b.style.display="none"});this.getElement=function(){return b}}return function(a){var b=
this;EventEnabledBuilder(this);var d=E.DIV();d.classList.add("emoticon-entry");var f=a.emoticonInfo;f.isCharacter()?d.innerHTML=f.getCharacter():(a=new c(f),d.appendChild(a.getElement()));d.addEventListener("click",function(){b.dispatchEvent({type:"selected",emoticonInfo:f})});this.getElement=function(){return d}}}(),Emoticons=function(){function c(a){var b=a.popup.getElement();b.classList.add("emoticons");var c=E.DIV();c.classList.add("entries");b.appendChild(c);this.addEntry=function(a){c.appendChild(a.getElement())};
this.getElement=function(){return b};this.setVisible=function(a){b.style.display=a?"block":"none"}}return function(a){function b(a){a=a.emoticonInfo;k&&k(a);f.hide()}var d=a.emoticonsLibrary;EventEnabledBuilder(this);var f=new Popup,g=new c({popup:f}),k;this.show=function(a){k=a.picked;f.show()};this.getElement=g.getElement;this.setVisible=g.setVisible;(function(){var a=d.folders,c=d.defaultFolder;each(d.emoticons,function(d){if(!d.character){var f=d.folder&&a?a[d.folder]:c;f+=d.file;d.imageSource=
f}d=new EmoticonEntry({emoticonInfo:new EmoticonInfo(d)});d.addEventListener("selected",b);g.addEntry(d)})})()}}(),RoomsMenu=new function(){function c(a){var b=a.getEntries,c=a.showRoomsSearch;a=a.showRoomCreationMenu;var f=!1,g=E.DIV();g.classList.add("rooms-menu");var k=new Button({className:"button-search"}),h=new Button({className:"button-create"});g.appendChild(h.getElement());g.appendChild(k.getElement());k.addEventListener("click",c);h.addEventListener("click",a);this.getElement=function(){return g};
this.add=function(a){g.appendChild(a.getElement());a.parentWidth&&a.parentWidth(g.clientWidth)};this.remove=function(a){g.removeChild(a)};this.setVisible=function(a){f=a;g.style.display=a?"block":"none"};this.getVisible=function(){return f};this.resize=function(){var a=g.clientWidth;each(b(),function(b){b.parentWidth&&b.parentWidth(a)})}}return function(a){function b(a){a=new RoomEntry(a);k.addEntry(a);g.add(a);a.addEventListener("selected",d);return a}function d(a){f.dispatchEvent({type:"showroom",
roomInfo:a.roomInfo})}EventEnabledBuilder(this);var f=this,g=new c({getEntries:function(){return k.getEntries()},showRoomsSearch:a.showRoomsSearch,showRoomCreationMenu:a.showRoomCreationMenu}),k=new SortedFilteredEntries({getEntryId:function(a){return a.getId()},compare:function(a,b){},element:g.getElement()}),h=a.usersMenu;new Spinner({});this.getId=function(){return"RoomsMenu"};this.set=function(a){var c=[];each(a,function(a){var d=k.getByEntryId(a.id);d?d.update(a):d=b(a);c.push(d.getId())});each(k.getEntries().slice(),
function(a){a=a.getId();0>c.indexOf(a)&&(a=k.getByEntryId(a))&&(a.dispose(),g.remove(a.getElement()))});g.resize()};this.getName=function(){return"roomsmenu"};this.getElement=g.getElement;this.setVisible=function(a){var b=g.getVisible();!b&&a?h.show():b&&!a&&h.hide();g.setVisible(a)};this.clear=k.clear;this.getVisible=g.getVisible;this.resize=g.resize;this.add=function(a){k.containsEntryId(a.id)||b(a)}}},SearchBar=function(){function c(a){var b=a.callbackSearch,c=new TemporalCallback({callback:function(){b(k.value)},
maxTotalDelay:1200,delay:400}),f=E.DIV();a=E.DIV();var g=E.DIV(),k=E.TEXT(),h=E.BUTTON();f.classList.add("search-bar");a.classList.add("search-bar-text-wrapper");g.classList.add("search-bar-button-wrapper");k.classList.add("search-bar-text");h.classList.add("search-bar-button");f.appendChild(a);f.appendChild(g);a.appendChild(k);g.appendChild(h);this.getElement=function(){return f};k.addEventListener("keydown",function(){c.trigger()})}return function(a){EventEnabledBuilder(this);var b=this;this.getElement=
(new c({callbackSearch:function(a){b.dispatchEvent({type:"search",text:a})}})).getElement}}(),RoomsSearch=function(){return function(){function c(a){var c=[];each(a,function(a){if(!g.getByEntryId(a.id)){var d=new RoomEntry(a);g.addEntry(d);d.addEventListener("selected",b)}c.push(a.id)});each(g.getEntries().slice(),function(a){a=a.getId();0>c.indexOf(a)&&(a=g.getByEntryId(a),g.removeEntry(a))})}function a(a){return a.getId()}function b(a){f.hide();d.dispatchEvent({type:"showroom",roomInfo:a.roomInfo})}
EventEnabledBuilder(this);var d=this,f=new StandardSearch({title:"Rooms Search",getEntryId:a,callbackSearch:function(a){!a.text||1>a.text.length||(f.showSpinner(),d.dispatchEvent({type:"search",text:a.text}))},classNames:["rooms-search"]}),g=new SortedFilteredEntries({element:f.getEntries(),getEntryId:a,compare:function(a,b){return a.getName()>b.getName()}});this.show=f.show;this.hide=f.hide;this.incomingRooms=function(a){c(a);f.hideSpinner()}}}(),UsersSearch=function(){return function(c){function a(a){return a.getId()}
function b(a){var b=[];each(a,function(a){b.push(a.id);h.getById(a.id)||h.add(User.fromJSON(a))});each(h.getEntries().slice(),function(a){0>b.indexOf(a.getId())&&h.remove(a)})}EventEnabledBuilder(this);var d=this,f=c.clickMenu,g=c.ignoreManager,k=c.getUserMe,h=new Users({}),m=new StandardSearch({title:"Users Search",getEntryId:a,callbackSearch:function(a){!a.text||1>a.text.length||(d.dispatchEvent({type:"search",text:a.text}),m.showSpinner())},classNames:["users-search"]}),l=new SortedFilteredEntries({element:m.getEntries(),
getEntryId:a,compare:function(a,b){return a.getUsername()>b.getUsername()}});this.show=m.show;this.hide=m.hide;this.incomingUsers=function(a){b(a);m.hideSpinner()};h.addEventListener("add",function(a){l.getByEntryId(a.user.getId())||(a=new UserEntry({user:a.user,clickMenu:f,ignoreManager:g,getUserMe:k}),l.addEntry(a),a.addEventListener("showpm",function(a){d.dispatchEvent(a);d.hide()}))});h.addEventListener("remove",function(a){a=l.getByEntryId(a.user.getId());a.dispose();l.removeEntry(a)})}}(),UserImage=
new function(){function c(a,c){return a?"/images/uploaded/"+a+"_"+c+".jpeg":void 0}var a=function(a){var b=a.userId,f=a.image;a=(a=a.size)?a:"32_32";b=new ConnectedImage({def:"/images/user-default.jpg",type:User.TYPE+"_"+a,id:b,url:c(f,a)});this.getElement=b.getElement;this.dispose=b.dispose};a.LARGE="128_128";a.SMALL="32_32";a.SIZES=["32_32","128_128"];a.update=function(b,d){each(a.SIZES,function(a){var f=c(d,a);f&&ConnectedImage.update(User.TYPE+"_"+a,b,f)})};return a},UserEntry=function(){function c(a){var b=
a.userImage,c=new OnlineIndicatorUI(OnlineIndicators.get(a.userId)),g=E.DIV();g.classList.add("user-entry");var k=E.DIV();k.classList.add("inner");g.appendChild(k);var h=E.DIV();h.classList.add("username");k.appendChild(b.getElement());k.appendChild(h);k.appendChild(c.getElement());g.title=a.name;h.innerHTML=a.name;this.getElement=function(){return g};this.dispose=function(){b.dispose();c.dispose();console.log("disposed")}}var a=function(a){function b(){k.dispatchEvent({type:"showpm",user:h})}function f(){l.ignoreUser(h)}
function g(){l.unignoreUser(h)}EventEnabledBuilder(this);var k=this,h=a.user,m=a.getUserMe,l=a.ignoreManager,n=a.clickMenu;a=new UserImage({userId:h.getId(),username:h.getUsername(),image:h.getImage()});a=new c({name:h.getUsername(),userImage:a,userId:h.getId()});this.getElement=a.getElement;this.getId=function(){return h.getId()};this.getUsername=h.getUsername;this.dispose=a.dispose;a.getElement().addEventListener("click",function(a){n.setPosition({left:a.clientX,top:a.clientY});if(m()!=h){a=l.userIsIgnored(h);
var c=h.getUsername();n.show({options:[{text:"Pm "+c,callback:b},{text:(a?"Unignore ":"Ignore ")+c,callback:a?g:f}]})}})};a.fromIgnored=function(b){return new a(b)};return a}(),UsersMenu=function(){function c(a){var b=a.buttonClose,c=a.buttonSearch,f=!1,g=E.DIV(),k=E.DIV(),h=E.DIV(),m=E.DIV(),l=E.DIV(),n=E.DIV(),p=E.DIV(),u=new SplitPane({nPanelsWidth:1,nPanelsHeight:2,rowProfiles:[{height:"70%",minHeight:"60px"},{minMeight:"60px"}]}),q=u.getPanelXY(0,0).getElement(),r=u.getPanelXY(0,1).getElement();
a=new Heading({title:"&nbsp;"+a.name});var t=new Heading({title:"&nbsp;Ignored "});g.classList.add("users-menu");k.classList.add("users-menu-entries");l.classList.add("users-menu-entries");m.classList.add("heading-wrapper");h.classList.add("user-menu-entries-wrapper");p.classList.add("heading-wrapper");n.classList.add("user-menu-entries-wrapper");m.appendChild(a.getElement());h.appendChild(k);p.appendChild(t.getElement());n.appendChild(l);g.appendChild(u.getElement());q.appendChild(m);q.appendChild(h);
r.appendChild(p);r.appendChild(n);h=a.getEntries();h.appendChild(c.getElement());b&&h.appendChild(b.getElement());this.getEntries=function(){return k};this.getEntriesIgnored=function(){return l};this.getElement=function(){return g};this.resize=u.resize;this.setVisible=function(a){f=a;g.style.display=a?"block":"none";(new Task(u.resize)).run()};this.getVisible=function(){return f}}return function(a){function b(){k.dispatchEvent({type:"hidepopup"})}function d(a,b){return a.getUsername().toLowerCase()>
b.getUsername().toLowerCase()}function f(a){return a.getId()}function g(a){v.getByEntryId(a.getId())||v.addEntry(UserEntry.fromIgnored({user:a,clickMenu:t,ignoreManager:r,getUserMe:u}))}EventEnabledBuilder(this);var k=this,h=a.id,m=a.showUsersSearch;if(window.isMobile){var l=new Button({className:"button-close"});l.addEventListener("click",b)}var n=new Button({className:"button-search"}),p=new c({name:a.name,buttonClose:l,buttonSearch:n}),u=a.getUserMe,q=a.users,r=a.ignoreManager,t=a.clickMenu,w=
new SortedFilteredEntries({compare:d,getEntryId:f,element:p.getEntries(),buttonClose:l}),v=new SortedFilteredEntries({compare:d,getEntryId:f,element:p.getEntriesIgnored()});this.getElement=p.getElement;this.getId=function(){return h};q.addEventListener("add",function(a){w.getByEntryId(a.user.getId())||(a=new UserEntry({user:a.user,clickMenu:t,ignoreManager:r,getUserMe:u}),w.addEntry(a),a.addEventListener("showpm",function(a){console.log("a");k.dispatchEvent(a)}))});q.addEventListener("remove",function(a){a=
w.getByEntryId(a.user.getId());a.dispose();w.removeEntry(a)});r.addEventListener("ignored",function(a){g(a.ignored)});r.addEventListener("unignored",function(a){v.removeEntryById(a.ignored.getId())});this.getVisible=p.getVisible;this.setVisible=p.setVisible;this.show=function(){k.dispatchEvent({type:"show",entry:k})};this.hide=function(){k.dispatchEvent({type:"hide",entry:k})};this.resize=p.resize;this.dispose=p.dispose;n.addEventListener("click",m);(function(){try{each(r.getIgnores(),function(a){g(a)})}catch(x){console.log(x),
r.clearSave()}})()}}(),UsersMenues=function(){function c(a){var b=a.popupElement,c=a.getTopEntry;b?document.body.appendChild(b):b=E.DIV();b.classList.add("users-menues");this.getElement=function(){return b};this.getEntries=function(){return f};var f=E.DIV();f.classList.add("users-menues-entries");b.appendChild(f);this.setVisible=function(a){f.style.display=a?"block":"none"};this.resize=function(){console.log("a");c().getEntry().resize()}}return function(){function a(){g.hide()}function b(a){h.hide(a.entry)}
function d(a){h.show(a.entry)}EventEnabledBuilder(this);var f=this,g;window.isMobile&&(g=new Popup({}));var k=new c({popupElement:window.isMobile?g.getElement():void 0,getTopEntry:function(){return h.getTopEntry()}}),h=new OverlappingEntries({element:k.getEntries()});this.getElement=k.getElement;this.setVisible=k.setVisible;this.add=function(c){h.add(c);c.addEventListener("showpm",function(a){return f.dispatchEvent(a)});c.addEventListener("show",d);c.addEventListener("hide",b);window.isMobile&&c.addEventListener("hidepopup",
a)};this.remove=function(a){h.remove(a)};this.setUsers=function(a){h.set(a)};this.show=function(){g.show();console.log(h.getTopEntry().getEntry());h.getTopEntry().getEntry().resize()};this.resize=k.resize}}(),FileUploader=function(){function c(a){var b=this,c=a.button;EventEnabledBuilder(this);a=a.accept;console.log(a);var f=E.DIV();f.classList.add("file-uploader");var g=E.FILE();g.accept=a;g.type="file";f.appendChild(c.getElement());c.addEventListener("click",function(){g.click()});this.getElement=
function(){return f};this.setVisible=function(a){f.style.display=a?"block":"none"};g.addEventListener("change",function(a){b.dispatchEvent({type:"filechange",files:g.files})});this.clearFile=function(){g.value=""}}return function(a){function b(a){var b=new FileReader;b.onload=function(){d.dispatchEvent({type:"file",dataUrl:b.result,file:a})};b.readAsDataURL(a);g.clearFile()}EventEnabledBuilder(this);var d=this;a=a.accept;var f=new Button({className:"button"}),g=new c({accept:a,button:f});this.getElement=
g.getElement;this.setVisible=g.setVisible;g.addEventListener("filechange",function(a){console.log(a);a=a.files;1>a.length||b(a[0])})}}(),Cropper=function(){function c(a){var b=a.getConstraints,c=a.starting,f=a.setPosition,g=a.topElseBottom,k=a.leftElseRight;this.getX=a.getX;this.getY=a.getY;var h=E.DIV();h.classList.add("corner");h.classList.add(a.className);this.getElement=function(){return h};this.getConstraints=function(){return b(g,k)};this.setPosition=f;this.setVisible=function(a){h.style.display=
a?"block":"none"};this.getElement=function(){return h};this.getAbsolutePosition=function(){return getAbsolute(h)};(new DragManager({handle:this,stopPropagation:!0})).onStart=c}return function(a){var b,d,f,g,k,h;function m(a){each(U,function(b){b.setVisible(a)})}function l(){return 0}function n(){var a=A.clientWidth,c=A.clientHeight;b=a;d=c;var l=A.offsetLeft,m=A.offsetTop;f=l;g=m;k=l+a;h=m+c}function p(a,b){var c;void 0!=a&&(c=function(a){return function(b){a(b.y)}}(a?D:G));var d;void 0!=b&&(d=function(a){return function(b){a(b.x)}}(b?
v:x));c=c?d?function(a,b){return function(c){a(c);b(c)}}(c,d):c:d;return C?u(c,b,a):c}function u(a,c,l){return function(a){return c&&!l?function(c){c=(c.x-f+(h-c.y)*C)/2;a({x:c+f,y:(b-c)/C+g})}:!c&&l?function(b){b=(k-b.x+(b.y-g)*C)/2;a({x:f+(d-b)*C,y:b+g})}:function(b){b=(b.x-f+(b.y-g)*C)/2;a({x:f+b,y:(g+b)/C})}}(a)}function q(){return A.offsetLeft}function r(){return q()+A.clientWidth}function t(){return A.offsetTop}function w(){return t()+A.clientHeight}function v(a){A.style.left=String(a)+"px";
A.style.width=String(b+f-a)+"px"}function x(a){A.style.width=String(a-f)+"px"}function D(a){A.style.top=String(a)+"px";A.style.height=String(d+g-a)+"px"}function G(a){A.style.height=String(a-g)+"px"}function H(a,b){if(!C)return b?a?{minX:0,maxX:r(),minY:0,maxY:w()}:{minX:0,maxX:r(),minY:t(),maxY:B()}:a?{minX:q(),maxX:I(),minY:0,maxY:w()}:{minX:q(),maxX:I(),minY:t(),maxY:B()};if(b){b=q();var c=r()-(q()+50);if(a){var d=w()-(t()+50);a=t();var f=d*C,g=a*C;c>f?c=f:d=c/C;b>g?b=g:a=b/C;d+=t();a=t()-a}else d=
B()-w(),a=w()-(t()+50),f=d*C,g=a*C,c>g?c=g:a=c/C,b>f?b=f:d=b/C,d+=w(),a=w()-a;c+=q();b=q()-b}else c=I()-r(),b=r()-(q()+50),a?(d=w()-(t()+50),a=t(),f=d*C,g=a*C,c>g?c=g:a=c/C,b>f?b=f:d=b/C,d+=t(),a=t()-a):(d=B()-w(),a=w()-(t()+50),f=d*C,g=a*C,c>f?c=f:d=c/C,b>g?b=g:a=b/C,d+=w(),a=w()-a),c+=r(),b=r()-b;return{minX:b,minY:a,maxX:c,maxY:d}}var I=a.getImageWidth,B=a.getImageHeight,C=a.aspectRatio,K=[],A=E.DIV();A.classList.add("cropper");var U=[];each([!0,!1],function(a){var b="corner-"+(a?"top":"bottom"),
d=new c({className:b,topElseBottom:a,leftElseRight:void 0,starting:n,getConstraints:H,setPosition:p(a,void 0),getX:l,getY:a?t:w});K.push(d);U.push(d);A.appendChild(d.getElement());each([!0,!1],function(f){b="corner-"+(a?"top":"bottom")+"-"+(f?"left":"right");d=new c({className:b,topElseBottom:a,leftElseRight:f,starting:n,getConstraints:H,setPosition:p(a,f),getX:f?q:r,getY:a?t:w});K.push(d);A.appendChild(d.getElement())})});each([!0,!1],function(a){a=new c({className:"corner-"+(a?"left":"right"),topElseBottom:void 0,
leftElseRight:a,starting:n,getConstraints:H,setPosition:p(void 0,a),getX:a?q:r,getY:l});K.push(a);U.push(a);A.appendChild(a.getElement())});this.positionDefault=function(a,b){var c=a,d=b;C&&(b*C>a?d=c/C:c=d*C);A.style.left="0px";A.style.top="0px";A.style.width=String(c)+"px";A.style.height=String(d)+"px"};this.onShow=function(){m(C?!1:!0)};this.getElement=function(){return A};this.getConstraints=function(){var a=A.clientWidth/2,b=A.clientHeight/2,c=I()-a,d=B()-b;console.log({minX:a,minY:b,maxX:c,
maxY:d});return{minX:a,minY:b,maxX:c,maxY:d}};this.getPosition=function(a){return{left:A.offsetLeft,top:A.offsetTop}};this.getAbsolutePosition=function(a){return{left:a.pageX,top:a.pageY}};this.getDimensions=function(){return{width:A.clientWidth,height:A.clientHeight}};this.getX=function(){return q()+A.clientWidth/2};this.getY=function(){return t()+A.clientHeight/2};this.setPosition=function(a){A.style.left=String(a.x-A.clientWidth/2)+"px";A.style.top=String(a.y-A.clientHeight/2)+"px"};a=new DragManager({handle:this});
a.onStart=function(){};a.onMove=function(){}}}(),CroppingFrame=new function(){return function(c){function a(a){d.dispatchEvent({type:"error",error:a})}function b(a,b){l.style.width=String(a)+"px";l.style.height=String(b)+"px";var c=f.clientWidth;l.style.marginTop=String((f.clientHeight-b)/2)+"px";l.style.marginLeft=String((c-a)/2)+"px"}EventEnabledBuilder(this);var d=this;c=c.aspectRatio;var f=E.DIV();f.classList.add("cropping-frame");var g,k,h,m,l=E.DIV();l.classList.add("img-wrapper");var n=new Cropper({getImageWidth:function(){return l.getBoundingClientRect().width},
getImageHeight:function(){return l.getBoundingClientRect().height},aspectRatio:c});l.appendChild(n.getElement());f.appendChild(l);this.getElement=function(){return f};this.hide=function(){f.style.display="none"};this.load=function(c){m&&l.removeChild(m);m=void 0;m=E.IMG();m.onload=function(){g=this.width;k=this.height;h=g/k;f.style.display="table-row";n.onShow();if(f.clientWidth/f.clientHeight>h){var a=f.clientHeight;b(h*a,a)}else a=f.clientWidth,b(a,a/h);l.appendChild(m);n.positionDefault(m.clientWidth,
m.clientHeight)};m.onerror=a;m.src=c};this.getCroppedImage=function(a){console.log(a);var b=n.getPosition(),c=n.getDimensions();return ImageProcessing.crop({img:m,imgWidthRaw:g,imgHeightRaw:k,cropperWidth:c.width,cropperHeight:c.height,cropperLeft:b.left,cropperTop:b.top,format:a.format?a.format:"image/jpeg",profile:a.profile})}}},ImageProcessing=new function(){this.crop=function(c){var a=c.img,b=c.imgWidthRaw,d=c.imgHeightRaw,f=c.cropperWidth,g=c.cropperHeight,k=c.cropperLeft,h=c.cropperTop,m=c.format,
l=c.quality,n=c.profile;c=E.CANVAS();var p=c.getContext("2d");if(n.desiredWidth){var u=n.desiredWidth;if(n.aspectRatio)var q=u/n.aspectRatio;else n.finalCroppedHeight&&(q=n.finalCroppedHeight)}else n.finalCroppedHeight&&(q=n.finalCroppedHeight,n.aspectRatio&&(u=q*n.aspectRatio));console.log({width:u,height:q});c.width=u;c.height=q;n=E.CANVAS();var r=n.getContext("2d");n.width=a.width;n.height=a.height;r.drawImage(a,0,0,b,d,0,0,a.width,a.height);p.drawImage(n,k,h,f,g,0,0,u,q);return c.toDataURL(m,
l)}},ProgressBar=function(){return function(c){var a=this,b=!1,d=c.showText,f=c.text,g=E.DIV();g.classList.add("progress-bar");var k=E.DIV();k.classList.add("progress");g.appendChild(k);var h=E.DIV();h.classList.add("text");g.appendChild(h);this.setPercent=function(a){var c=String(a)+"%";k.style.width=c;d&&(h.innerHTML=(f?f:"")+" "+c);100<=a?b||(g.classList.add("progress-bar-done"),b=!0):b&&(g.classList.remove("progress-bar-done"),b=!1)};this.setProportion=function(b){a.setPrecentage(100*b)};this.getElement=
function(){return g}}}(),FileSender=function(){function c(a){function b(){g.dispatchEvent({type:"done",sender:g})}function c(a){console.log("progress");console.log(a);g.onProgress&&g.onProgress(a)}EventEnabledBuilder(this);var g=this,k=a.ajax,h=a.data,m=a.fileName,l;this.send=function(){var a=l=k.post({data:h});a.onDone=b;a.onProgress=c;g.onSending&&g.onSending()};this.abort=function(){l&&l.abort()};this.getSuccessful=function(){return l.getSuccessful()};this.getFileName=function(){return m}}function a(a){console.log("handle");
EventEnabledBuilder(this);var b=this;this.abort=a.abort;a.addEventListener("done",function(){b.dispatchEvent({type:"done",sendingHandle:b,successful:a.getSuccessful()})});a.onProgress=function(a){b.dispatchEvent({type:"progress",sendingHandle:b,percent:a,proportion:a/100})};a.onSending=function(){b.dispatchEvent({type:"sending",handle:b})};this.getFileName=a.getFileName}return function(b){function d(){if(1>n.length)return!1;n.splice(0,1)[0].addEventListener("done",g);return!0}function f(a){a.sender.removeEventListener("done");
k(a.sender);1>n.length&&h.dispatchEvent({type:"done"})}function g(a){a.sender.removeEventListener("done");k(a.sender);d()&&h.dispatchEvent({type:"done"})}function k(a){a=n.indexOf(a);0>a||n.splice(a,1)}EventEnabledBuilder(this);var h=this,m=b.sequentially,l=new Ajax({url:b.url}),n=[];this.queue=function(b){var g=new c({data:b.data,fileName:b.fileName,ajax:l});b=new a(g);m?(n.push(g),2>n.length&&d()):(new Task(function(){n.push(g);g.addEventListener("done",f);g.send()})).run();h.dispatchEvent({type:"queued",
handle:b});return b}}}(),FileSenderUI=function(){function c(a){var b=E.DIV();b.classList.add("sending");var c=new ProgressBar({showText:!0,text:a.getFileName()});c.setPercent(3);b.appendChild(c.getElement());this.getElement=function(){return b};a.addEventListener("sending",function(a){});a.addEventListener("progress",function(a){c.setPercent(a.percent)});a.addEventListener("done",function(a){c.setPercent(100)})}return function(a){a=a.fileSender;var b=[],d=E.DIV();d.classList.add("file-sender");var f=
E.DIV();f.classList.add("entries");d.appendChild(f);this.getElement=function(){return d};this.setVisible=function(a){d.style.display=a?"table-row":"none"};this.clear=function(){each(b,function(a){f.removeChild(a.getElement())});b=[]};a.addEventListener("queued",function(a){a=new c(a.handle);b.push(a);f.appendChild(a.getElement())})}}(),ImageUploader=new function(){function c(a){function b(){var a=E.DIV();a.classList.add("button-wrapper");return a}var c=a.popup,f=a.buttonClose,g=a.buttonAccept,k=a.buttonReject,
h=a.croppingFrame,m=a.fileUploader,l=new FileSenderUI({fileSender:a.fileSender});ImagePreloader.preloadRange(["/images/upload-file.jpg","/images/tick.jpg","/images/cross.jpg","/images/tick-hover.jpg","/images/cross-hover.jpg"]);a=a.popup.getElement();a.classList.add("image-uploader");var n=E.DIV();n.classList.add("inner");var p=E.DIV();p.classList.add("heading");var u=b(),q=b(),r=E.DIV();r.classList.add("cropping-menu");document.body.appendChild(a);a.appendChild(n);n.appendChild(p);p.appendChild(f.getElement());
u.appendChild(g.getElement());q.appendChild(k.getElement());r.appendChild(q);r.appendChild(u);n.appendChild(h.getElement());n.appendChild(m.getElement());n.appendChild(r);n.appendChild(l.getElement());this.show=c.show;this.hide=c.hide;this.setHeading=function(a){p.innerHTML=a};this.setCroppingMenuVisible=function(a){r.style.display=a?"table-row":"none"};this.setFileSenderVisible=l.setVisible;this.clearFileSender=l.clear}return function(a){function b(){u.hide();d()}function d(){n.setVisible(!0);r.hide();
t.setCroppingMenuVisible(!1);t.setFileSenderVisible(!1)}EventEnabledBuilder(this);var f=a.aspectRatio,g=a.profiles,k=a.getSessionId,h=new Button({className:"button-close"}),m=new Button({className:"button-accept"}),l=new Button({className:"button-reject"}),n=new FileUploader({accept:"image/*"}),p=new FileSender({url:a.url}),u=new Popup({}),q,r=new CroppingFrame({aspectRatio:f}),t=new c({popup:u,buttonClose:h,buttonAccept:m,buttonReject:l,croppingFrame:r,fileUploader:n,fileSender:p});h.addEventListener("click",
b);n.addEventListener("file",function(a){q=a.file.name;a=a.dataUrl;n.setVisible(!1);r.load(a);t.setCroppingMenuVisible(!0);t.setFileSenderVisible(!1)});r.addEventListener("error",function(a){console.log(a.error);r.hide();n.setVisible(!1)});p.addEventListener("done",function(){console.log("fileSenderDone");(new Timer({callback:function(){t.clearFileSender();b()},delay:1E3,nTicks:1})).start()});this.show=t.show;this.hide=t.hide;m.addEventListener("click",function(){var a=[];each(g,function(b){var c=
r.getCroppedImage({profile:b});a.push({dataUrl:c,profile:b})});p.queue({data:JSON.stringify({images:a,sessionId:k()}),fileName:q});n.setVisible(!1);r.hide();t.setCroppingMenuVisible(!1);t.setFileSenderVisible(!0)});l.addEventListener("click",d)}},Rooms=new function(){function c(a){var b=a.emoticons,c=a.getTopEntry,f=E.DIV();f.classList.add("rooms");var g=E.DIV();a=E.DIV();a.classList.add("rooms-inner");f.appendChild(a);g.classList.add("entries");a.appendChild(g);a.appendChild(b.getElement());this.getEntries=
function(){return g};this.getElement=function(){return f};this.resize=(new Once(function(){console.log("rooms.resize");var a=c();a&&(a=a.getEntry())&&a.resize&&a.resize()})).trigger}return function(a){function b(a){console.log(a);a=new Room({id:a.id,name:a.name,isPm:a.isPm,getUserMe:p,emoticonsParser:G,userTo:a.userTo,getUserById:u,ignoreManager:t,clickMenuUser:w,getNDevice:q,getSessionId:n,send:l,showUsersSearch:v});D.add(a);var b=a.isPm();B.add(a);a.addEventListener("showemoticons",k);a.addEventListener("hide",
f);a.addEventListener("showpm",function(a){return m.dispatchEvent(a)});b?(a.addEventListener("sendpm",function(a){return m.dispatchEvent(a)}),a.addEventListener("getpms",function(a){m.dispatchEvent(a)}),a.addEventListener("videopmofferrejected",function(a){m.dispatchEvent(a)})):(a.addEventListener("sendmessage",function(a){return m.dispatchEvent(a)}),a.addEventListener("getmessages",function(a){return m.dispatchEvent(a)}));m.dispatchEvent({type:"createdroom",room:a});a.addEventListener("dispose",
d);b?g():a.addEventListener("missingusers",m.dispatchEvent);return a}function d(a){a=a.room;h(a);a.isPm()||g()}function f(a){B.hide(a.room)}function g(){var a=D.getEntries().where(function(a){return!a.isPm()}).select(function(a){return a.getId()}).toList();console.log(a);m.dispatchEvent({type:"roomsinchanged",roomIds:a})}function k(a){I.show({picked:a.picked})}function h(a){D.remove(a);B.remove(a);m.dispatchEvent({type:"destroyedroom",room:a})}EventEnabledBuilder(this);var m=this,l=a.send,n=a.getSessionId,
p=a.getUserMe,u=a.getUserById,q=a.getNDevice,r=a.showRoomsSearch,t=a.ignoreManager,w=a.clickMenu,v=a.showUsersSearch,x=a.showRoomCreationMenu,D=new Set({getEntryId:function(a){return a.getId()}});a=a.usersMenuAll;var G=new EmoticonsParser({emoticonsLibrary:EmoticonsLibrary}),H=new RoomsMenu({usersMenu:a,showRoomsSearch:r,showRoomCreationMenu:x}),I=new Emoticons({emoticonsLibrary:EmoticonsLibrary});r=new c({emoticons:I,getTopEntry:function(){return B.getTopEntry()}});var B=new OverlappingEntries({element:r.getEntries(),
name:"rooms"});H.addEventListener("showroom",function(a){m.showRoom(a.roomInfo)});I.addEventListener("addemoticon",function(a){});B.add(H);B.show(H);this.getElement=r.getElement;this.resize=r.resize;this.showMenu=function(){B.show(H)};this.getById=function(a){return D.getById(a)};this.set=function(a){H.set(a);var b=[];each(a,function(a){b.push(a.id)});each(D.getIds(),function(a){0<=b.indexOf(a)||(a=D.getById(a),a.dispose(),h(a))})};this.incomingMessage=function(a){var b=D.getById(a.roomId);b&&b.incomingMessage(a.message)};
this.incomingMessages=function(a){var b=D.getById(a.roomId);b&&b.incomingMessages(a.messages)};this.showPm=function(a){};this.getOpenRoom=function(){console.log(B.getTopEntry().getEntry());return B.getTopEntry().getEntry()};this.join=function(a,b){b&&(a=D.getById(a.roomId))&&a.join(b)};this.getById=D.getById;this.showRoom=function(a){var c=D.getById(a.id);c||(c=b(a));B.show(c)};this.clear=function(){each(D.getEntries().slice(),function(a){console.log(a);a.dispose&&a.dispose();h(a)});H.clear()};this.addNew=
function(a){H.add(a)}}},AutomaticAuthentication=new function(){return function(c){var a=c.send,b=new Settings("AutomaticAuthentication");this.authenticate=function(){var c=b.get("token");if(!c)return!1;a({type:"automatic_authenticate",token:c});return!0};this.setToken=function(a){b.set("token",a)};this.clear=function(){b.set("token",null)}}};
function Logo(){EventEnabledBuilder(this);var c=this,a=E.DIV();a.classList.add("logo");var b=E.DIV();a.appendChild(b);ImagePreloader.preloadRange(0>location.href.indexOf("brexit")?["/logo.gif","/logo-hover.gif"]:["/logo-brex-chat-logo.gif","/logo-brexit-chat-hover.gif"]);this.getElement=function(){return a};a.addEventListener("click",function(){c.dispatchEvent({type:"click"})})}
var Lobby=function(){function c(a){function b(){H&&H.resize();r.resize();c.resize();f.resize()}var c=a.rooms,f=a.pmsMenu,g=a.mainMenu,k=a.buttonUsers,h=a.buttonPms,m=a.buttonProfilePicture,l=a.buttonNotifications,n=a.buttonMenu,p=a.notificationsMenu,u=new Spinner({preventInterraction:!0}),q=E.DIV(),r=a.usersMenues,t=new RoomCreationMenuUI(a.roomCreation),w=E.DIV();a=E.DIV();var v=E.DIV();q=E.DIV();w.classList.add("lobby");a.classList.add("right");v.classList.add("right-inner");q.classList.add("button-show-hide-wrapper");
if(window.isMobile)v.appendChild(f.getElement()),v.appendChild(q),v.appendChild(c.getElement()),document.body.appendChild(p.getElement());else{var x=E.DIV();x.classList.add("left");var D=E.DIV();D.classList.add("left-inner");w.appendChild(x);x.appendChild(D);var G=new window.Logo;D.appendChild(G.getElement());D.appendChild(r.getElement());var H=new SplitPane({nPanelsWidth:1,nPanelsHeight:2,rowProfiles:[{height:"120px",minHeight:"60px"},{minHeight:"160px"}]});var I=H.getPanelRow(0);var B=H.getPanelXY(0,
0);D=H.getPanelXY(0,1);B=B.getElement();D=D.getElement();B.appendChild(f.getElement());D.appendChild(q);D.appendChild(c.getElement());v.appendChild(H.getElement());v.appendChild(p.getElement());(new Task(H.resize)).run();G.addEventListener("click",c.showMenu);k.addEventListener("click",b);ResizeManager.add({element:w,onResized:b})}w.appendChild(a);a.appendChild(v);document.documentElement.appendChild(u.getElement());p=E.IMG();p.classList.add("logo-sign-in");p.src="/images/logo.gif";document.body.appendChild(p);
q.appendChild(k.getElement());q.appendChild(h.getElement());q.appendChild(n.getElement());q.appendChild(l.getElement());q.appendChild(m.getElement());this.getElement=function(){return w};this.showMainMenu=function(a){g.show(a);g.setPosition({right:6,top:getAbsolute(m.getElement()).bottom+3})};this.showRoomCreationMenu=t.show;this.setPmsMenuVisible=function(a){I.setVisible(a);b()};this.setLeftVisible=function(a){x.style.display=a?"block":"none";b()};this.setSpinnerAutomaticAuthenticationVisible=u.setVisible;
this.setVisible=function(a){w.style.display=a?"block":"none"};this.resize=b;this.clear=function(){t.hide()}}ImagePreloader.preloadRange("/images/close.jpg /images/tickbox-unticked.gif /images/tickbox-ticked.gif /images/menu.gif /images/menu-hover.gif /images/notifications.gif /images/profile-picture.gif /images/room-default.gif /images/room-exit.gif /images/smiley.gif /images/tick.gif /images/upload-file.gif".split(" "));window.isMobile?ImagePreloader.preloadRange(["/images/pms-mobile.gif","/images/users-mobile.gif"]):
ImagePreloader.preloadRange("/images/tickbox-unticked-hover.gif /images/tickbox-ticked-hover.gif /images/close-hover.jpg /images/profile-picture-hover.gif /images/notifications-hover.gif /images/pms-hide.gif /images/pms-hide-hover.gif /images/users-hide.gif /images/users-hide-hover.gif /images/users-show.gif /images/users-show-hover.gif /images/pms-show.gif /images/pms-show-hover.gif /images/room-exit-hover.gif /images/smiley-hover.gif /images/tick-hover.gif".split(" "));return function(){function a(){var a=
(new Date).getTime()-3E4;H&&H>a?I.show():(H=(new Date).getTime(),F.authenticate()?aa.setSpinnerAutomaticAuthenticationVisible(!0):I.show())}function b(){L.send({type:"sign_out",sessionId:x});F.clear();d()}function d(){x=null;z.clear();B.clear();ea.clear();Z.hide();da.clear();aa.clear();I.show();Na.hide();Y.hide();W.hide();w(!1)}function f(){W.show()}function g(a,b){each(b,function(b){var c=B.getById(b);c?a.join(c):ja.get(b)})}function k(a,b){var c=a.getUsers().getEntries().where(function(a){return 0>
b.indexOf(a.getId())}).toList();each(c,function(b){a.leave(b)})}function h(a){aa.setLeftVisible(a.toggled)}function m(a){aa.setPmsMenuVisible(a.toggled)}function l(a){a.pmNotifications&&each(a.pmNotifications,function(a){ea.add(Notification.pmNotificationFromJSON(a))})}function n(a){a.where(function(a){return!B.containsId(a)}).each(function(a){return ja.get(a)});B.getIds().where(function(b){return 0>a.indexOf(b)}).each(function(a){(a=B.getById(a))&&a.left()})}function p(a){a.successful?(x=a.sessionId,
a.token&&F.setToken(a.token),D=a.nDevice,B.add(User.fromJSON(a.user)),G=B.getById(a.user.id),a.users.select(function(a){return User.fromJSON(a)}).each(function(a){return B.add(a)}),I.hide(),w(!0),L.send({type:"rooms_get",sessionId:x}),X.load(G.getId()),C.load(G.getId())):I.setError(a.error)}function u(a){return B.getById(a)}function q(){return G}function r(){return x}function t(a){X.showPmWithUser(a.user)}function w(a){aa.setVisible(a);a&&(new Task(aa.resize)).run()}function v(a){L.send({type:"pm_video_offer_rejected",
userToId:a.userToId,reason:a.reason,sessionId:x})}var x,D,G,H,I=new Authenticate({callbackRegister:function(a){a.type="register";L.send(a)},callbackSignIn:function(a){a.type="authenticate";L.send(a)},callbackGuest:function(a){a.type="authenticate";a.isGuest=!0;L.send(a)}}),B=new Users({}),C=new IgnoreManager({getUserById:u,getUserMe:q}),K=new ClickMenu({}),A=new ClickMenu({}),U=new UsersMenu({name:"All Users (Lobby)",users:B,id:"UsersMenuLobby",ignoreManager:C,getUserMe:q,clickMenu:K,showUsersSearch:f}),
ja=new MissingUsersManager,L=new Mysocket({url:"poll",urlWebsocket:getWebsocketUrl("endpoint")});window.debug&&window.debug.setMysocket(L);var F=new AutomaticAuthentication({send:L.send});(new Task(a)).run();var ma=new SeenNotificationsManager({getSessionId:r,mysocket:L}),ca=new UsersMenues({ignoreManager:C});ca.add(U);var W=new UsersSearch({clickMenu:K,ignoreManager:C,getUserMe:q}),Y=new RoomsSearch({clickMenu:K}),z=new Rooms({getUserMe:q,getUserById:u,ignoreManager:C,clickMenu:K,usersMenuAll:U,
getNDevice:function(){return D},getSessionId:r,send:L.send,showUsersSearch:f,showRoomsSearch:function(){Y.show()},showRoomCreationMenu:function(){aa.showRoomCreationMenu()}}),Na=new ImageUploader({getSessionId:r,aspectRatio:1,profiles:[{desiredWidth:32,aspectRatio:1,name:UserImage.SMALL},{desiredWidth:256,aspectRatio:1,name:UserImage.LARGE}],url:"/image_uploader"}),X=new Pms({rooms:z,getUserById:B.getById,getUserMe:q,getOpenRoom:z.getOpenRoom}),da=new PmsMenu({pms:X}),N=new RoomCreation({sendMessage:L.send,
getSessionId:r}),ea=new Notifications({}),Z=new NotificationsMenu({notifications:ea,pms:X,seenNotificationsManager:ma});K=new Button({toggle:!window.isMobile,classNames:["button-users"],classNameToggled:"button-users-hide"});U=new Button({toggle:!window.isMobile,classNames:["button-pms"],classNameToggled:"button-pms-hide"});ma=new Button({classNames:["button-profile-picture"]});var na=new NotificationsButton({notifications:ea}),va=new Button({classNames:["button-menu"]}),aa=new c({rooms:z,buttonUsers:K,
buttonPms:U,buttonProfilePicture:ma,buttonNotifications:na,pmsMenu:da,usersMenues:ca,notificationsMenu:Z,buttonMenu:va,mainMenu:A,roomCreation:N});L.addEventListener("message",function(a){a=a.msg;switch(a.type){case "test":console.log(a);break;case "join":var b=User.fromJSON(a.user);B.contains(b)||B.add(b);(a=a.userIds)&&n(a);break;case "users":B.update(a.users);break;case "authenticate":p(a);l(a);break;case "automatic_authenticate":aa.setSpinnerAutomaticAuthenticationVisible(!1);a.successful?(p(a),
l(a)):I.show();break;case "register":p(a);break;case "rooms":z.set(a.rooms);break;case "room_userids":if(b=z.getById(a.roomId))g(b,a.userIds),k(b,a.userIds);break;case "message":z.incomingMessage(a);break;case "pm_message":X.incomingMessage(a);break;case "messages":z.incomingMessages(a);break;case "pm_messages":X.incomingMessages(a);break;case "userids":n(a.userIds);break;case "pm_video_offer_fail":X.videoOfferFail(a);break;case "pm_video_offer_rejected":X.videoOfferRejected(a);break;case "pm_video_offer":X.videoOffer(a);
break;case "pm_video_accept_fail":X.videoAcceptFail(a);break;case "pm_video_accept":X.videoAccept(a);break;case "pm_video_ice_candidate":X.videoIceCandidate(a);break;case "create_room":N.incomingCreateRoom(a);break;case "new_room":z.addNew(a.room);break;case "user_image_set":UserImage.update(a.userId,a.image);(b=B.getById(a.userId))&&b.setImage(a.image);break;case "rooms_search":Y.incomingRooms(a.rooms);break;case "users_search":W.incomingUsers(a.users)}});L.addEventListener("open",function(){});
ma.addEventListener("click",function(){Na.show()});na.addEventListener("click",function(){Z.show()});va.addEventListener("click",function(){aa.showMainMenu({options:[{text:"Sign Out ",callback:b}]})});B.addEventListener("add",function(a){OnlineIndicators.setOnline(a.user.getId(),!0)});B.addEventListener("remove",function(a){OnlineIndicators.setOnline(a.user.getId(),!1)});N.addEventListener("created",function(a){z.showRoom(a.roomInfo)});window.isMobile?(U.addEventListener("click",da.show),K.addEventListener("click",
function(){ca.show()})):(U.addEventListener("toggled",m),K.addEventListener("toggled",h));z.addEventListener("sendmessage",function(a){var b=a.message.toJSON();b.roomId=a.roomId;b.type="room_message_send";b.sessionId=x;L.send(b)});z.addEventListener("getmessages",function(a){L.send({type:"room_messages_get",roomId:a.roomId,sessionId:x})});z.addEventListener("getpms",function(a){L.send({type:"pm_messages_get",userToId:a.userToId,sessionId:x})});z.addEventListener("getuserids",function(a){L.send({type:"room_userids_get",
roomId:a.roomId,sessionId:x})});z.addEventListener("createdroom",function(a){a=a.room;ca.add(a.getUsersMenu());a.isPm()||L.send({type:"room_join",sessionId:x,roomId:a.getId()})});z.addEventListener("destroyedroom",function(a){var b=a.room;ca.remove(a.room.getUsersMenu());b.isPm()||L.send({type:"room_leave",sessionId:x,roomId:b.getId()})});z.addEventListener("roomsinchanged",function(a){L.send({type:"rooms_in_changed",sessionId:x,roomIds:a.roomIds})});z.addEventListener("sendpm",function(a){var b=
a.message.toJSON();b.userToId=a.userToId;b.type="room_pm_send";b.sessionId=x;L.send(b)});z.addEventListener("videopmofferrejected",v);Y.addEventListener("search",function(a){L.send({type:"rooms_search",text:a.text,sessionId:x})});Y.addEventListener("showroom",function(a){z.showRoom(a.roomInfo)});ca.addEventListener("showpm",t);W.addEventListener("search",function(a){L.send({type:"users_search",text:a.text,sessionId:x})});W.addEventListener("showpm",t);Z.addEventListener("showpm",t);X.addEventListener("addnotification",
function(a){ea.add(a.notification)});X.addEventListener("videoofferrejected",v);L.addEventListener("disposedbyserver",function(){L.reset();d();a()});Leaving.add(function(){L.send({type:"leaving",sessionId:x})});this.getElement=aa.getElement}}(),lobby;compatabilityCheck(function(){lobby=new Lobby;document.body.appendChild(lobby.getElement())},function(){window.location.href="https://www.google.com/chrome/"});